\documentclass[_00_autoref.tex]{subfiles}
\begin{document}

{\let\clearpage\relax\vspace{2.2ex}
\chapter*{\MakeUppercase{ОСНОВНАЯ ЧАСТЬ}}\vspace{-2ex}}

% \section{Аналог критерия Эйлера}

В \emph{первой главе} приводится обзор литературных источников по теме диссертации.

Основным объектом исследования \emph{второй главы} диссертации являются простые идеалы в дедекиндовых кольцах.

Пусть характер $\chi$ задан на множестве идеалов кольца $R$, не является главным и определен по модулю идеала $\ideal{n} \subset R$.
Через $\ideal{p}_{\chi}$ обозначим идеал минимальной нормы, для которого $\chi(\ideal{p}_{\chi}) \neq 0, 1$.

Пусть $R$ дедекиндово кольцо с полем частных $K$.
Пусть $L$ расширение поля $K$ степени не меньше $2$.
Будем говорить, что кольцо $R$ \emph{удовлетворяет условию A для идеала $\ideal{n}$}, если существует многочлен $f_R$, что для любого характера $\chi$, не являющегося главным и определенного по модулю $\ideal{n}$, выполнено $\Nm{\ideal{p}_{\chi}} \le f_R(\log{\Nm{\ideal{n}}})$.

\textbf{Теорема 2.1}
    Пусть $\ideal{n}$~-- нетривиальный идеал нечетной нормы дедекиндового кольца $R$.
    Тогда $\ideal{n}$~-- простой идеал тогда и только тогда, когда для любого $a \in \invertible{R/\ideal{n}}$ выполнено $a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \jacobi{a}{\ideal{n}} \pmod{\ideal{n}}$.

    Если кольцо $R$ факториальное и удовлетворяет условию A, то $\ideal{n}$~-- простой идеал тогда и только тогда, когда для любого $a \in \invertible{R/\ideal{n}}$, $\Nm{a} \le f_R(\Nm{\ideal{n}})$ выполнено $a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \jacobi{a}{\ideal{n}} \pmod{\ideal{n}}$.

\textbf{Алгоритм 2.1}
    Дан нетривиальный идеал $\ideal{n} \subset R$.
    Необходимо определить является ли он простым.

    \begin{enumerate}
        \item Вычислить $\Nm{\ideal{n}}$;
        
        \item Выбрать случайное $a \in \invertible{R/\ideal{n}}$;

        \item Вычислить $r_0 \equiv a^{\frac{\Nm{\ideal{n}} - 1}{2}} \pmod{\ideal{n}}$, $r_1 = \jacobi{a}{\ideal{n}}$;

        \item Если $r_0 \equiv r_1 \pmod{\ideal{n}}$, то вернуть ''неизвестно'' и завершить алгоритм;

        \item Вернуть ''$\ideal{n}$ не простой'' и завершить алгоритм.
    \end{enumerate}

\textbf{Замечание 2.11}
    Алгоритм 2.1 является вероятностным.
    Если был получен ответ "неизвестно", то можно выполнить алгоритм еще раз.

\textbf{Предложение 2.10}
    Пусть $\ideal{n}$~-- не простой идеал.
    Тогда вероятность ответа "$\ideal{n}$ не простой" у алгоритма 2.1 не менее $1/2$.

\textbf{Замечание 2.12}
    Если $\ideal{n}$~-- составной, то при выполнении алгоритма 2.1 $k$ раз вероятность получить ответ ''$\ideal{n}$ не простой'' не меньше $1 - \frac{1}{2^k}$.

\textbf{Теорема 2.2}
    Пусть $\ideal{n}$~-- нетривиальный идеал нечетной нормы дедекиндового кольца $R$.
    Пусть $\Nm{\ideal{n}} - 1 = 2^t u$, $(u, 2) = 1$.
    Тогда $\ideal{n}$~-- простой идеал тогда и только тогда, когда для любого $a \in \invertible{R/\ideal{n}}$, $a^u \not\equiv 1 \pmod{\ideal{n}}$ существует $k\in \{0, \dots, t-1\}$, такое что $a^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.

    Пусть кольцо $R$ факториальное и удовлетворяет условию A.
    Тогда $\ideal{n}$~-- простой идеал тогда и только тогда, когда для любого $a \in \invertible{R/\ideal{n}}$, $\Nm{a} \le f_R(\Nm{\ideal{n}})$, $(a, \ideal{n}) = 1$, $a^u \not\equiv 1 \pmod{\ideal{n}}$ существует $k\in \{0, \dots, t-1\}$, такое что $a^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.

\textbf{Алгоритм 2.2}
    Дан идеал $\ideal{n} \subset R$.
    Необходимо определить является ли он простым.

    \begin{enumerate}
        \item Найти $u, t \in \mathbb{N}$, что $\Nm{\ideal{n}} - 1 = 2^t u$ и $(2, u) = 1$;
        
        \item Выбрать случайный $a \in \invertible{R/\ideal{n}}$;

        \item Вычислить $r_0 \equiv a^u \pmod{\ideal{n}}$;

        \item Если $r_0 = 1$, то вернуть ''неизвестно'' и завершить алгоритм;

        \item Положить $k = 0$;

        \item Пока $k < t$ выполнять:
        \begin{enumerate}
            \item Если $r_k = -1$, то вернуть ''неизвестно'' и завершить алгоритм;

            \item Увеличить $k$ на $1$;

            \item Вычислить $r_{k+1} \equiv r_k^2 \pmod{\ideal{n}}$;
        \end{enumerate}

        \item Вернуть ''$\ideal{n}$ не простой'' и завершить алгоритм.
    \end{enumerate}

\textbf{Замечание 2.13}
    Алгоритм 2.2 является вероятностным.
    Если был получен ответ "неизвестно", то можно выполнить алгоритм еще раз.

\textbf{Предложение 2.11}
    Пусть $\ideal{n}$~-- не простой идеал.
    Тогда вероятность ответа "$\ideal{n}$ не простой" у алгоритма 2.2 не менее $1/2$.

\textbf{Замечание 2.14}
    Если $\ideal{n}$~-- составной, то при выполнении алгоритма 2.2 $k$ раз вероятность получить ответ ''$\ideal{n}$ не простой'' не меньше $1 - \frac{1}{2^k}$.

\textbf{Предложение 2.12}
    Пусть $K$ числовое поле и $R$ кольцо целых алгебраических элементов числового поля $K$.
    Пусть $\ideal{n} \subseteq R$ идеал кольца $R$.
    Для того, чтобы использовать алгоритм 2.1 для $\ideal{n}$ требуется полиномиальное относительно $\log^2 l(\ideal{n})$ количество арифметических операций в $\mathbb{Z}$.

\textbf{Предложение 2.13}
    Пусть $\ideal{n} \subseteq R$ идеал дедекиндового кольца $R$.
    Для того, чтобы использовать алгоритм 2.2 для $\ideal{n}$ требуется $O(\log \Nm{\ideal{n}})$ арифметических операций.

    Пусть $K$ числовое поле и $R$ кольцо целых алгебраических элементов числового поля $K$.
    Пусть $\ideal{n} \subseteq R$ идеал кольца $R$.
    Для того, чтобы использовать алгоритм~2.2 для $\ideal{n}$ требуется $\tilde{O}(\log^2 l(\ideal{n}))$ бинарных операций.

% \section{ТЕОРЕМА КРОНЕКЕРА-ВАЛЕНА В ФАКТОРИАЛЬНЫХ КОЛЬЦАХ}
\emph{Третья глава} диссертации посвящена доказательству экстремальных свойств алгоритма Евклида в факториальных кольцах.

\textbf{Определение 3.1}
    Пусть $a$ и $b$ ненулевые элементы факториального кольца $R$.
    Для любых $k \in \mathbb{N}$ и $q_1, \dots, q_k \in R$ обозначим
    \begin{equation*}
        \mathcal{D}_{a, b}(q_1, \dots, q_k) = (r_{-1}, r_0, \dots, r_{k-1}, r_k) \in R^{k+2},
    \end{equation*}
    где $r_{-1} = a$, $r_0 = b$, $r_i = r_{i-2} - q_i r_{i-1}$, для $i = 1, \dots, k$.
    Выражение $\mathcal{D}_{a, b}(q_1, \dots, q_k)$ будем называть цепочкой делений для $a, b \in R$.
    Обозначим через $\mathcal{E}_{a, b}$ следующее множество:
    \begin{equation*}
        \mathcal{E}_{a, b} = \left\{
        \mathcal{D}_{a, b}(q_1, \dots, q_k) = (r_{-1}, \dots, r_k) \big| r_1, \dots, r_{k-1} \in \zeroless{R}, r_k = 0
        \right\}.
    \end{equation*}

\textbf{Определение 3.2}
    Пусть $a$ и $b$ ненулевые элементы факториального кольца $R$.
    Цепочкой делений с выбором минимального по норме остатка для $a, b \in R$ будем называть такую цепочку делений, что $q_i = \textrm{int}(r_{i-2}/r_{i-1})$ для любого $i = 1, \dots, k$.

    Если цепочка делений с выбором минимального по норме остатка существует, то обозначим через $\mathcal{L}_{a, b}$ ее длину.
    Если ее не существует, то обозначим $\mathcal{L}_{a, b} = \infty$.

\textbf{Определение 3.3}
    Обозначим через $\mathpzc{l}_{a, b}$ длину кратчайшей цепочки делений для $a, b \in \zeroless{R}$.
    \begin{equation*}
        \mathpzc{l}_{a, b} = \begin{cases}
            \min_{\mathcal{D}_{a, b}(q_1, \dots, q_k) \in \mathcal{E}_{a, b}} k, & \textrm{ если } \mathcal{E}_{a, b} \neq \emptyset\\
            \infty, & \textrm{ если } \mathcal{E}_{a, b} = \emptyset
        \end{cases}.
    \end{equation*}

\textbf{Определение 3.4}
    Через $l_n(R)$ обозначим максимальную длину цепочки делений с выбором минимального по норме остатка для $a, b \in \zeroless{R}$ с ограниченной нормой $l_n(R) = \max \left\{\mathcal{L}_{a, b} \big| a, b \in \zeroless{R}, \elementnorm{a} \le \elementnorm{b} \le n\right\}$.

\textbf{Определение 3.5}
    Определим функцию $\omega: F_1 \to F_1$ следующим образом
    \begin{equation*}
        \omega(\alpha) = \begin{cases}
            \fr{\alpha^{-1}}, \textrm{ если } \alpha \neq 0\\
            0, \textrm{ если } \alpha = 0
        \end{cases}
    \end{equation*}

\textbf{Определение 3.6}
    Будем говорить, что $(x_0, \alpha, n) \in \zeroless{R} \times \zeroless{F_1} \times \mathbb{N}$ \emph{регулярная тройка}, если существуют $p, l \in \mathbb{N}$, $p \le n$ и $l \le p+1$, $\varepsilon_i \in \invertible{R}$, $b_i, c_i \in R$ для $i = 1, \dots, l-1$, $\varepsilon \in \{0, 1\}$, для которых выполнены следующие условия $\beta_1 = \omega^{(p)}\left(\fr{(\alpha - x_0)^{-1}}\right)$, $\beta_{i+1} = (\varepsilon_i \beta_i + c_i)^{-1} + b_i$, $i = 1, \dots, l-1$, $\beta_{l} = \alpha^{(-1)^{\varepsilon}}$.

\textbf{Определение 3.7}
    Через $\mathcal{T}$ обозначим множество всех таких факториальных колец $R$, для которых существует $D_R \in \mathbb{N}$, что выполнено 1) для всех $x_0 \in \zeroless{R}$, $\alpha \in \zeroless{F_1}$ тройка $(x_0, \alpha, D_R - 1)$ регулярная; 2) если $D_R \ge 3$, то для любого $k \in [3, D_R] \cap \mathbb{N}$ и любых $x_0 \in \zeroless{R}$, $\alpha \in \zeroless{F_1}$ из равенства $\omega^{(k-2)}(\fr{(\alpha - x_0)^{-1}}) = 0$ следует, что тройка $(x_0, \alpha, k-2)$ регулярная.

\textbf{Определение 3.8}
    Обозначим $[x_1: x_2: \dots: x_k] = x_{1} + 1/(x_{2} + 1/(x_{3} + 1/(\dots + x_k)))$.
    Будем говорить, что для $\alpha \in F$ и $k \in \mathbb{N}$ имеет место $(\alpha, k)$-разрешимость, если разрешимо уравнение $\alpha = [x_1: x_2: \dots: x_k]$.

\textbf{Теорема 3.1}
    Пусть $R \in \mathcal{T}$.
    Тогда $\mathcal{L}_{a, b} = \mathpzc{l}_{a, b}$ для всех $a, b \in \zeroless{R}$, или другими словами, цепочка делений с выбором минимального по норме остатка является кратчайшей.

Пусть дано некоторое факториальное кольцо $R$.
Рассмотрим алгоритм проверки принадлежности этого кольца классу $T$.

\textbf{Определение 3.9}
    Через $\mathcal{S}$ обозначим множество всех таких факториальных колец $R$, что для всех $x \in \zeroless{R}$ и $\alpha \in \zeroless{F_1}$ выполнено одно из условий
    \begin{itemize}
        \item $\int{(\alpha - x)^{-1}} \in \invertible{R} \cup \{0\}$;
        
        \item $x \int{(\alpha - x)^{-1}} + 1 \in \invertible{R}$.
    \end{itemize}

Сформулируем метод проверки включения $R \in \mathcal{S}$.

\textbf{Алгоритм 3.1}
    На вход подается факториальное кольцо $R$.
    
    \begin{enumerate}
        \item Построить множество
        \begin{equation*}
            J = \left\{
                x \in \zeroless{R} \big| \forall \alpha \in \zeroless{F_1}, \int{(\alpha - x)^{-1}} \in \invertible{R} \cup \{0\}
            \right\}
        \end{equation*}
        
        \item Для каждого $x_0 \in \zeroless{R} \setminus J$ построить множество
        \begin{equation*}
            Y(x_0) = \left\{
                f_{x_0}(\alpha) = \int{(\alpha - x_0)^{-1}} | \alpha \in \zeroless{F_1}
            \right\}
        \end{equation*}
        
        \item Для каждого $x_0 \in \zeroless{R} \setminus J$ построить множество
        \begin{equation*}
            U(x_0) = \left(
                \left\{
                    \frac{\varepsilon - 1}{x_0} | \varepsilon \in \invertible{R}
                \right\} \cap R
            \right) \cup \invertible{R}
        \end{equation*}
        
        \item Если $Y(x_0) \subseteq U(x_0)$ для всех $x_0 \in \zeroless{R} \setminus J$, то ответ ''$R \in \mathcal{S}$'', иначе ответ ''неизвестно''
    \end{enumerate}

Докажем корректность этого алгоритма.

\textbf{Предложение 3.1}
    Если алгоритм 3.1 вернул ответ ''$R \in \mathcal{S}$'', то $R \in \mathcal{S}$.

Приведем общий метод проверки включения $R \in \mathcal{T}$.

\textbf{Алгоритм 3.2}
    На вход подается факториальное кольцо $R$.
    
    \begin{enumerate}
        \item Выбрать $D_R, M \in \mathbb{N}$
        
        \item Построить множество
        \begin{equation*}
            \mathbb{J} = \left\{
                x_0 \in R \Bigg| \int{\frac{1}{\alpha-x_0}} \in \invertible{R} \cup \{0\} \forall \alpha \in \zeroless{F}
            \right\}
        \end{equation*}
        
        \item Создать список $\mathbb{L}$, в котором будут храниться элементы из $R^i$, где $i \in \{1, \ldots, D_R - 1\}$

        \item Вычислить $\mathbb{L}=\mathbb{K}^*\setminus\mathbb{J}$. Мы будем хранить элементы из $\mathbb{L}$, в которых более двух компонент в множестве $\mathbb{L}_M$

        \item\label{step:every_element_in_L} Выбрать элемент $(x_0, \ldots, x_l) \in \mathbb{L}$ и удалить его из $\mathbb{L}$

        \item Вычислить
        \begin{equation*}
            \delta = \left(
                \left(
                    \ldots\left(
                        \left(
                            \alpha - x_0
                        \right)^{-1} - x_1
                    \right)^{-1} - \ldots
                \right)^{-1} - x_l
            \right)^{-1}
        \end{equation*}

        \item Построить множество $\mathbb{A} = \left\{b \in R \big| b = \int{\delta}\right\}$

        \item\label{step:every_element_in_A} Для каждого элемента $x_{l+1} \in \mathbb{A}$ выполнить
        \begin{enumerate}
            \item Вычислить $\beta_1 = \omega^{(l+1)} \left(\int{(\alpha-x_0)^{-1}}\right) = \fr{(\delta-x_{l+1})^{-1}}$

            \item Попробовать найти такие $(\varepsilon_i) \in \invertible{R}$ и $(a_i), (b_i) \in R$, что $\elementnorm{a_i},\elementnorm{b_i} \le M$ и $\beta_{i+1}=\frac{1}{\varepsilon_i \beta_i + a_i} + b_i$, $\beta_{l+2}=\alpha \textrm{ или } \beta_{l+2}=\alpha^{-1}$

            \item Если такие элементы не нашлись и $l+1 \ge D_R - 1$, то вернуть ''выберите большие $D_R$ и $M$'' и завершить алгоритм
            
            \item Если такие элементы не нашлись и $l+1 < D_R - 1$, то добавить в множество $\mathbb{L}$ элемент $(x_0,\ldots,x_l,x_{l+1})$
            
            \item Если такие элементы нашлись, то перейти к следующему элементу в шаге~\ref{step:every_element_in_A}
        \end{enumerate}

        \item Если множество $\mathbb{L}$ не пустое, то выбрать другой элемент на шаге~\ref{step:every_element_in_L}
        
        \item Если множество $\mathbb{L}$ пустое и $D_R < 3$, то вернуть ''$R \in \mathcal{T}$'' и завершить алгоритм
        
        \item Для всех $k \in [3, D_R]$
        \begin{enumerate}
            \item Построить множество $\mathbb{B} = \left\{
                \alpha \in \zeroless{F} \big| \omega^{(k-2)}\left(
                    \fr{(\alpha-x_0)^{-1}}
                \right) = 0
            \right\}$

            \item Для всех $\alpha_0 \in \mathbb{B}$ попробовать найти такие $(\varepsilon_i) \in \invertible{R}$ и $(a_i), (b_i) \in R$, что $\elementnorm{a_i}, \elementnorm{b_i} \le M$ и
            \begin{equation*}
                \beta_{i+1}=\frac{1}{\varepsilon_i \beta_i + a_i} + b_i, \beta_{k-1}=\alpha \textrm{ или } \beta_{k-1}=\alpha^{-1},
            \end{equation*}
            где $\beta_1 = 0$

            \item Если такие элементы не были найдены, то вернуть ''выберите большие $D_R$ и $M$'' и завершить алгоритм
            
            \item Если такие элементы были найдены и проверены все $x_0 \in \zeroless{\mathbb{L}}$, то вернуть ''$R \in \mathcal{T}$'' и завершить алгоритм
        \end{enumerate}
    \end{enumerate}

\textbf{Предложение 3.2}
    Пусть алгоритм 3.2 вернул ''$R \in \mathcal{T}$''.
    Тогда $R \in \mathcal{T}$.

Теперь рассмотрим задачу проверки выполнимости теоремы Кронекера-Валена с другой стороны.
Следующий алгоритм позволяет находить наименьший остаток при делении двух элементов $\mathcal{O}_K$.

\textbf{Алгоритм 3.3}
    Дано числовое поле $K$ и два элемента $a, b \in \mathcal{O}_K$.
    Необходимо вычислить наименьший остаток $r$ при делении $a$ на $b$.

    \begin{enumerate}
        \item Вычислить $x = \Phi(a/b) \in \Phi(K)$;
        
        \item Вычислить $\textrm{Orb}(x)$;

        \item Выбрать произвольное действительное $k > 0$;

        \item Вычислить $\Gamma(k)$ \label{loop:1};

        \item Объявить переменные $z'$ и $Z'$, которые будут инициализированы позже;

        \item Для всех $z \in \textrm{Orb}(x)$
        \begin{enumerate}
            \item Вычислить $\mathcal{I}_{z, k}$;

            \item Для всех $Z \in \mathcal{I}_{z, k}$, если $z'$ и $Z'$ не инициализированы или $\mathcal{N}(z' - Z') > \mathcal{N}(z - Z)$ положить $z' = z$ и $Z' = Z$;
        \end{enumerate}

        \item Вычислить $\mathcal{M}_k = \mathcal{N}(z' - Z')$
        
        \item Если $\mathcal{M}_k > k$, то положить $k = \mathcal{M}_k$ и перейти к шагу \ref{loop:1}

        \item Вычислить $\int{\frac{a}{b}} = Z'\Phi((\varepsilon_z')^{-1})$

        \item Вернуть $r = a - b \int{\frac{a}{b}}$
    \end{enumerate}

Оценим вычислительную сложность этого алгоритма.

\textbf{Предложение 3.3}
    Для любых $a, b \in \zeroless{\mathcal{O}_K}$ наименьший по норме остаток $r$ при делении $a$ на $b$ можно найти, используя алгоритм 3.3, за $O(1)$ арифметических операций в $K$.

В этой части работы будет представлен метод автоматического доказательства невыполнимости теоремы Кронекера-Валена в кольце целых алгебраических элементов числового поля $K$.
Метод доказательства приведен в алгоритме 3.4.

\textbf{Алгоритм 3.4}
    Дано числовое поле $K$.
    Требуется доказать, что теорема Кронекера-Валена не выполняется в $\mathcal{O}_K$.
    
    \begin{enumerate}
        \item Взять произвольные $a, b \in \mathcal{O}_K$;

        \item Используя алгоритм 3.3 вычислить цепочку делений с выбором минимального по норме остатка $\mathcal{D}_{a, b}$;

        \item Найти такое $c \in \mathcal{O}_K$, что $a = bx + c$ для некоторого $x \in \mathcal{O}_K$;

        \item Используя алгоритм 3.3 вычислить цепочку делений с выбором минимального по норме остатка $\mathcal{D}'_{b,c}$;

        \item Если $\textrm{len}(\mathcal{D}_{a, b}) > \textrm{len}(\mathcal{D}'_{b, c}) + 1$, то теорема Кронекера-Валена не выполняется в $K$.
    \end{enumerate}

\textbf{Теорема 3.2}
    Пусть поле $K$ такое, что $\mathcal{O}_K$ действительное квадратичное норменно-евклидово кольцо.
    Тогда теорема Кронекера-Валена не выполняется в $\mathcal{O}_K$.

\textbf{Следствие 3.1}
    Пусть $R = \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$~-- квадратичное норменно-евклидово кольцо.
    Теорема Кронекера-Валена выполняется в $R$ тогда и только тогда, когда $d=-1, -2, -3, -7$.

\textbf{Определение 3.12}
    Для $m/n \in F_1$ рассмотрим функцию
    \begin{equation*}
        |m/n| = \begin{cases}
            \frac{\elementnorm{m}}{\elementnorm{n}}, & m \neq 0, (m, n) = 1,\\
            0, & m = 0.
        \end{cases}
    \end{equation*}
    Обозначим $\Lambda_K = \sup_{m/n \in F_1} |m/n|$.

\textbf{Теорема 3.3}
    Если $R$~-- евклидово кольцо относительно нормы $\elementnorm{\cdot}$, то $\Lambda_R \in [0, 1]$.

    Если $R$~-- факториальное кольцо с мультипликативной нормой $\elementnorm{\cdot}$ и $\Lambda_R \in [0, 1)$, то $R$~-- евклидово относительно нормы $\elementnorm{\cdot}$ и $l_n(R) \le [\log_{\Lambda_R^{-1}} n] + 2$ для всех $n \in \mathbb{N}$, где $\log_{\infty} n = 0$.

\textbf{Теорема 3.4}
    Пусть $d \neq 1$ целое число свободное от квадратов.
    Если кольцо $\mathcal{O}_{\mathbb{Q}(\sqrt{d})}$ евклидово относительно нормы числового поля $\elementnorm{\cdot}$, то $l_n(\mathcal{O}_{\mathbb{Q}(\sqrt{d})}) = O(\log n)$.

% \section{АНАЛОГ КРИПТОСИСТЕМЫ RSA В ДЕДЕКИНДОВЫХ КОЛЬЦАХ}
\emph{Четвертая глава} диссертации посвящена доказательству необходимых условий для параметров криптосистемы RSA для обеспечения ее криптостойкости.

Изложенный далее алгоритм аналога криптосистемы RSA был предложен в работе Петуховой и Тронина.
Была показана корректность полученной криптосистемы и представлены ограничения  на кольцо для ее эффективного применения.
В этой части исследуется криптосистема RSA в дедекиндовых кольцах с конечным полем остатков.
Целью является получение доказательств теорем, связанных с ее криптостойкостью.
Например теоремы Винера, теоремы об эквивалентности факторизации и взлома криптосистемы, а так же изучение методов взлома криптосистемы.

\textbf{Алгоритм 4.1}\footnote{\small Petukhova K.A. RSA Cryptosystem for Dedekind Rings / K.A. Petukhova, S.N. Tronin // Lobachevskii Journal of Mathematics.~--- 2016.~--- V.~37.~--- P.~284-287.}
    Аналог криптосистемы RSA в дедекиндовых кольцах.

    \begin{enumerate}
        \item Выбрать максимальные идеалы $\ideal{p}$, $\ideal{q}\in R$

        \item Вычислить $\varphi(\ideal{N}),$ где $\ideal{N} = \ideal{p} \ideal{q}$

        \item Выбрать случайное целое $e \in [1, \varphi(\ideal{N})],$ $(e, \varphi(\ideal{N}))=1$

        \item Вычислить целое положительное $d$ такое, что $ed \equiv 1 \pmod{\varphi(\ideal{N})}$
    \end{enumerate}

    Пара $(\ideal{N}, e)$ это публичный ключ $A$, пара $(\ideal{N}, d)$ секретный ключ $A$.
    Функцией шифрования называется

    \begin{equation*}
        \begin{array}{c}
            f: R/\ideal{N} \to R/\ideal{N},\\
            f(x) \equiv x^{e} \pmod{\varphi(\ideal{N})}.
        \end{array}
    \end{equation*}
    Функцией расшифрования называется
    \begin{equation*}
        \begin{array}{c}
            f^{-1}: R/\ideal{N} \to R/\ideal{N},\\
            f^{-1}(x) \equiv x^{d}\pmod{\varphi(\ideal{N})}.
        \end{array}
    \end{equation*}

\textbf{Замечание 4.1}
    Корректность приведенной криптосистемы гарантируется аналогом теоремы Эйлера для дедекиндовых колец.

Нетрудно заметить, что, зная разложение на множители $\ideal{N} = \ideal{p}\ideal{q}$ для модуля криптосистемы RSA, можно эффективно найти секретный ключ.
В некоторых случаях можно доказать обратное утверждение.

\textbf{Теорема 4.1}
    Пусть $K$~-- числовое поле и $\mathcal{O}_K$ его кольцо целых алгебраических элементов.
    Пусть $\mathcal{O}_K$~-- кольцо с единственной факторизацией, $((N), e, d)$ параметры криптосистемы RSA в $\mathcal{O}_K$.
    Если $d$ известно, то $N$ можно эффективно разложить на множители с вероятностью не менее $\frac{1}{2}$ за полиномиальное относительно длины бинарной записи $N$ количество арифметических операций в $\mathbb{Z}$.

Следующая теорема является аналогом теоремы Винера о малой секретной экспоненте.

\textbf{Теорема 4.2}
    Пусть $(\ideal{N},e,d)$, $\ideal{N}=\ideal{p} \ideal{q}$~-- параметры криптосистемы RSA в дедекиндовом кольце $R$.
    Пусть $\Nm{\ideal{q}} < \Nm{\ideal{p}} < \alpha^2 \Nm{\ideal{q}},$ где $\alpha > 1.$
    Если $d<\frac{1}{\sqrt{2\alpha+2}}(\Nm{\ideal{N}})^{1/4},$ то $d$ можно эффективно вычислить за полиномиальное относительно $\log \Nm{\ideal{N}}$ число бинарных операций.

Доказанная выше теорема является основой для атаки Винера на криптосистему RSA.
При соблюдении определенных условий на параметры криптосистемы, можно сделать использование этой атаки невозможным.
Однако существуют атаки, от которых невозможно полностью защититься.

Метод повторного шифрования является примером такой атаки.
Предположим, что было перехвачено некоторое зашифрованное сообщение $y = x^e \pmod{\ideal{N}}$, где $x \in \mathcal{O}_{K} / \ideal{N}$~-- некоторое сообщение.
Построим последовательность $y_i = y^{e^i} \pmod{\ideal{N}}$, где $i \in \{1, 2, \ldots\}$.
Используя свойства возведения в степень и то, что $\mathcal{O}_{K} / \ideal{N}$ конечно, получаем, что существует такое $m \in \mathbb{N}$, что $y_m = y$.
Тогда $y_{m-1} = x$.

Единственный способ защиты от этого метода взлома состоит в том, чтобы сделать $m$ достаточно большим.

\textbf{Теорема 4.3}
    Пусть $\ideal{N} = \ideal{p} \ideal{q}$~-- модуль криптосистемы RSA в дедекиндовом кольце $R$.
    Предположим, что существуют различные простые числа $r$, $s$ и такие положительные целые числа $k$, $l$, что $\varphi(\ideal{p}) = rk$, $\varphi(\ideal{q}) = sl$ и числа $r - 1$, $s - 1$ имеют различные простые делители $r_1$, $s_1$ соответственно.

    Пусть $y$ и $e$~-- независимые равномерно распределенные случайные величины со значениями в $R / \ideal{N}$ и $\invertible{\mathbb{Z}_{\varphi(\ideal{N})}}$ соответственно.
    Обозначим $m_{e,y} = \min \{m \in \mathbb{N} | y_m = y\}$.
    Тогда выполняется неравенство $P(m_{e,y} \ge r_1s_1)\ge(1-r^{-1})(1-s^{-1})(1-r_1^{-1})(1-s_1^{-1})$.

\textbf{Теорема 4.4}
    Пусть $(\ideal{N}, e, d)$ параметры криптосистемы RSA в дедекиндовом кольце $R$, где $\Nm{\ideal{p}}$ и $\Nm{\ideal{q}}$ имеют одинаковую битовую длину.
    Пусть $e d \le (\Nm{\ideal{N}})^2$, $\Nm{\ideal{N}} \ge 3$.
    Если $d$ известно, то существует эффективный алгоритм, который позволяет найти $\Nm{\ideal{p}}$ и $\Nm{\ideal{q}}$.

\textbf{Замечание 4.2}
    Если в условии теоремы 4.4 заменить неравенство $ed \le (\Nm{\ideal{N}})^2$ на более строгое $e d \le (\Nm{\ideal{N}})^{3/2}$, то получим, что $k - \overline{k} < 6(\Nm{\ideal{N}})^{-3/2}(ed-1) < 6$.
    
    Следовательно, вычислив $\overline{k} = \frac{ed-1}{\Nm{\ideal{N}}}$, можно перебрать все возможные $k$ и для каждого вычислить $\varphi(\ideal{N})$, $\Nm{\ideal{p}}$, $\Nm{\ideal{q}}$.

\textbf{Теорема 4.5}
    Пусть дедекиндово кольцо $R$ является евклидовым относительно некоторой нормы $\upsilon(\cdot)$ и $\Lambda_{R} < 1$, где $\Lambda_{R}$ задано в определении 3.12.
    Тогда это кольцо главных идеалов.
    Для простоты будем обозначать идеалы соответствующими элементами кольца.

    Пусть $(N, e_1, d_1)$ и $(N, e_2, d_2)$ параметры криптосистемы RSA в $R$ и $(e_1, e_2) = 1$.
    Пусть перехвачены сообщения $c_1 \equiv m^{e_1} \pmod{N}$ и $c_2 \equiv m^{e_2} \pmod{N}$.
    Тогда сообщение $m$ можно вычислить за полиномиальное относительно $\log \upsilon(N)$ количество арифметических операций в $R$.

Пусть $R$ кольцо целых алгебраических элементов числового поля $K = \mathbb{Q}(\theta)$.
Будем предполагать, что поле $K$ фиксировано и, следовательно, известен индекс $[R: \mathbb{Z}[\theta]]$.
А так же разложение на простые идеалы всех простых делителей индекса.
В этом случае, используя теорему Дедекинда можно построить полиномиальное сведение задачи факторизации идеала к задаче факторизации целых чисел.

\textbf{Алгоритм 4.2}
    Алгоритм факторизации идеала числового кольца.

    \begin{enumerate}
        \item Пусть дан идеал $(N)$ в форме своего $2$-представления
        
        \item Считаем норму идеала, равную норме элемента $N$ и раскладываем норму на множители одним из известных алгоритмов для факторизации целых чисел.
        Например методом решета числового поля или алгоритмом Шора.
        Получаем разложение $n = \Nm{N} = \prod_{i=1}^{k} p_i^{\alpha_i}$.
        Таким образом, мы знаем, что $(\Nm{N}) = \prod_{i=1}^{k} (p_i)^{\alpha_i}$
    
        \item Факторизуем идеал $(p_i)$ с помощью теоремы Дедекинда и получаем двухэлементные представления идеалов $(p_i) = \prod_{j=1}^{l_i} (p_i, f_{i, j}(\theta))$
    
        \item Преобразуем полученные простые идеалы в $\mathbb{Z}$-представление и объединяем равные.
        Получаем представление $(\Nm{N}) = \prod_{i=1}^{l} \mathfrak{p}_i^{\beta_i}$
    
        \item Используем бинарный поиск для нахождения степеней, в которых $\mathfrak{p}_i$ входит в $(N)$.
    \end{enumerate}

\textbf{Предложение 4.1}
    Разложить идеал $(p)$, используя теорему Дедекинда, можно за $O((n\log n + \log p)n\log n\log\log n\log^2 p)$ бинарных операций.

\end{document}
