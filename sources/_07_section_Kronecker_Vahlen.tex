\documentclass[_00_dissertation.tex]{subfiles}
\begin{document}

\onlyinsubfile{
    \renewcommand{\contentsname}{ОГЛАВЛЕНИЕ}
    \setcounter{tocdepth}{3}
    \tableofcontents
}

\refstepcounter{chapter}
\chapter*{\MakeUppercase{Глава \arabic{chapter}\\ Теорема Кронекера-Валена в факториальных кольцах}}\label{chapter:Kronecker-Vahlen theorem}
\addcontentsline{toc}{chapter}{Глава \arabic{chapter} Теорема Кронекера-Валена в факториальных кольцах}

\begin{definition}
    Пусть $R$ факториальное кольцо и $a, b \in R$.
    Рассмотрим произвольные $k \in \mathbb{N}$ и $q_1, \dots, q_k \in R$.
    Обозначим $r_{-1} = a$, $r_0 = b$, $r_i = r_{i-2} - q_i r_{i-1}$, для $i = 1, \dots, k$.
    Выражение
    \begin{equation*}
        \mathcal{D}_{a, b}(q_1, \dots, q_k) = (r_{-1}, r_0, \dots, r_{k-1}, r_k) \in R^{k+2}
    \end{equation*}
    будем называть \emph{цепочкой делений} для $a, b \in R$.
\end{definition}

\begin{definition}
    Пусть $a$ и $b$ ненулевые элементы факториального кольца $R$.
    Цепочкой делений с выбором минимального по норме остатка для $a, b \in R$ будем называть такую цепочку делений, что $q_i = \int{r_{i-2}/r_{i-1}}$ для любого $i = 1, \dots, k$.

    Если цепочка делений с выбором минимального по норме остатка существует, то обозначим через $\mathcal{L}_{a, b}$ ее длину.
    Если ее не существует, то обозначим $\mathcal{L}_{a, b} = \infty$.
\end{definition}

\begin{definition}
    Пусть $a, b \in \zeroless{R}$.
    Обозначим через $\mathpzc{l}_{a, b}$ длину кратчайшей цепочки делений для $a, b \in \zeroless{R}$.
    \begin{equation*}
        \mathpzc{l}_{a, b} = \min\left(
            \left\{
                k \big| \mathcal{D}_{a, b}(q_1, \dots, q_k) = (r_{-1}, \dots, r_k), r_k = 0
            \right\} \cap \{\infty\}
        \right)
    \end{equation*}
\end{definition}

\begin{definition}
    Через $l_n(R)$ обозначим максимальную длину цепочки делений с выбором минимального по норме остатка для $a, b \in \zeroless{R}$ с ограниченной нормой.
    \begin{equation*}
        l_n(R) = \max \left\{
            \mathcal{L}_{a, b} \big| a, b \in \zeroless{R}, \elementnorm{a} \le \elementnorm{b} \le n
        \right\}.
    \end{equation*}
\end{definition}

\begin{remark}
    Теорему Кронекера-Валена в кольце целых чисел можно сформулировать в терминах этой главы следующим образом.
    Пусть $R = \mathbb{Z}$, $\elementnorm{x} = |x|$, $\fr{\alpha} = \alpha - [\alpha + 1/2]$.
    Тогда $\mathcal{L}_{a, b} = \mathpzc{l}_{a, b}$ для всех $a, b \in \zeroless{R}$, или другими словами, цепочка делений с выбором минимального по норме остатка является кратчайшей.

    Далее в этой главе определяются достаточные условия на факториальное кольцо $R$ с заданной нормой и дробной частью, при которых теорема Кронекера-Валена будет выполняться в этом кольце.
\end{remark}

\section{Теорема Кронекера-Валена в специальном классе факториальных колец}

\begin{definition}
    Определим функцию $\omega: F_1 \to F_1$ следующим образом
    \begin{equation*}
        \omega(\alpha) = \begin{cases}
            \fr{\alpha^{-1}}, \textrm{ если } \alpha \neq 0\\
            0, \textrm{ если } \alpha = 0
        \end{cases}
    \end{equation*}
\end{definition}

\begin{definition}
    Будем говорить, что $(x_0, \alpha, n) \in \zeroless{R} \times \zeroless{F_1} \times \mathbb{N}$~--- \emph{регулярная тройка}, если существуют
    \begin{itemize}
        \item $p, l \in \mathbb{N}$, $p \le n$ и $l \le p+1$,

        \item $\varepsilon_i \in \invertible{R}$, $b_i, c_i \in R$ для $i = 1, \dots, l-1$,

        \item $\varepsilon \in \{0, 1\}$,
    \end{itemize}
    для которых выполнены следующие условия
    \begin{itemize}
        \item $\beta_1 = \omega^{(p)}\left(\fr{(\alpha - x_0)^{-1}}\right)$;

        \item $\beta_{i+1} = (\varepsilon_i \beta_i + c_i)^{-1} + b_i$, $i = 1, \dots, l-1$;

        \item $\beta_{l} = \alpha^{(-1)^{\varepsilon}}$.
    \end{itemize}
\end{definition}

\begin{definition}
    Через $\mathcal{T}$ обозначим множество всех таких факториальных колец $R$, для которых существует $D_R \in \mathbb{N}$, что выполнено
    \begin{itemize}
        \item для всех $x_0 \in \zeroless{R}$, $\alpha \in \zeroless{F_1}$ тройка $(x_0, \alpha, D_R - 1)$ регулярная;

        \item если $D_R \ge 3$, то для любого $k \in [3, D_R] \cap \mathbb{N}$ и любых $x_0 \in \zeroless{R}$, $\alpha \in \zeroless{F_1}$ из равенства $\omega^{(k-2)}(\fr{(\alpha - x_0)^{-1}}) = 0$ следует, что тройка $(x_0, \alpha, k-2)$ регулярная.
    \end{itemize}
\end{definition}

\begin{definition}
    Обозначим
    \begin{equation*}
        [x_1: x_2: \dots: x_k] = x_{1} + \cfrac{1}{
            x_{2} + \cfrac{1}{
                x_{3} + \cfrac{1}{
                    \ddots + \cfrac{1}{
                        x_{k}
                    }
                }
            }
        }.
    \end{equation*}
    Будем говорить, что для $\alpha \in F$ и $k \in \mathbb{N}$ имеет место $(\alpha, k)$-разрешимость, если разрешимо уравнение
    \begin{equation*}
        \alpha = [x_1: x_2: \dots: x_k].
    \end{equation*}
\end{definition}

\begin{lemma}\label{lemma:omega_and_euclidean_algorithm}
    Пусть $R \in \mathcal{T}$, $\alpha = m/n \in F_1$, $(m, n) = 1$ и $k \in \mathbb{N}$.
    Тогда имеет место $(\alpha, k)$-разрешимость тогда и только тогда, когда $\omega^{(k-1)}(\alpha) = 0$.
\end{lemma}
\begin{proof}
    Если $\alpha = 0$ или $k = 1$, то утверждение леммы очевидно.

    Пусть $k = 2$.
    Из определения получаем, что $(\alpha, 2)$-разрешимость означает, что разрешимо уравнение
    \begin{equation*}
        \frac{m}{n} = x_1 + \frac{1}{x_2} = \frac{x_1 x_2 + 1}{x_2}.
    \end{equation*}
    Это уравнение разрешимо тогда и только тогда, когда $m \equiv \varepsilon \pmod{n}$ для некоторого $\varepsilon \in \invertible{R}$.
    Пусть $q \in R$ и $m = q n + \varepsilon$, тогда $m/n = \fr{m/n} = \fr{\varepsilon/n}$.
    Если $n \in \invertible{R}$, то $\fr{\varepsilon/n} = 0$ и утверждение леммы очевидно.
    Если $n \not\in \invertible{R}$, то $\fr{\varepsilon/n} = \varepsilon/n$ и $\omega(m/n) = \fr{n/\varepsilon} = 0$.

    Пусть $k \ge 3$.
    Докажем лемму индукцией по $k$.
    Заметим, что $(\alpha, k)$-разрешимость имеет место тогда и только тогда, когда существует $z \in R$, что имеет место $\left((\alpha - z)^{-1}, k-1\right)$-разрешимость.
    Таким образом надо показать, что $\omega^{(k-1)}(\alpha) = 0$ тогда и только тогда, когда существует $z \in R$, что $\omega^{(k-2)}\left(\fr{(\alpha - z)^{-1}}\right) = 0$.
    Если $\omega^{(k-1)}(\alpha) = 0$, то по определению $\omega^{(k-2)}\left(\fr{\alpha^{-1}}\right) = 0$.
    Если $\omega^{(k-2)}\left(\fr{(\alpha - z)^{-1}}\right) = 0$ и $z = 0$, то по определению $\omega^{(k-1)}(\alpha) = 0$.

    Предположим, что существует $z \neq 0$, что $\omega^{(k-2)}\left(\fr{(\alpha - z)^{-1}}\right) = 0$.
    Если $D_R \ge 3$ и $k \le D_R$, то обозначим $X = k-2$, иначе $X = D_R - 1$.
    Заметим, что $X \le k-2$.
    Из определения класса $\mathcal{T}$ следует, что тройка $(z, \alpha, X)$ регулярная.
    Следовательно, существуют $p, l \in \mathbb{N}$, $p \le X$, $l \le p+1$, $\varepsilon \in \{0, 1\}$, $\varepsilon_i \in \invertible{R}$, $b_i, c_i \in R$, $i = 1, \dots, l-1$, что
    \begin{equation*}
        \begin{split}
            \beta_1 = \omega^{(p)}\left(\fr{(\alpha - z)^{-1}}\right),\\
            \beta_{i+1} = (\varepsilon_i \beta_i + c_i)^{-1} + b_i, i = 1, \dots, l-1,\\
            \beta_{l} = \alpha^{(-1)^{\varepsilon}}.
        \end{split}
    \end{equation*}

    Заметим, что $0 \le k-p-2 < k$, так как $p \le X \le k-2$.
    Из предположения индукции и равенства $\omega^{(k-p-2)}\left(\beta_1\right) = 0$ следует, что имеет место $\left(\beta_1, k-p-1\right)$-разрешимость.
    Из определения $\beta_i$ следует, что для любых $i = 1, \dots, l-1$ и $j \in \mathbb{N}$ из того, что имеет место $(\beta_i, j)$-разрешимость следует, что имеет место $(\beta_{i+1}, j+1)$-разрешимость.
    Следовательно, имеет место $\left(\alpha^{(-1)^{\varepsilon}}, k-p+l-2\right)$-разрешимость.
    Так как $k - p + l - 2 \le k - 1$, то по предположению индукции $\omega^{(k-p+l-3)}\left(\fr{\alpha^{(-1)^{\varepsilon}}}\right) = 0$.
    Следовательно, $\omega^{(k-2)}\left(\fr{\alpha^{(-1)^{\varepsilon}}}\right) = 0$.
    Тогда из определения $\omega$ получаем $\omega^{(k-1)}(\alpha) = 0$.
\end{proof}

\begin{lemma}\label{lemma:euclidean_algorithm_and_minima}
    Пусть кольцо $R$ факториальное и $a, b \in \zeroless{R}$.
    Тогда
    \begin{equation*}
        \mathcal{L}_{a, b} = \min\left\{
            k \in \mathbb{N} \Big| \omega^{(k-1)}\left(\frac{a}{b}\right) = 0
        \right\},
    \end{equation*}
    где $\min \emptyset = \infty$.
\end{lemma}
\begin{proof}
    Предположим, что $\mathcal{L}_{a, b} = k < \infty$ и $\mathcal{D}_{a, b}(q_1, \dots, q_k) = (r_{-1}, r_0, \dots, r_k)$ это цепочка делений с выбором минимального по норме остатка.

    Из определения цепочки делений с выбором минимального по норме остатка следует, что
    \begin{equation*}
        \frac{r_{i-2}}{r_{i-1}} = q_i + \frac{r_i}{r_{i-1}}
    \end{equation*}
    для $i = 1, \dots, k-1$ и
    \begin{equation*}
        \frac{r_{k-2}}{r_{k-1}} = q_k.
    \end{equation*}
    Заметим, что
    \begin{equation*}
        \omega\left(
            \fr{\frac{r_{i-2}}{r_{i-1}}}
        \right) = \fr{\frac{r_{i-1}}{r_i}}.
    \end{equation*}
    Следовательно, получаем
    \begin{equation*}
        \omega^{(k-1)}\left(
            \fr{\frac{a}{b}}
        \right) = \fr{\frac{r_{k-2}}{r_{k-1}}} = 0.
    \end{equation*}
    Так как
    \begin{equation*}
        \omega^{(j-1)}\left(
            \fr{\frac{a}{b}}
        \right) = \fr{\frac{r_{j-2}}{r_{j-1}}} = 0,
    \end{equation*}
    для $j = 1, \dots, k-1$, то $\mathcal{L}_{a, b} = k = \min\{k \in \mathbb{N} \big| \omega^{(k-1)}(a\/b) = 0\}$.

    Предположим, что $\mathcal{L}_{a, b} = \infty$, но условия леммы не выполняются.
    Выберем минимальное такое $k \in \mathbb{N}$, что $\omega^{(k-1)}\left(\fr{\frac{a}{b}}\right) = 0$.

    Обозначим $r_{-1} = a$, $r_0 = b$.
    Тогда имеем $\omega^{(k-1)}\left(\fr{\frac{r_{-1}}{r_0}}\right) = 0$.

    Пусть $\omega^{(k-i)}\left(\fr{\frac{r_{i-2}}{r_{i-1}}}\right) = 0$.
    Пусть $\int{\frac{r_{i-2}}{r_{i-1}}} = q_i$, $\fr{\frac{r_{i-2}}{r_{i-1}}} = \frac{r_i}{r_{i-1}}$.
    Если $r_i = 0$, то $\mathcal{L}_{a, b} = i$, и получаем противоречие.
    Следовательно, имеем $r_i \neq 0$ и по определению $\omega$ получаем равенствво $\omega^{(k-i-1)}\left(\fr{\frac{r_{i-1}}{r_i}}\right) = 0$.

    Используя это рассуждение $k-1$ раз, получаем, что
    \begin{equation*}
        \omega^{(0)}\left(
            \fr{\frac{r_{k-2}}{r_{k-1}}}
        \right) = 0.
    \end{equation*}
    Однако имеем
    \begin{equation*}
        0 = \omega^{(0)}\left(
            \fr{\frac{r_{k-2}}{r_{k-1}}}
        \right) = \fr{\frac{r_{k-2}}{r_{k-1}}} = \frac{r_{k}}{r_{k-1}}.
    \end{equation*}
    Следовательно, получаем $r_k = 0$.
    Из построения следует, что построили цепочку делений с выбором минимального по норме остатка, что противоречит $\mathcal{L}_{a, b} = \infty$.
\end{proof}

\begin{theorem}\label{theorem:Kroneker_Vahlen_theorem_in_UFD}
    Пусть $R \in \mathcal{T}$, $a, b \in \zeroless{R}$.
    Тогда $\mathcal{L}_{a, b} = \mathpzc{l}_{a, b}$.
\end{theorem}
\begin{proof}
    Если $\mathpzc{l}_{a, b} = \infty$, то утверждение теоремы следует из определения кратчайшей цепочки делений.

    Пусть $\mathpzc{l}_{a, b} = k < \infty$.
    Из леммы~\ref{lemma:omega_and_euclidean_algorithm} следует, что $\omega^{(k-1)}\left(\frac{a}{b}\right) = 0$.
    Тогда, по лемме~\ref{lemma:euclidean_algorithm_and_minima} получаем, что $\mathcal{L}_{a, b} \le k$.
    Следовательно, получаем $\mathcal{L}_{a, b} = \mathpzc{l}_{a, b}$.
\end{proof}

% \subsection{Упрощенный метод проверки $R \in \mathcal{T}$}

Пусть дано некоторое факториальное кольцо $R$.
Рассмотрим алгоритм проверки принадлежности этого кольца классу $T$.

\begin{definition}
    Через $\mathcal{S}$ обозначим множество всех таких факториальных колец $R$, что для всех $x \in \zeroless{R}$ и $\alpha \in \zeroless{F_1}$ выполнено одно из условий
    \begin{itemize}
        \item $\int{(\alpha - x)^{-1}} \in \invertible{R} \cup \{0\}$;
        
        \item $x \int{(\alpha - x)^{-1}} + 1 \in \invertible{R}$.
    \end{itemize}
\end{definition}

\begin{lemma}
    Множество $\mathcal{S}$ содержится в $\mathcal{T}$.
\end{lemma}
\begin{proof}
    Предположим, что факториальное кольцо $R \in \mathcal{S}$.
    Возьмем $D_R = 2$.
    Необходимо доказать, что для любых $x \in \zeroless{R}$ и $\alpha \in \zeroless{F_1}$ тройка $(x, \alpha, D_R - 1)$ является регулярной.
    
    Возьмем $p = 1$, $l = 2$ и обозначим $b = \int{(\alpha - x)^{-1}}$.
    Тогда имеем
    \begin{equation*}
        \beta_1 = \omega\left(
            \fr{(\alpha - x)^{-1}}
        \right) = \omega\left(
            (\alpha - x)^{-1} - b
        \right) = \fr{\frac{\alpha - x}{1 - b\alpha + bx}}.
    \end{equation*}

    Обозначим $c = \int{\beta_1}$, тогда
    \begin{equation*}
        \beta_1 = \frac{\alpha - x}{1 - b\alpha + bx} - c.
    \end{equation*}

    Предположим, что $b \in \invertible{R} \cup \{0\}$.
    Если $b = 0$, то
    \begin{equation*}
        \beta_2 = \left(
            \beta_1 + x + c
        \right)^{-1} =
        \left(
            \frac{\alpha - x}{1} - c + x + c
        \right)^{-1} = \alpha^{-1}.
    \end{equation*}

    Если $b \in \invertible{R}$, то
    \begin{equation*}
        \begin{split}
            \beta_2 = \left(
                -b^2 \beta_1 - b - b^2 c
            \right)^{-1} + b^{-1} + x = \\
            = \left(
                -b^2 \left(
                    \frac{\alpha - x}{1 - b\alpha + bx} - c
                \right) - b - b^2 c
            \right)^{-1} + b^{-1} + x = \\
            = \left(
                \frac{-b^2\alpha + b^2x}{1 - b\alpha + bx} - b
            \right)^{-1} + b^{-1} + x = \\
            = \left(
                \frac{-b^2\alpha + b^2x - b + b^2\alpha - b^2x}{1 - b\alpha + bx}
            \right)^{-1} + b^{-1} + x = \\
            = \left(
                \frac{- b}{1 - b\alpha + bx}
            \right)^{-1} + b^{-1} + x = \frac{-1 + b\alpha - bx}{b} + b^{-1} + x = \alpha.
        \end{split}
    \end{equation*}
    
    Предположим, что $xb + 1 \in \invertible{R}$.
    Обозначим $xb + 1 = \varepsilon$.
    Тогда
    \begin{equation*}
        \begin{split}
            \beta_2 = \left(
                \beta_1 \varepsilon^2 + c\varepsilon^2 + x\varepsilon
            \right)^{-1} + b\varepsilon^{-1} = \frac{
                \varepsilon^{-1}
            }{
                \beta_1 \varepsilon + c\varepsilon + x
            } + b\varepsilon^{-1} = \\
            = \frac{
                1 - bx\varepsilon^{-1}
            }{
                \beta_1 \varepsilon + c\varepsilon + x
            } + b\varepsilon^{-1} = \frac{
                1 - bx\varepsilon^{-1} + b\varepsilon^{-1}\beta_1 \varepsilon + b\varepsilon^{-1}c\varepsilon + b\varepsilon^{-1}x
            }{
                \beta_1 \varepsilon + c\varepsilon + x
            } = \\
            = \frac{
                1 + b\beta_1 + bc
            }{
                \beta_1 \varepsilon + c\varepsilon + x
            } = \frac{
                1 + b\beta_1 + bc
            }{
                \beta_1(xb + 1) + c(xb + 1) + x
            } = \\
            = \frac{
                1 + b\left(
                    \frac{\alpha - x}{1 - b\alpha + bx} - c
                \right) + bc
            }{
                \left(
                    \frac{\alpha - x}{1 - b\alpha + bx} - c
                \right)(xb + 1) + c(xb + 1) + x
            } = \frac{
                1 + \frac{b\alpha - bx}{1 - b\alpha + bx}
            }{
                \frac{xb\alpha + \alpha - x^2b - x}{1 - b\alpha + bx} + x
            } = \\
            = \frac{
                \frac{1}{1 - b\alpha + bx}
            }{
                \frac{\alpha}{1 - b\alpha + bx}
            } = \alpha^{-1},
        \end{split}
    \end{equation*}
    
    Следовательно, тройка $(x, \alpha, D_R - 1)$ регулярная.
\end{proof}

Используя доказанную выше лемму, сформулируем метод проверки включения $R \in \mathcal{T}$.

\begin{algorithm}\label{algorithm:R_in_S}
    На вход подается факториальное кольцо $R$.
    
    \begin{enumerate}
        \item Построить множество
        \begin{equation*}
            J = \left\{
                x \in \zeroless{R} \big| \forall \alpha \in \zeroless{F_1}, \int{(\alpha - x)^{-1}} \in \invertible{R} \cup \{0\}
            \right\}
        \end{equation*}
        
        \item Для каждого $x_0 \in \zeroless{R} \setminus J$ построить множество
        \begin{equation*}
            Y(x_0) = \left\{
                f_{x_0}(\alpha) = \int{(\alpha - x_0)^{-1}} | \alpha \in \zeroless{F_1}
            \right\}
        \end{equation*}
        
        \item Для каждого $x_0 \in \zeroless{R} \setminus J$ построить множество
        \begin{equation*}
            U(x_0) = \left(
                \left\{
                    \frac{\varepsilon - 1}{x_0} | \varepsilon \in \invertible{R}
                \right\} \cap R
            \right) \cup \invertible{R}
        \end{equation*}
        
        \item Если $Y(x_0) \subseteq U(x_0)$ для всех $x_0 \in \zeroless{R} \setminus J$, то ответ ''$R \in \mathcal{T}$'', иначе ответ ''неизвестно''
    \end{enumerate}
\end{algorithm}

Докажем корректность этого алгоритма.

\begin{proposition}
    Если алгоритм~$\ref{algorithm:R_in_S}$ вернул ответ ''$R \in \mathcal{T}$'', то $R \in \mathcal{T}$.
\end{proposition}
\begin{proof}
    Предположим, что ответ ''$R \in \mathcal{T}$''.
    Рассмотрим произвольный $x_0 \in \zeroless{R}$.
    Если $x_0 \in J$, то
    \begin{equation*}
        \int{(\alpha - x)^{-1}} \in \invertible{R} \cup \{0\},
    \end{equation*}
    и выполнено первое условие определения множества $\mathcal{S}$.
    
    Предположим, что $x_0 \not\in J$.
    Рассмотрим $y = \int{(\alpha - x_0)^{-1}} \in Y(x_0)$.
    С другой стороны, $y \in U(x_0)$, следовательно, $y = \frac{\varepsilon - 1}{x_0}$.
    Тогда получаем, что
    \begin{equation*}
        \frac{\varepsilon - 1}{x_0} = \int{(\alpha - x_0)^{-1}}.
    \end{equation*}
    Следовательно, получаем
    \begin{equation*}
        \varepsilon = x_0 \int{(\alpha - x_0)^{-1}} + 1.
    \end{equation*}
    Значит выполнено второе условие определения множества $\mathcal{S}$.
\end{proof}

% \subsection{Примеры проверки $R \in \mathcal{T}$}

\begin{example}\label{example:Z}
    Пусть $R = \mathbb{Z}$, норма $\elementnorm{x} = |x|$, дробная часть $\fr{\alpha} = \alpha - \left[\alpha + \frac{1}{2}\right]$.
    Тогда
    \begin{itemize}
        \item $J = \left\{x \in \mathbb{Z} \big| |x| > 1\right\}$
        
        \item $Y(1) = \{-2, -1\}$, $Y(-1) = \{1, 2\}$
        
        \item $U(1) = \{-2, -1, 0, 1\}$, $U(-1) = \{-1, 0, 1, 2\}$
        
        \item $Y(1) \subseteq U(1)$, $Y(-1) \subseteq U(-1)$
    \end{itemize}
    
    Следовательно, $\mathbb{Z} \in \mathcal{S}$.
\end{example}

\begin{example}\label{example:P[t]}
    Пусть $R = \mathbb{P}[t]$, где $\mathbb{P}$~--- поле, норма $\upsilon(f)=\deg f$, $f \in \mathbb{P}[t]$, дробная часть $\fr{m(t)/n(t)} = r(t)/n(t)$, $m(t)\equiv r(t) \pmod{n(t)}$, $\deg r < \deg n$, $m(t)/n(t) \in \mathbb{P}(t)$.
    Тогда
    \begin{itemize}
        \item $J = \zeroless{R}$;

        \item $\zeroless{R} \setminus J = \emptyset$;
    \end{itemize}

    Следовательно, $\mathbb{P}[t] \in \mathcal{S}$.
\end{example}

\begin{example}\label{example:coordinate_ring_of_circle}
    Пусть $R = \mathbb{Q}(i)[x, y]/(x^2 + y^2 + 1) \cong \mathbb{Q}(i)[t,  t^{-1}]$, где отображение задано следующим образом
    \begin{equation*}
        \begin{split}
            X \to \cos \theta \to \frac{e^{ix} + e^{-ix}}{2} \to \frac{t + t^{-1}}{2},\\
            Y \to \sin \theta \to \frac{-ie^{ix} + ie^{-ix}}{2} \to \frac{-it + it^{-1}}{2}
        \end{split}
    \end{equation*}
    Несложно показать, что $Q[i][t, t^{-1}]$ является факториальным кольцом.
    
    Определим функцию $\upsilon : R -> \mathbb{N} \cup \{0, -\infty\}$ следующим образом
    Если $x \neq 0$, то
    \begin{equation*}
        \upsilon(x) = \upsilon\left(
            \sum_{i=k_1}^{k_2} \alpha_i t^i
        \right) = k_2 - k_1
    \end{equation*}
    где $\alpha_i \in \mathbb{Q}(i)$.
    Иначе, $\upsilon(0) = -\infty$.
    Докажем, что $\upsilon$ это норма в $Q[i][t, t^{-1}]$.

    Рассмотрим
    \begin{equation*}
        x' = \sum_{i=k_1}^{k_2} \alpha_i t^i,
        y' = \sum_{i=l_1}^{l_2} \beta_i t^i
    \end{equation*}

    Пусть
    \begin{equation*}
        x'y' = \sum_{i=m_1}^{m_2} \gamma_i t^i
    \end{equation*}

    Тогда $m_2 = k_2 + l_2$, $m_1 = k_1 + l_1$.
    Следовательно, $\upsilon(x'y') = k_2 + l_2 - k_1 - l_1 \ge k_2 - k_1 = \upsilon(x')$.
    Пусть $\upsilon(x'y') = \upsilon(x)$, тогда $l_2 - l_1 = 0$.
    Следовательно, $y' \in \invertible{R}$.

    Пусть $m/n \in F$, $\varepsilon \in \invertible{R}$.
    Предположим, что $\fr{\frac{m}{n}} = \frac{r}{n}$.
    Это означает, что $n | (m - r)$ и $r$ имеет минимальную норму из возможных.
    С другой стороны $n | (\varepsilon m - \varepsilon r)$ и $\upsilon(\varepsilon r) = \upsilon(r)$.
    Из этого следует, что $\fr{\alpha} = \varepsilon^{-1}\fr{\varepsilon\alpha}$ для $\varepsilon \in \invertible{R}$, $\alpha \in F$.
    Тогда $\int{\alpha} = \varepsilon^{-1}\int{\varepsilon\alpha}$ для $\varepsilon \in \invertible{R}$, $\alpha \in F$.

    Пусть $\alpha \in F$, $x' \in R$.
    Тогда существует $\varepsilon \in \invertible{R}$, что
    \begin{equation*}
        \varepsilon \int{\frac{1}{\alpha - x'}} = \int{\frac{1}{\beta - y'}},
    \end{equation*}
    где $y' \in \mathbb{Q}(i)[x]$, $\beta$ принадлежит полю частных $\mathbb{Q}(i)[x]$.
    Следовательно, проверка $R \in \mathcal{S}$ сводится к проверке $\mathbb{Q}(i)[x] \in \mathcal{S}$, что верно.
\end{example}

\begin{example}\label{example:Z[t]}
    Пусть $R = \mathbb{Z}[t]$, норма $\upsilon(f) = \deg f$, $f \in R$.

    Рассмотрим отображение $f: F/R \to R$:
    \begin{equation*}
        f\left(
            \left\{
                \frac{m}{n} + q \Big| q \in R
            \right\}
        \right) = \frac{m}{n}.
    \end{equation*}

    Для произвольных $A \in F/R,$ $\alpha \in A$ положим
    \begin{equation*}
        \begin{split}
            \int{\alpha} = r,\\
            \fr{\alpha} = f(A) - r,
        \end{split}
    \end{equation*}
    где $r \in R$ и для любого $p \in R$
    \begin{equation*}
        \lim_{t \to +\infty}\left|
            \frac{f(A) - r}{f(A) - p}
        \right| \le 1.
    \end{equation*}

    Рассмотрим произвольные $A \in F/R$ и $\alpha = m/n \in A$, $\fr{\alpha} = \alpha$.

    Пусть $\deg m > \deg n$.
    Предположим, что для некоторого $x_0 \in R$
    \begin{equation*}
        \int{\left(
            \frac{m}{n} - x_0
        \right)^{-1}} = r \not\equiv 0.
    \end{equation*}
    Тогда
    \begin{equation*}
        \begin{split}
            \fr{\left(
                \frac{m}{n} - x_0
            \right)^{-1}} = \left(
                \frac{m}{n} - x_0
            \right)^{-1} - r =\\
            = \frac{n}{m - n x_0} - r = \frac{n - r(m - n x_0)}{m - n x_0}.
        \end{split}
    \end{equation*}
    Из того, что $\fr{\alpha} = \alpha$ следует, что
    \begin{equation*}
        1 \ge \lim_{t \to +\infty}\left|
            \frac{\frac{m}{n}}{\frac{m}{n} - p}
        \right| = \lim_{t \to +\infty}\left|
            \frac{m}{m - n p}
        \right|.
    \end{equation*}
    Следовательно, $\deg m \le \deg(m - n p)$ для любого $p \in R$.
    Тогда $\deg n < \deg m \le \deg(m - n x_0)$ и $\deg(n - r(m - n x_0)) > \deg n$.
    Но это противоречит определению дробной части.
    Следовательно, если $\deg m > \deg n$, то для любого $x_0 \in R$ выполнено $\int{(\alpha - x_{0})^{-1}} = 0$.

    Пусть $\deg m \le \deg n$.
    Предположим, что для некоторого $x_0 \in R$, $\deg x_0 > 0$
    \begin{equation*}
        \int{\left(
            \frac{m}{n} - x_0
        \right)^{-1}} = r \not\equiv 0.
    \end{equation*}
    Из того, что $\deg x_0 > 0$ следует, что $\deg(m - n x_0) > \deg n$ и $\deg(n - r(m - n x_0)) > \deg n$.
    Но это противоречит определению дробной части.
    Следовательно, если $\deg m \le \deg n$, то для любого $x_0 \in \mathbb{Z}[t]$, $\deg x_0 > 0$ выполнено $\int{(\alpha - x_0)^{-1}} = 0$.
    
    Предположим, что для некоторого $x_0 \equiv c \in \mathbb{Z} \setminus \{0, \pm 1, \pm 2\}$
    \begin{equation*}
        \int{\left(
            \frac{m}{n} - x_0
        \right)^{-1}} = r \not\equiv 0
    \end{equation*}

    Пусть $\deg m < \deg n$.
    Тогда $\deg n < \deg(n - r(m - nc))$ или $r \in \mathbb{Z}$.
    Если выполняется первое неравенство, то получаем противоречие с определением дробной части.
    Если $r \in \mathbb{Z}$, то
    \begin{equation*}
        \lim_{t \to +\infty}\left|
            \frac{n - r(m - n c)}{n}
        \right| = |1 + r c| \ge 2,
    \end{equation*}
    Но это противоречит определению дробной части.

    Пусть $\deg m = \deg n$.
    Тогда
    \begin{equation*}
        \lim_{t \to +\infty}\left|
            \frac{m}{n}
        \right| \le 0.5.
    \end{equation*}
    Если $\deg r > 0$, то $\deg n < \deg(n - r(m - nc))$, но это противоречит определению дробной части.
    Если $\deg r = 0$, то
    \begin{align*}
        \lim_{t \to +\infty}\left|
            \frac{n - r(m - n c)}{n}
        \right| \ge |1 + rc| - |r|/2 \ge\\
        \ge |r|(|c| - 1/2) - 1 \ge \frac{3}{2},
    \end{align*}
    но это противоречит определению дробной части.

    Из этого получаем, что
    \begin{equation*}
        J \supseteq \left\{
            f \in R \big| \deg f > 0 \textrm{ или } f \equiv x_0, |x_0| > 2
        \right\}.
    \end{equation*}
    
    Пусть $x_0 \equiv \pm 2$.
    Из этого следует, что $\int{(\alpha - x_0)^{-1}} = r \not\equiv 0$ тогда и только тогда, когда $\deg m = \deg n$ и $r \equiv \pm 1$.
    Следовательно, $\pm 2 \in J$.
    Несложно показать, что $0, \pm 1 \not\in J$.
    
    Тогда
    \begin{equation*}
        \zeroless{R} \setminus J \subseteq \{\pm1\}.
    \end{equation*}

    Вычисляем
    \begin{equation*}
        \begin{split}
            Y(1) = \{-2, -1\}, Y(-1) = \{1, 2\},\\
            U(1) = \{-2, -1, 0, 1\}, U(-1) = \{-1, 0, 1, 2\}.
        \end{split}
    \end{equation*}

    Следовательно, $\mathbb{Z}[t] \in \mathcal{S}.$
\end{example}

\begin{example}\label{example:a|b or b|a}
    Пусть $R$ такое евклидово кольцо, что для любых $a, b \in R$ или $a|b$, или $b|a$.
    В этом случае $F = R \cup \{1/a | a \in \zeroless{R} \setminus \invertible{R}\}$.

    Пусть $\alpha \in \zeroless{F_1}$, $x \in R$.
    Существует такой $b \in \zeroless{R} \setminus \invertible{R}$, что $\alpha = 1/b$.
    Следовательно, получаем
    \begin{equation*}
        (\alpha - x)^{-1} = \frac{b}{1 - b x}.
    \end{equation*}
    Предположим, что $\fr{\frac{b}{1 - bx}} \neq 0$.
    Тогда $\frac{b}{1 - b x} = \frac{1}{c}$ для некоторого $c \in \zeroless{R} \setminus \invertible{R}$.
    Следовательно, $b \in \invertible{R}$ и $\alpha - x = b^{-1} - x \in R$.
    Это означает, что $\alpha \in R$, но это противоречит условию $\alpha \in \zeroless{F_1}$.
    Следовательно, получаем
    \begin{equation*}
        x \int{(\alpha - x)^{-1}} + 1 = \frac{1}{1 - b x}.
    \end{equation*}
    Заметим, что выражение слева принадлежит $R$.
    Следовательно, $\frac{1}{1 - b x} \in R$.
    Тогда $1 - b x \in \invertible{R}$.
    Следовательно, $x \int{(\alpha-x)^{-1}} + 1 \in \invertible{R}$.
    
    Тогда $\zeroless{R} \setminus J = \emptyset$.
    Следовательно, $R \in \mathcal{S}$.
\end{example}

Рассмотрим пример факториального кольца, не лежащего в $\mathcal{S}$, но лежащего в $\mathcal{T}$.

\begin{example}\label{example:Z[i]}
    Пусть $R = \mathbb{Z}[i]$.
    Покажем, что $R \not\in \mathcal{S}$.
    Выберем $\alpha = \frac{9 - 4i}{20}$, $x = 1$.
    Тогда
    \begin{equation*}
        \begin{split}
            \int{(\alpha-x)^{-1}} = -2+i \not\in \invertible{R} \cup \{0\},\\
            x \int{(\alpha-x)^{-1}} + 1 = -1 + i \not\in \invertible{R}.
        \end{split}
    \end{equation*}

    Покажем, что $R \in \mathcal{T}$.
    Заметим, что
    \begin{equation*}
        F_1 = \left\{
            z \in \mathbb{C} | Re(z), Im(z) \in \mathbb{Q} \cap [-1/2,1/2[
        \right\}.
    \end{equation*}
    Положим $D_R = 3$ в определении множества $\mathcal{T}$.

    Проверим первое условие из определения $\mathcal{T}$.
    Рассмотрим произвольные $x_0 \in \zeroless{R}$ и $\alpha \in \zeroless{F_1}$.
    Обозначим $b = \int{(\alpha - x_0)^{-1}}$.
    Через $p$ обозначим соответствующее число из первого условия определения $\mathcal{T}$.
    
    Если $\upsilon(x_0) > 5$, то при $p = 1$ имеем $\beta_1 = \alpha$.
    Если $b \in \invertible{R} \cup \{0\}$, то для $p = 1$ имеем $\beta_1 = \fr{(\alpha - x_0)/(b x_0 + 1 - \alpha)}$, тогда $\beta_2 = \alpha$.

    Пусть $b \not\in \invertible{R} \cup \{0\}$ и $\upsilon(x_0) \le 5$.
    Тогда $\upsilon(x_0) \in \{1, 2\}$ и достаточно рассмотреть случаи $x_0 = 1$ и $x_0=1+i$.

    Пусть $x_0 = 1 + i$, тогда $b = -1 + i$.
    Положим $p = 1$, и получим
    \begin{equation*}
        \beta_1 = \fr{\frac{\alpha - (1 + i)}{\alpha(1-i)-1}}, \beta_2 = \alpha^{-1}.
    \end{equation*}

    Пусть $x_0 = 1$, тогда $b \in \{-2, -1 \pm i, -2 \pm i\}$.

    Пусть $b = -2$, тогда для $p = 1$ имеем
    \begin{equation*}
        \beta_1 = \fr{\frac{\alpha - 1}{2\alpha - 1}}, \beta_2 = \alpha^{-1}.
    \end{equation*}

    Пусть $b = -1 \pm i$, тогда для $p = 1$ имеем
    \begin{equation*}
        \beta_1 = \fr{\frac{\alpha - 1}{\alpha(1 \mp i) \pm i}}, \beta_2 = \alpha^{-1}.
    \end{equation*}

    Пусть $b = -2 + i$, тогда рассмотрим элемент
    \begin{equation*}
        \beta = \omega\left(
            \fr{(\alpha - 1)^{-1}}
        \right) = \fr{\frac{\alpha - 1}{\alpha(2 - i) - (1 - i)}}.
    \end{equation*}

    Заметим, что
    \begin{equation*}
        \gamma = \int{\frac{\alpha - 1}{\alpha(2 - 1) - (1 - i)}} \in \{1 + i, 1 + 2i, 2 + i, 2 + 2i\}.
    \end{equation*}

    Пусть $\gamma = 1 + i$, тогда
    \begin{equation*}
        \beta = \frac{1 - \alpha(2 + i)}{\alpha(2 - i) - (1 - i)}.
    \end{equation*}

    Положим $p = 2$, тогда имеем
    \begin{equation*}
        \begin{split}
            \beta_1 = \omega^{(2)}\left(
                \fr{(\alpha-1)^{-1}}
            \right) = \fr{\frac{\alpha(2-i)-(1-i)}{1-\alpha(2+i)}},\\
            \beta_2 = \frac{\alpha}{1-\alpha(2+i)},\\
            \beta_3 = \alpha^{-1}.
        \end{split}
    \end{equation*}

    Пусть $\gamma = 1 + 2i$, тогда
    \begin{equation*}
        \beta = \frac{(2 + i) - \alpha(3 + 3i)}{\alpha(2 - i) - (1 - i)}.
    \end{equation*}

    Положим $p = 2$, тогда имеем
    \begin{equation*}
        \begin{split}
            \beta_1 = \omega^{(2)}\left(
                \fr{(\alpha-1)^{-1}}
            \right) = \fr{\frac{\alpha(2 - i) - (1 - i)}{(2 + i) - \alpha(3 + 3i)}},\\
            \beta_2 = \frac{\alpha}{1 - \alpha(2 + i)},\\
            \beta_3 = \alpha^{-1}.
        \end{split}
    \end{equation*}

    Пусть $\gamma = 2 + i$, тогда
    \begin{equation*}
        \beta = \frac{(2 - i) - 4\alpha}{\alpha(2 - i) - (1 - i)}.
    \end{equation*}

    Положим $p = 2$, тогда имеем
    \begin{equation*}
        \begin{split}
            \beta_1 = \omega^{(2)}\left(
                \fr{(\alpha-1)^{-1}}
            \right) = \fr{\frac{\alpha(2 - i) - (1 - i)}{(2 - i) - 4\alpha}},\\
            \beta_2 = \frac{\alpha}{1 - \alpha(2 + i)},\\
            \beta_3 = \alpha^{-1}.
        \end{split}
    \end{equation*}

    Пусть $\gamma = 2 + 2i$, тогда
    \begin{equation*}
        \beta = \frac{3 - \alpha(5 + 2i)}{\alpha(2 - i) - (1 - i)}.
    \end{equation*}

    Положим $p = 3$, тогда имеем
    \begin{equation*}
        \begin{split}
            \beta_1 = \omega^{(3)}\left(
                \fr{(\alpha-1)^{-1}}
            \right) = \fr{\frac{3 - \alpha(5 + 2i)}{2 - 2i - \alpha(5 - 2i)}},\\
            \beta_2 = \frac{\alpha}{1 - \alpha(2 - i)},\\
            \beta_3 = \alpha^{-1}.
        \end{split}
    \end{equation*}

    Случай $b = -2 - i$ аналогичен случаю $b = -2 + i$.

    Проверим второе условие определения множества $\mathcal{T}$.
    Пусть $x_0 \in \zeroless{R}$ и $\alpha \in \zeroless{F_1}$, для которых выполнено равенство $\omega\left(\fr{(\alpha - x_0)^{-1}}\right) = 0$.
    Из того, что во всех случаях кроме $x_0 = 1$, $b = -2 \pm i$, можно взять $D_R = 2$, следует, что необходимо рассмотреть только случай $x_0 = 1$, $b = -2 \pm i$.

    Пусть $b = -2 + i$, тогда
    \begin{equation*}
        \alpha \in \left\{
            \frac{1}{2 + i}, \frac{2 + i}{3 + 3i}, \frac{2 - i}{4}, \frac{3}{5 + 2i}
        \right\}.
    \end{equation*}
    Заметим, что $\omega^{(2)}(\alpha) = 0$ для всех элементов выше кроме $\frac{3}{5 + 2i}$, а $\fr{\frac{3}{5 + 2i}} \neq \frac{3}{5 + 2i}$.
    Следовательно, второе условие определения множества $\mathcal{T}$ выполняется
    Случай $b = -2 - i$ аналогичен случаю $b = -2 + i$.

    Следовательно, $\mathbb{Z}[i] \in \mathcal{T}$.
\end{example}

В работе Роллетчека~\cite[с.~341]{source:Rolletschek_1990} приведен пример кольца, для которого цепочка делений с выбором минимального по норме остатка не является кратчайшей.
Следовательно, это кольцо не может принадлежать классу $\mathcal{T}$.

\begin{example}\label{example:Z[sqrt{-11}]} \cite[с.~341]{source:Rolletschek_1990}
    Пусть $R = \mathcal{O}_{\mathbb{Q}(\sqrt{-11})}$.
    Заметим, что множество
    \begin{equation*}
        \{
            6, -2i\sqrt{11}, 6, -3 + i\sqrt{11}, -1 - i\sqrt{11}, 2, 0
        \}
    \end{equation*}
    образует цепочку делений с выбором минимального по норме остатка для пары $(a, b) = (6, -2i\sqrt{11})$.
    Тогда $\mathcal{L}_{a,b} = 5$.
    С другой стороны существует цепочка делений
    \begin{equation*}
        \{
            6, -2i\sqrt{11}, -5 + i\sqrt{11}, 3 + i\sqrt{11}, 2, 0
        \}.
    \end{equation*}
    
    Из этого следует, что $\mathpzc{l}_{a,b}\le 4\le \mathcal{L}_{a,b}$.
    Предположим, что $\mathcal{O}_{\mathbb{Q}(\sqrt{-11})} \in \mathcal{T}$, но тогда по теореме~\ref{theorem:Kroneker_Vahlen_theorem_in_UFD} получаем, что для любой пары $(c,d)\in\mathbb{K}_* \times\mathbb{K}_*$ выполнено $\mathpzc{l}_{c,d} = \mathcal{L}_{c,d}$.
    Но это противоречит приведенному примеру, следовательно, $\mathcal{O}_{\mathbb{Q}(\sqrt{-11})} \not\in \mathcal{T}$.
\end{example}

% \subsection{Общий метод проверки $R \in \mathcal{T}$}

Приведем общий метод проверки включения $R \in \mathcal{T}$.

\begin{algorithm}\label{algorithm:R_in_T}
    На вход подается факториальное кольцо $R$.
    
    \begin{enumerate}
        \item Выбрать $D_R, M \in \mathbb{N}$
        
        \item Построить множество
        \begin{equation*}
            J = \left\{
                x_0 \in R \Bigg| \int{\frac{1}{\alpha-x_0}} \in \invertible{R} \cup \{0\} \forall \alpha \in \zeroless{F}
            \right\}
        \end{equation*}
        
        \item Создать список $L$, в котором будут храниться элементы из $R^i$, где $i \in \{1, \ldots, D_R - 1\}$

        \item Вычислить $L = \zeroless{R} \setminus J$.
        Мы будем хранить элементы из $L$, в которых более двух компонент в множестве $L_M$

        \item\label{step:every_element_in_L} Выбрать элемент $(x_0, \ldots, x_l) \in L$ и удалить его из $L$

        \item Вычислить
        \begin{equation*}
            \delta = \left(
                \left(
                    \ldots\left(
                        \left(
                            \alpha - x_0
                        \right)^{-1} - x_1
                    \right)^{-1} - \ldots
                \right)^{-1} - x_l
            \right)^{-1}
        \end{equation*}

        \item Построить множество
        \begin{equation*}
            A = \left\{
                b \in R \big| b = \int{\delta}
            \right\}
        \end{equation*}

        \item\label{step:every_element_in_A} Для каждого элемента $x_{l+1} \in A$ выполнить
        \begin{enumerate}
            \item Вычислить
            \begin{equation*}
                \beta_1 = \omega^{(l+1)}\left(
                    \int{(\alpha-x_0)^{-1}}
                \right) = \fr{(\delta-x_{l+1})^{-1}}
            \end{equation*}

            \item Попробовать найти такие $(\varepsilon_i) \in \invertible{R}$ и $(a_i), (b_i) \in R$, что $\elementnorm{a_i},\elementnorm{b_i} \le M$ и
            \begin{equation*}
                \begin{split}
                    \beta_{i+1}=\frac{1}{\varepsilon_i \beta_i + a_i} + b_i,\\
                    \beta_{l+2}=\alpha \textrm{ или } \beta_{l+2}=\alpha^{-1}
                \end{split}
            \end{equation*}

            \item Если такие элементы не нашлись и $l+1 \ge D_R - 1$, то вернуть ''выберите большие $D_R$ и $M$'' и завершить алгоритм
            
            \item Если такие элементы не нашлись и $l+1 < D_R - 1$, то добавить в множество $L$ элемент $(x_0,\ldots,x_l,x_{l+1})$
            
            \item Если такие элементы нашлись, то перейти к следующему элементу в шаге~\ref{step:every_element_in_A}
        \end{enumerate}

        \item Если множество $L$ не пустое, то выбрать другой элемент на шаге~\ref{step:every_element_in_L}
        
        \item Если множество $L$ пустое и $D_R < 3$, то вернуть ''$R \in \mathcal{T}$'' и завершить алгоритм
        
        \item Для всех $k \in [3, D_R]$
        \begin{enumerate}
            \item Построить множество
            \begin{equation*}
                B = \left\{
                    \alpha \in \zeroless{F} \big| \omega^{(k-2)}\left(
                        \fr{(\alpha-x_0)^{-1}}
                    \right) = 0
                \right\}
            \end{equation*}

            \item Для всех $\alpha_0 \in B$ попробовать найти такие $(\varepsilon_i) \in \invertible{R}$ и $(a_i), (b_i) \in R$, что $\elementnorm{a_i}, \elementnorm{b_i} \le M$ и
            \begin{equation*}
                \begin{split}
                    \beta_{i + 1} = \frac{1}{\varepsilon_i \beta_i + a_i} + b_i,\\
                    \beta_{k - 1} = \alpha \textrm{ или } \beta_{k-1} = \alpha^{-1},
                \end{split}
            \end{equation*}
            где $\beta_1 = 0$

            \item Если такие элементы не были найдены, то вернуть ''выберите большие $D_R$ и $M$'' и завершить алгоритм
            
            \item Если такие элементы были найдены и проверены все $x_0 \in L$, то вернуть ''$R \in \mathcal{T}$'' и завершить алгоритм
        \end{enumerate}
    \end{enumerate}
\end{algorithm}

\begin{proposition}
    Пусть алгоритм~$\ref{algorithm:R_in_T}$ вернул ''$R \in \mathcal{T}$''.
    Тогда $R \in \mathcal{T}$.
\end{proposition}
\begin{proof}
    Рассмотрим произвольный $x_0 \in R$.
    Если $x_0 \in J$, то тройка $(x_0, \alpha, D_R - 1)$ правильная для всех $\alpha \in \zeroless{F}$ и $D_R \in \mathbb{N}$.

    Рассмотрим множество $L_1$ всех элементов, что добавлялись в $L$.
    Если $(x_0, \ldots, x_k) \in L_1$, $(y_0, \ldots, y_l) \in L_1$ и $x_i = y_i$ для всех $i = \overline{1, k}$, $k \le l$, то удалим $(x_0, \ldots, x_k)$ из $L_1$.

    Зафиксируем $x_0$ и покажем, что тройка $(x_0, \alpha, D_R - 1)$ регулярная.
    Заметим, что, если тройка $(x_0, \alpha, k)$ регулярная, то тройка $(x_0, \alpha, k + i)$ регулярная для всех $i \in \mathbb{N}$.

    Рассмотрим элемент $(x_0, \ldots, x_l) \in L_1$.
    Этот элемент генерирует множество таких элементов $\alpha$, что
    \begin{equation*}
        x_l = \left(
            \left(
                \ldots \left(
                    \left(
                        \alpha - x_0
                    \right)^{-1} - x_1
                \right)^{-1} - \ldots
            \right)^{-1} - x_{l-1}
        \right)^{-1}.
    \end{equation*}
    Очевидно, что все такие элементы $L_1$ с фиксированным $x_0$ генерируют $\zeroless{F}$.
    
    Так как ответ алгоритма ''$R \in \mathcal{T}$'', то тройка $(x_0, \alpha, D_R - 1)$ регулярная для всех $x_0, \alpha$.
    Следовательно, выполняется первая часть определения множества $\mathcal{T}$.
    
    Если $D_R \ge 3$, тот доказательство проводится аналогично.
\end{proof}

\section{Теорема Кронекера-Валена в кольце алгебраических целых элементов числового поля}

% \subsection{Метод деления с выбором минимального по норме остатка}

\begin{lemma}
    Пусть $\xi \in K$ и $k > 0$.
    Обозначим $x = \Phi(\xi)$.
    Выберем такие элементы $z' \in \textrm{Orb}(x)$ и $Z'\in\mathcal{I}_{z', k}$, что $\mathcal{M}_k = |\mathcal{N}(z'-Z')|$.
    Если $\mathcal{M}_k \le k$, то $\int{\xi}$ можно вычислить за $O(1)$ арифметических операций в $K$.
\end{lemma}
\begin{proof}
    Из утверждения~\ref{statement:division_with_least_norm_remainder} следует, что
    \begin{equation*}
        m_{\overline{K}}(x) = \mathcal{M}_k.
    \end{equation*}
    
    Из определения $m_{\overline{K}}(x)$ следует, что
    \begin{equation*}
        \inf\limits_{z \in \mathcal{O}_K} |\mathcal{N}(x - \Phi(z))| = |\mathcal{N}(z' - Z')|.
    \end{equation*}

    Из того, что $z' \in \textrm{Orb}(x)$ следует, что существует $\varepsilon \in \invertible{\mathcal{O}_K}$ такое, что $z' = \Phi(\varepsilon)x$.
    Так как $\mathcal{N}(x) = \mathcal{N}(\Phi(\varepsilon)x)$ для всех $x \in \mathbb{R}^n$ и $\varepsilon \in \invertible{\mathcal{O}_K}$ выполнено следующее равенство
    \begin{equation*}
        \inf\limits_{z \in \mathcal{O}_K} |\mathcal(x - \Phi(z))| = |\mathcal{N}(x - Z'\Phi(\varepsilon^{-1}))|.
    \end{equation*}

    Таким образом, получаем, что $\int{\xi} = Z'\Phi(\varepsilon^{-1})$, где $\varepsilon$ задана соотношением $z' = \Phi(\varepsilon)x$.
    Следовательно, надо для $\xi \in R$ уметь вычислять $\textrm{Orb}(\Phi(\xi))$.
    Определим следующую операцию
    \begin{equation*}
        x = \sum\limits_{i=1}^n q_i e_i \longmapsto \overline{x} = \sum\limits_{i=1}^n (q_i - \lfloor q_i \rfloor)e_i.
    \end{equation*}
    
    Обозначим
    \begin{equation*}
        \mathcal{O}(\xi) = \left\{
            \overline{\varepsilon\xi} \Big| \varepsilon \in \invertible{\mathcal{O}_K}
    	\right\}.
    \end{equation*}
    
    Для каждого $1 \le i \le r$ существует такое положительное число $m$, что $\overline{\varepsilon_i}^m\overline{\xi} = \overline{\xi}$.
    Обозначим $l_i$ наименьшее такое число.
    Для $\nu$ наименьшее такое число обозначим $l$.
    Далее будем полагать, что $l$ и $l_i$ известны для $K$.
    
    Из работы \cite[с.~1413]{source:Lezowski} следует, что
    \begin{equation*}
        \mathcal{O}(\xi) = \left\{
            \overline{\nu}^m \prod\limits_{i=1}^r \overline{\varepsilon_i}^{m_i} \overline{\xi}:
                0 \le m < l, 0 \le m_i < l_i, 1 \le i \le r
        \right\}
    \end{equation*}
    и $\textrm{Orb}(\Phi(\xi)) = \{\Phi(\zeta):\zeta \in \mathcal{O}(\xi)\}$ для любого $\xi\in K$.

    Предположим, что мы знаем такие $m$ и $m_i$ что $\varepsilon = \nu^m\prod_{i=1}^r \varepsilon_i^{m_i}$.
    Так как $m$ и $m_i$ ограничены $l$ и $l_i$, то можно вычислить $\Phi(\varepsilon^{-1})$ за $O(1)$ арифметических операций.
\end{proof}

\begin{remark}
    Для произвольного $x \in \Phi(K)$ и $z \in \textrm{Orb}(x)$ будем предполагать, что известно такое $\varepsilon_z \in \invertible{\mathcal{O}_K}$, что $z = \Phi(\overline{\varepsilon_z \Phi^{-1}(x)})$, и более того можно вычислить $\varepsilon_z^{-1}$ за $O(1)$ арифметических операций.
\end{remark}

Используя доказанные выше утверждения, получаем следующий алгоритм.

\begin{algorithm}\label{algorithm:least_norm_remainder}
    Дано числовое поле $K$ и два элемента $a, b \in \mathcal{O}_K$.
    Необходимо вычислить наименьший остаток $r$ при делении $a$ на $b$.

    \begin{enumerate}
        \item Вычислить $x = \Phi(a/b) \in \Phi(K)$;
        
        \item Вычислить $\textrm{Orb}(x)$;

        \item Выбрать произвольное действительное $k > 0$;

        \item Вычислить $\Gamma(k)$ \label{loop:1};

        \item Объявить переменные $z'$ и $Z'$, которые будут инициализированы позже;

        \item Для всех $z \in \textrm{Orb}(x)$
        \begin{enumerate}
            \item Вычислить $\mathcal{I}_{z, k}$;

            \item Для всех $Z \in \mathcal{I}_{z, k}$, если $z'$ и $Z'$ не инициализированы или $\mathcal{N}(z' - Z') > \mathcal{N}(z - Z)$ положить $z' = z$ и $Z' = Z$;
        \end{enumerate}

        \item Вычислить $\mathcal{M}_k = \mathcal{N}(z' - Z')$
        
        \item Если $\mathcal{M}_k > k$, то положить $k = \mathcal{M}_k$ и перейти к шагу~\ref{loop:1}

        \item Вычислить $\int{\frac{a}{b}} = Z'\Phi((\varepsilon_z')^{-1})$

        \item Вернуть $r = a - b \int{\frac{a}{b}}$
    \end{enumerate}
\end{algorithm}

Оценим вычислительную сложность этого алгоритма.

\begin{proposition}
    Для любых $a, b \in \zeroless{\mathcal{O}_K}$ наименьший по норме остаток $r$ при делении $a$ на $b$ можно найти, используя алгоритм~$\ref{algorithm:least_norm_remainder}$, за $O(1)$ арифметических операций в $K$.
\end{proposition}
\begin{proof}
    Множество $\textrm{Orb}(x)$ можно найти за $O(1)$ арифметических операций в $K$ так как
    \begin{equation*}
        |\textrm{Orb}(x)| \le l\prod\limits_{i=1}^r l_i.
    \end{equation*}

    Заметим, что мощность множества $\mathcal{I}_{z, k}$ ограничена некоторой константой, зависящей только от $\Gamma(k)$, которая не зависит от $\frac{a}{b}$.
    Из утверждения~\ref{statement:division_with_least_norm_remainder} и того, что функция $k \to \mathcal{M}_k$ неубывающая следует, что цикл необходимо будет повторить не более двух раз.
    Следовательно, наименьший по норме остаток при делении $a$ на $b$ можно найти за $O(1)$ арифметических операций в $K$.
\end{proof}

% \subsection{Метод доказательства невыполнимости теоремы Кронекера-Валена}

В этой части работы будет представлен метод автоматического доказательства невыполнимости теоремы Кронекера-Валена в кольце целых алгебраических элементов числового поля $K$.
Метод доказательства приведен в алгоритме~\ref{algorithm:kronecker_vahlen_common}.

\begin{algorithm}\label{algorithm:kronecker_vahlen_common}
    Дано числовое поле $K$.
    Требуется доказать, что теорема Кронекера-Валена не выполняется в $\mathcal{O}_K$.
    
    \begin{enumerate}
        \item Взять произвольные $a, b \in \mathcal{O}_K$;

        \item Используя алгоритм~\ref{algorithm:least_norm_remainder} вычислить цепочку делений с выбором минимального по норме остатка $\mathcal{D}_{a, b}$;

        \item Найти такое $c \in \mathcal{O}_K$, что $a = bx + c$ для некоторого $x \in \mathcal{O}_K$;

        \item Используя алгоритм~\ref{algorithm:least_norm_remainder} вычислить цепочку делений с выбором минимального по норме остатка $\mathcal{D}'_{b,c}$;

        \item Если $\textrm{len}(\mathcal{D}_{a, b}) > \textrm{len}(\mathcal{D}'_{b, c}) + 1$, то теорема Кронекера-Валена не выполняется в $K$.
    \end{enumerate}
\end{algorithm}

% \subsection{Теорема Кронекера-Валена в действительных квадратичных норменно-евклидовых кольцах}

Рассмотрим применение описанного метода в случае, если поле $K$ такое, что $\mathcal{O}_K$ действительное квадратичное норменно-евклидово кольцо.

\begin{algorithm}\label{algorithm:kronecker_vahlen_special}
    Дано такое числовое поле $K$, что $\mathcal{O}_K$ действительное квадратичное норменно-евклидово кольцо
    Требуется доказать, что теорема Кронекера-Валена не выполняется в $\mathcal{O}_K$.

    \begin{enumerate}
        \item Взять произвольные $a, b \in \mathbb{Z}$;

        \item Используя алгоритм~\ref{algorithm:least_norm_remainder} вычислить цепочку делений с выбором минимального по норме остатка $\mathcal{D}_{a,b}$;

        \item Вычислить остаток $c$ при делении $a$ на $b$;

        \item Используя алгоритм~\ref{algorithm:least_norm_remainder} вычислить цепочку делений с выбором минимального по норме остатка $\mathcal{D}'_{b, c}$;

        \item Если $\textrm{len}(\mathcal{D}_{a, b}) > \textrm{len}(\mathcal{D}'_{b, c}) + 1$, то теорема Кронекера-Валена не выполняется в $K$;

        \item Вычислить $c = a \% b - b$;

        \item Используя алгоритм~\ref{algorithm:least_norm_remainder} вычислить цепочку делений с выбором минимального по норме остатка $\mathcal{D}''_{b,c}$;

        \item Если $\textrm{len}(\mathcal{D}_{a, b}) > \textrm{len}(\mathcal{D}''_{b, c}) + 1$, то теорема Кронекера-Валена не выполняется в $K$;
    \end{enumerate}
\end{algorithm}

Алгоритм~\ref{algorithm:kronecker_vahlen_special} был реализован на языке R.
Код программы приведен в приложении Б.
Используя эту реализацию алгоритма, была доказана следующая теорема.

\begin{theorem}\label{theorem:kronecker}
    Пусть поле $K$ такое, что $\mathcal{O}_K$ действительное квадратичное норменно-евклидово кольцо.
    Тогда теорема Кронекера-Валена не выполняется в $\mathcal{O}_K$.
\end{theorem}
\begin{proof}
    Существует $16$ полей $K = \mathbb{Q}(\sqrt{d})$, удовлетворяющих условиям теоремы.
    А именно
    \begin{equation*}
        \mathcal{O}_{\mathbb{Q}(\sqrt{2})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{3})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{5})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{6})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{7})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{11})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{13})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{17})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{19})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{21})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{29})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{33})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{37})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{41})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{57})},
        \mathcal{O}_{\mathbb{Q}(\sqrt{73})},
    \end{equation*}
    Используя код, приведенный в приложении Б, получаем контрпримеры для всех $\mathbb{Q}(\sqrt{d})$, которые опубликованы в работе~[\ref{source:JSC_2021}].
    Для каждого кольце получаем следующие цепочки делений с выбором минимального по норме остатка и более короткие цепочки делений:
    \begin{itemize}
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{2})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{50, 29, -8, -11-8\sqrt{2}, -7-5\sqrt{2}, 0\},\\
                \{50, 29, 21, 19601-13860\sqrt{2}, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{3})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{52, 38, 14, 24+14\sqrt{3}, 14+8\sqrt{3}, 0\},\\
                \{52, 38, -24, 2702-1560\sqrt{3}, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{5})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{58, 39, 17101-10569\frac{1+\sqrt{5}}{2},\\
                    -1974+1220\frac{1+\sqrt{5}}{2}, -377+233\frac{1+\sqrt{5}}{2}, 0\},\\
                \{58, 39, 19, 1, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{6})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{50, 33, -2425+990\sqrt{6}, -9602+3920\sqrt{6}, -485+198\sqrt{6}, 0\},\\
                \{50, 33, 17, -1, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{7})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{50, 23, -5355+2024\sqrt{7}, -20830+7873\sqrt{7}, 2024-765\sqrt{7}, 0\},\\
                \{50, 23, 4, -1, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{11})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{50, 34, -902+272\sqrt{11}, -252+76\sqrt{11}, -398+120\sqrt{11}, 0\},\\
                \{50, 34, 16, 2, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{13})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{52, 19, -355666+154451\frac{1+\sqrt{13}}{2},\\
                    -128511+55807\frac{1+\sqrt{13}}{2}, -98644+42837\frac{1+\sqrt{13}}{2}, 0\},\\
                \{52, 19, -5, -1, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{17})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{51, 14, 11153-4354\frac{1+\sqrt{17}}{2},\\
                    3038-1186\frac{1+\sqrt{17}}{2}, 333-130\frac{1+\sqrt{17}}{2}, 0\},\\
                \{51, 14, -5, -1, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{19})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{70, 29, -6194+1421\sqrt{19}, 3012-691\sqrt{19}, -170+39\sqrt{19}, 0\},\\
                \{70, 29, 12, -57799+13260\sqrt{19}, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{21})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{50, 33, 36845-13200\frac{1+\sqrt{21}}{2},\\
                    14738-5280\frac{1+\sqrt{21}}{2}, 7369-2640\frac{1+\sqrt{21}}{2}, 0\},\\
                \{50, 33, 17, -1, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{29})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{54, 21, 201-63\frac{1+\sqrt{29}}{2}, 96-30\frac{1+\sqrt{29}}{2}, -9+3\frac{1+\sqrt{29}}{2}, 0\},\\
                \{54, 21, 12, -3, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{33})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{50, 27, 58999613-17495460\frac{1+\sqrt{33}}{2},\\
                    -30811543+9136706\frac{1+\sqrt{33}}{2}, -2623473+777952\frac{1+\sqrt{33}}{2}, 0\},\\
                \{50, 27, -4, -1, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{37})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{51, 23, -2525+713\frac{1+\sqrt{37}}{2},\\
                    471-133\frac{1+\sqrt{37}}{2}, 1027-290\frac{1+\sqrt{37}}{2}, 0\},\\
                \{51, 23, 5, -1027+290\frac{1+\sqrt{37}}{2}, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{41})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{51, 33, -12093+3267\frac{1+\sqrt{41}}{2},\\
                    -47628+12867\frac{1+\sqrt{41}}{2}, 454959-122910\frac{1+\sqrt{41}}{2}, 0\},\\
                \{51, 33, 18, -3, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{57})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{51, 31, -11, -2, -1, 0\},\\
                \{51, 31, 20, 131+40\frac{1+\sqrt{57}}{2}, 0\}.
            \end{split}
        \end{equation*}
    
        \item $\mathcal{O}_{\mathbb{Q}(\sqrt{73})}$.
        Цепочки делений:
        \begin{equation*}
            \begin{split}
                \{57, 32, -7, -580996+121751\frac{1+\sqrt{73}}{2},\\
                    2548249-534000\frac{1+\sqrt{73}}{2}, 0\},\\
                \{57, 32, 25, -943-250\frac{1+\sqrt{73}}{2}, 0\}.
            \end{split}
        \end{equation*}
    \end{itemize}
    
\end{proof}

\begin{corollary}
    Пусть $R = \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$~-- квадратичное норменно-евклидово кольцо.
    Теорема Кронекера-Валена выполняется в $R$ тогда и только тогда, когда $d=-1, -2, -3, -7$.
\end{corollary}
\begin{proof}
    Если $d \ge 0$, то утверждение следует из теоремы~\ref{theorem:kronecker}.
    Если $d < 0$, то утверждение следует из работы~\cite[с.~322]{source:Rolletschek_1990}.
\end{proof}

\section{Теорема Ламе в факториальных кольцах}

Ранее было показано, что при определенных условиях на кольцо цепочка делений с выбором минимального по норме остатка является кратчайшей.
Однако существуют кольца, для которых эти условия не выполняются.
В таких кольцах цепочка делений с выбором минимального по норме остатка не является кратчайшей.
Например, в работе~\cite[с.~322]{source:Rolletschek_1990} было показано, что теорема Кронекера-Валена не выполняется в кольце $\mathcal{O}_{\mathbb{Q}(\sqrt{-11})}$.
В работе~\cite[с.~483]{source:Cooke} было показано, что для колец целых алгебраических чисел с бесконечной группой единиц длина кратчайшей цепочки делений с выбором минимального по норме остатка ограничена константой.
Следовательно, важным вопросом является исследование асимптотического поведения длины кратчайшей цепочки делений.

\begin{definition}
    Пусть $d \neq 1$~-- целое число свободное от квадратов.
    Под \emph{фундаментальной областью поля} $\mathbb{Q}(\sqrt{d})$ понимают множество, заданное следующим образом
    \begin{equation*}
        F(d) = \begin{cases}
            \left(
                \left[0, \frac{1}{2}\right] \times \left[0, \frac{1}{2}\right]
            \right) \cap \left(
                \mathbb{Q} \times \mathbb{Q}
            \right), \textrm{ если } d \not\equiv 1 \pmod 4\\
            \left(
                \left[0, \frac{1}{2}\right] \times \left[0, \frac{1}{4}\right]
            \right) \cap \left(
                \mathbb{Q} \times \mathbb{Q}
            \right), \textrm{ если } d \equiv 1 \pmod 4
        \end{cases}
    \end{equation*}
\end{definition}

\begin{definition}
    Пусть $d \neq 1$~-- целое число свободное от квадратов.
    Под окрестностью точки $\lambda = \lambda_1 + \lambda_2 \sqrt{d} \in \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$ радиуса $r > 0$ понимают множество заданное следующим образом
    \begin{equation*}
        U(\lambda, r) = \left\{
            q_1 + q_2 \sqrt{d} \in Q[\sqrt{d}] \big| |(q_1 - \lambda_1)^2 - d(q_2 - \lambda_2)^2| < r
        \right\}.
    \end{equation*}

    Под окрестностью множества точек $\Lambda \subseteq \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$ радиуса $r > 0$ понимают множество заданное следующим образом
    \begin{equation*}
        U(\Lambda, r) = \bigcup_{\lambda \in \Lambda} U(\lambda, r).
    \end{equation*}
\end{definition}

В работе~\cite[с.~832]{source:Selfridge} доказано следующее утверждение.

\begin{statement}\label{proposition:fundamental_in_circle} \cite[с.~832]{source:Selfridge}
    Пусть $d \neq 1$~-- целое число свободное от квадратов.
    Тогда кольцо $\mathcal{O}_{\mathbb{Q}(\sqrt{d})}$ является евклидовым относительно нормы числового поля $\mathbb{Q}(\sqrt{d})$ тогда и только тогда, когда существует множество $\Lambda \subseteq \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$, что
    \begin{equation*}
        F(d) \subseteq U(\Lambda, 1).
    \end{equation*}
\end{statement}

\begin{definition}\label{definition:euclidean_lambda}
    Для $m/n \in F_1$ рассмотрим функцию
    \begin{equation*}
        |m/n| = \begin{cases}
            \frac{\elementnorm{m}}{\elementnorm{n}}, & m \neq 0, (m, n) = 1\\
            0, & m = 0
        \end{cases}.
    \end{equation*}
    Обозначим
    \begin{equation*}
        \Lambda_K = \sup_{m/n \in F_1} |m/n|.
    \end{equation*}
\end{definition}

\begin{theorem}\label{theorem:euclidean_and_lambda}
    Если $R$~-- евклидово кольцо относительно нормы $\elementnorm{\cdot}$, то $\Lambda_R \in [0, 1]$.

    Если $R$~-- факториальное кольцо с мультипликативной нормой $\elementnorm{\cdot}$ и $\Lambda_R \in [0, 1)$, то $R$~-- евклидово относительно нормы $\elementnorm{\cdot}$ и $l_n(R) \le [\log_{\Lambda_R^{-1}} n] + 2$ для всех $n \in \mathbb{N}$, где $\log_{\infty} n = 0$.
\end{theorem}
\begin{proof}
    Пусть $R$~-- евклидово кольцо относительно нормы $\elementnorm{\cdot}$.
    Рассмотрим произвольный элемент $\frac{a}{b} \in \zeroless{F_1}$, где $a, b \in \zeroless{R}$, $(a, b) = 1$.
    Так как кольцо евклидово, то существуют такие $q, r \in R$, что $a = bq + r$ и $\elementnorm{r} < \elementnorm{b}$.
    Так как $\fr{\frac{a}{b}} = \frac{a}{b}$, то $\elementnorm{a} \le \elementnorm{r}$.
    Следовательно, $\left|\frac{a}{b}\right| = \frac{\elementnorm{a}}{\elementnorm{b}} \le \frac{\elementnorm{v}}{\elementnorm{b}} < 1$.
    Из этого следует, что $\Lambda_R \in [0, 1]$.

    Пусть $R$~-- факториальное кольцо и $\Lambda_R \in [0, 1)$.
    Рассмотрим произвольные $a, b \in \zeroless{K}$.
    Положим $q = \int{\frac{a}{b}}$, $r = b\fr{\frac{a}{b}}$.
    Тогда $a = bq + r$ и $\elementnorm{r} \le \Lambda_R \elementnorm{b}$ из определения $\Lambda_R$.
    Если $\elementnorm{b} > 0$, то $\elementnorm{r} \le \Lambda_R \elementnorm{b} < \elementnorm{b}$.
    Если $\elementnorm{b} = 0$, то $b$ обратимый элемент.
    Тогда получаем $q = 0$, $r = 0$ и $a = 0$.
    Следовательно, $R$~-- евклидово.
\end{proof}

\begin{theorem}
    Пусть $d \neq 1$ целое число свободное от квадратов.
    Если кольцо $\mathcal{O}_{\mathbb{Q}(\sqrt{d})}$ евклидово относительно нормы числового поля $\elementnorm{\cdot}$, то $l_n(\mathcal{O}_{\mathbb{Q}(\sqrt{d})}) = O(\log n)$.
\end{theorem}
\begin{proof}
    Обозначим
    \begin{equation*}
        E(d) = \begin{cases}
            \left[0, \frac{1}{2}\right] \times \left[0, \frac{1}{2}\right], \textrm{ если } d \not\equiv 1 \pmod 4\\
            \left[0, \frac{1}{2}\right] \times \left[0, \frac{1}{4}\right], \textrm{ если } d \equiv 1 \pmod 4
        \end{cases}
    \end{equation*}

    Для $\lambda = \lambda_1 + \lambda_2 \sqrt{d} \in \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$ и $r > 0$ обозначим
    \begin{equation*}
        V(\lambda, r) = \left\{
            (x, y) \in R \times R \Big| \left|(x - \lambda_1)^2 - d(y - \lambda_2)^2\right| < r
        \right\}.
    \end{equation*}

    Для множества точек $\Lambda \subseteq \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$ и $r > 0$ обозначим
    \begin{equation*}
        V(\Lambda, r) = \bigcup_{\lambda \in \Lambda} V(\lambda, r).
    \end{equation*}

    Из предложения~\ref{proposition:fundamental_in_circle} следует, что существует множество $\Lambda \subseteq \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$, что $F(d) \subseteq U(\Lambda, 1)$.
    Докажем, что $E(d) \subseteq V(\Lambda, 1)$.

    Предположим, что $(x_0, y_0) \in E(d) \setminus V(\Lambda, 1)$.
    Так как $F(d) \setminus U(\Lambda, 1) = \emptyset$, то или $x_0 \not\in \mathbb{Q}$, или $y_0 \not\in \mathbb{Q}$.

    Предположим, что $x_0 \not\in \mathbb{Q}$.
    Тогда существует $\varepsilon_x > 0$ и $x \in [x_0 - \varepsilon_x, x_0 + \varepsilon_x] \cap \mathbb{Q}$, что $(x, y_0) \in E(d) \setminus V(\Lambda, 1)$.
    Следовательно, можно считать, что $x_0 \in \mathbb{Q}$ и $y_0 \not\in \mathbb{Q}$.
    Тогда существует $\varepsilon_y > 0$ и $y \in [y_0 - \varepsilon_y, y_0 + \varepsilon_y] \cap \mathbb{Q}$, что $(x_0, y) \in E(d) \setminus V(\Lambda, 1)$.
    Получаем противоречие с условием $F(d) \setminus U(\Lambda, 1) = \emptyset$.
    Следовательно, выполнено $E(d) \subseteq V(\Lambda, 1)$.

    Докажем, что существует $r_0 < 1$, что $F(d) \subseteq U(\Lambda, r_0)$.
    Используя рассуждения выше, заметим, что для этого достаточно показать, что $E(d) \subseteq V(\Lambda, r_0)$ для некоторого $r_0 < 1$.
    
    Множество $E(d)$ замкнутое.
    Следовательно, существует такая точка $(x_0, y_0) \in E(d)$, что
    \begin{equation*}
        r_{x_0} = \min_{\substack{
            \lambda \in V(\Lambda, 1),\\
            \lambda = \lambda_1 + \lambda_2 \sqrt{d}
        }} \left|
            (x_0 - \lambda_1)^2 - d(y_0 - \lambda_2)^2
        \right| = \min_{\substack{
            x \in E(d),\\
            \lambda \in V(\Lambda, 1),\\
            \lambda = \lambda_1 + \lambda_2 \sqrt{d}
        }} \left|
            (x - \lambda_1)^2 - d(y - \lambda_2)^2
        \right|.
    \end{equation*}
    Заметим, что $r_{x_0} < 1$, так как $E(d) \subseteq V(\Lambda, 1)$.

    Следовательно, существует $r_0 < 1$, что $F(d) \subseteq U(\Lambda, r_0)$.
    Рассмотрим произвольные $\gamma, \delta \in \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$, $\delta \neq 0$.
    Из доказанного выше следует, что существует $q \in \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$, что $\elementnorm{\frac{\gamma}{\delta} - q} \le r_0$.
    Так как $\elementnorm{\frac{\gamma}{\delta} - q} = \frac{\elementnorm{\gamma - q\delta}}{\elementnorm{\delta}}$, то получаем, что существуют $q, r \in \mathcal{O}_{\mathbb{Q}(\sqrt{d})}$, что $\gamma = q\delta + r$ и $\elementnorm{r} \le r_0 \elementnorm{\delta}$.
    Следовательно, $\Lambda_{\mathcal{O}_{\mathbb{Q}(\sqrt{d})}} \le r_0$.

    Тогда, из теоремы~\ref{theorem:euclidean_and_lambda} следует, что $l_n(\mathcal{O}_{\mathbb{Q}(\sqrt{d})}) \le [\log_{r_0^{-1}} n] + 2$.
\end{proof}

\section*{Выводы по главе~\ref{chapter:Kronecker-Vahlen theorem}}
\addcontentsline{toc}{section}{Выводы по главе~\ref{chapter:Kronecker-Vahlen theorem}}

В данной главе диссертации получены достаточные условия для выполнения аналога теоремы Кронекера-Валена в факториальном кольце.
Разработан метод проверки этого достаточного условия.
Разработан метод автоматического доказательства невыполнимости теоремы Кронекера-Валена в факториальном кольце.
Используя этот метод доказано, что теорема Кронекера-Валена не выполняется во всех действительных квадратичных норменно-евклидовых кольцах.
Получены оценки длины цепочки делений с выбором минимального по норме остатка в евклидовых кольцах.

Результаты, полученные в данной главе опубликованы в работах [\ref{source:Vestnik_BSU_2013}; \ref{source:JSC_2016}; \ref{source:JSC_2021}; \ref{source:Republican_Scientific_Conference_of_Students_and_Postgraduates_2013}].

\onlyinsubfile{
    \subfile{_10_bibliography}
}

\end{document}
