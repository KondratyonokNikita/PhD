\documentclass[_00_dissertation.tex]{subfiles}
\begin{document}

\onlyinsubfile{
    \renewcommand{\contentsname}{ОГЛАВЛЕНИЕ}
    \setcounter{tocdepth}{3}
    \tableofcontents
}

\newpage
\begin{center}
    \refstepcounter{section}
    \section*{ГЛАВА \arabic{section}.\\ ТЕСТИРОВАНИЕ ИДЕАЛОВ НА ПРОСТОТУ В ДЕДЕКИНДОВЫХ КОЛЬЦАХ}\label{ch:Primality}
    \addcontentsline{toc}{chapter}{ГЛАВА \arabic{section}. ТЕСТИРОВАНИЕ ИДЕАЛОВ НА ПРОСТОТУ В ДЕДЕКИНДОВЫХ КОЛЬЦАХ}
\end{center}

\subsection{Аналог критерия Эйлера}

\begin{theorem}\label{theorem:euler_criteria}
    Пусть $\ideal{n}$ -- нетривиальный идеал нечетной нормы дедекиндового кольца $R$.
    Тогда $\ideal{n}$ -- простой идеал тогда и только тогда, когда для любого идеала $\ideal{a} \in \invertible{R/\ideal{n}}$ выполнено
    \begin{equation*}
        a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \left[\frac{\ideal{a}}{\ideal{n}}\right] \pmod{\ideal{n}}.
    \end{equation*}
\end{theorem}
\begin{proof}
    Предположим, что $\ideal{n}$ -- простой идеал.
    Рассмотрим произвольный идеал $\ideal{a} \in \invertible{R/\ideal{n}}$.
    Пусть $g$ -- первообразный корень $\invertible{R/\ideal{n}}$.

    Так как $\Nm{\ideal{n}}$ нечетный, то $\ideal{a}$ является квадратичным вычетом тогда и только тогда, когда существует такое $t' = 2t \in \{0, 2, \dots, \Nm{\ideal{n}} - 1\}$, что $a \equiv g^{t'} \pmod{\ideal{n}}$.
    Так как порядок $g$ равен $\Nm{\ideal{n}} - 1$, то последнее сравнение выполняется тогда и только тогда, когда $a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv 1 \pmod{\ideal{n}}$.
    Это завершает доказательство необходимости.

    Предположим, что $\ideal{n}$ -- не простой идеал.
    Пусть $\ideal{n}$ раскладывается в произведение простых идеалов следующим образом $\ideal{n} = \prod_{i=1}^{r} \ideal{p}_i^{\alpha_i}$.
    Так как норма простого идеала примарная, то обозначим $\Nm{\ideal{p}_i} = q_i^{f_i}$, где $q_i$ -- простой в $\mathbb{Z}$.
    Пусть для любого $\ideal{a} \in \invertible{R/\ideal{n}}$ выполнено $a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \left[\frac{\ideal{a}}{\ideal{n}}\right] \pmod{\ideal{n}}$.

    Пусть существует такой $j \in \{1, \dots, r\}$, что $\alpha_j > 1$ в разложении $\ideal{n}$ на множители.
    Из теоремы Коши для групп \ref{statement:cauchy} и свойств функции Эйлера \ref{statement:euler_function} следует, что существует $\ideal{a} \in \invertible{R/\ideal{n}}$ порядка $q_j$.
    Тогда $q_j | \Nm{\ideal{n}} - 1$, что невозможно.

    Следовательно, $\alpha_j = 1$ для любого $j \in \{1, \ldots, r\}$.
    Так как $\ideal{n}$ -- составное, то $r \ge 2$.
    Рассмотрим произвольный квадратичный невычет $\ideal{b} \in \invertible{R/\ideal{p}_1}$.
    Согласно аналогу Китайской теоремы об остатках \ref{statement:chinese_remainder_theorem} существует такой $\ideal{a} \in \invertible{R/\ideal{n}}$, что выполнено $a \equiv b \pmod{\ideal{p}_1}$ и $a \equiv 1 \pmod{\ideal{p}_2\dots\ideal{p}_r}$.
    Но в этом случае $\left[\frac{\ideal{a}}{\ideal{n}}\right] = -1$.
    Из условия теоремы следует, что $a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv -1 \pmod{\ideal{n}}$, что противоречит условию $a \equiv 1 \pmod{\ideal{p}_2}$.
    Это завершает доказательство достаточности.

    Теорема доказана.
\end{proof}

\begin{algorithm}\label{algorithm:solovay_strassen}
    Дан нетривиальный идеал $\ideal{n} \subset R$.
    Необходимо определить является ли он простым.

    \begin{enumerate}
        \item Вычислить $\Nm{\ideal{n}}$;
        
        \item Выбрать случайное $\ideal{a} \subset \invertible{R/\ideal{n}}$;

        \item Вычислить $r_0 = \ideal{a}^{\frac{\Nm{\ideal{n}} -- 1}{2}} \pmod{\ideal{n}}$;

        \item Вычислить $r_1 = \left[\frac{\ideal{a}}{\ideal{n}}\right]$;

        \item Если $r_0 \equiv r_1 \pmod{\ideal{n}}$, то вернуть ''неизвестно'' и завершить алгоритм;

        \item Вернуть ''$\ideal{n}$ не простой'' и завершить алгоритм.
    \end{enumerate}
\end{algorithm}

\begin{remark}
    Алгоритм \ref{algorithm:solovay_strassen} является вероятностным.
    Если был получен ответ "неизвестно", то можно выполнить алгоритм еще раз.
\end{remark}

\begin{proposition}
    Пусть $\ideal{n}$ -- не простой идеал.
    Тогда вероятность ответа "$\ideal{n}$ не простой" у алгоритма \ref{algorithm:solovay_strassen} не менее $1/2$.
\end{proposition}
\begin{proof}
    Рассмотрим множество
    \begin{equation*}
        G = \left\{
            \ideal{a} \in \invertible{R/\ideal{n}} \big| \ideal{a}^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \left[\frac{\ideal{a}}{\ideal{n}}\right] \pmod{\ideal{n}}
        \right\}.
    \end{equation*}
    Алгоритм~\ref{algorithm:solovay_strassen} возвращает ответ ''неизвестно'' только для элементов из множества $G$.

    Заметим, что если алгоритм~\ref{algorithm:solovay_strassen} возвращает ответ ''неизвестно'' для $\ideal{a}$ и $\ideal{b}$, то он вернет ответ ''неизвестно'' и для $\ideal{a}\ideal{b}$.
    Следовательно, $G$ образует подгруппу группы $\invertible{R/\ideal{n}}$.

    Исходя из критерия Эйлера эта подгруппа собственная.
    Из теоремы Лагранжа~\ref{statement:lagrange} выполнено $|G|/|\invertible{R/\ideal{n}}| \le \frac{1}{2}$.
\end{proof}

\begin{remark}
    Если $\ideal{n}$ -- составной, то при выполнении алгоритма \ref{algorithm:miller_rabin} $k$ раз вероятность получить ответ ''$\ideal{n}$ не простой'' не меньше $1 - \frac{1}{2^k}$.
\end{remark}

\subsection{Аналог критерия Миллера}

\begin{theorem}\label{theorem:miller_criteria}
    Пусть $\ideal{n}$ -- нетривиальный идеал нечетной нормы дедекиндового кольца $R$.
    Пусть $\Nm{\ideal{n}} - 1 = 2^t u$, $(u, 2) = 1$.
    Тогда $\ideal{n}$ -- простой идеал тогда и только тогда, когда для любого идеала $\ideal{a} \in \invertible{R/\ideal{n}}$, $(\ideal{a}, \ideal{n}) = 1$, $\ideal{a}^u \not\equiv 1 \pmod{\ideal{n}}$ существует $k\in \{0, \dots, t-1\}$, такое что $\ideal{a}^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.
\end{theorem}
\begin{proof}
    Предположим, что $\ideal{n}$ -- простой идеал.
    Рассмотрим произвольный идеал $\ideal{a} \in \invertible{R/\ideal{n}}$, $(\ideal{a}, \ideal{n}) = 1$, $\ideal{a}^u \not\equiv 1 \pmod{\ideal{n}}$.
    Из теоремы Эйлера \ref{statement:euler_function} следует, что:
    \begin{equation*}
        \ideal{a}^{2^{t} u} = \ideal{a}^{\varphi(\ideal{n})} \equiv 1 \pmod{\ideal{n}}
    \end{equation*}

    Раскладываем на множители и получаем, что выполнено
    \begin{equation*}
        (\ideal{a}^{u} - 1)(\ideal{a}^{u} + 1)(\ideal{a}^{2u} + 1)\dots(\ideal{a}^{2^{t-1}u} + 1) \equiv 0 \pmod{\ideal{n}}
    \end{equation*}

    Из того, что $\ideal{a}^{u} \not\equiv 1 \pmod{\ideal{n}}$ следует, что $\ideal{a}^{2^{k}u} + 1 \equiv 0 \pmod{\ideal{n}}$ для некоторого $k\in \{0, \dots, t-1\}$.
    Это завершает доказательство необходимости.

    Предположим, что $\ideal{n}$ -- не простой идеал.
    Пусть $\ideal{n}$ раскладывается в произведение простых идеалов следующим образом $\ideal{n} = \prod_{i=1}^{r} \ideal{p}_i^{\alpha_i}$.
    Так как норма простого идеала примарная, то обозначим $\Nm{\ideal{p}_i} = q_i^{f_i}$, где $q_i$ -- простой в $\mathbb{Z}$.

    Пусть существует такой $j \in \{1, \dots, r\}$, что $\alpha_j > 1$ в разложении $\ideal{n}$ на множители.
    Из теоремы Коши для групп \ref{statement:cauchy} и свойств функции Эйлера~\ref{statement:euler_function} следует, что существует $\ideal{a} \in \invertible{R/\ideal{n}}$ порядка $q_j$.
    Так как $u \not\equiv 0 \pmod{q_j}$, то $\ideal{a}^u \not\equiv 1 \pmod{\ideal{n}}$.
    Следовательно, существует число $k \in \{1, \dots, t-1\}$, такое что выполнено сравнение $\ideal{a}^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.
    Тогда $\ideal{a}^{2^{k+1}u} \equiv 1 \pmod{\ideal{n}}$.
    Значит выполнено $2^{k+1}u \equiv 0 \pmod{q_j}$.
    Из последнего сравнения следует, что $\Nm{\ideal{n}} - 1 \equiv 0 \pmod{q_j}$, что невозможно.
    
    Следовательно, $\alpha_j = 1$ для любого $j \in \{1, \ldots, r\}$.
    Так как $\ideal{n}$ -- составное, то $r \ge 2$.
    Из аналога Китайской теоремы об остатках~\ref{statement:chinese_remainder_theorem} и того, что элемент $-1$ имеет порядок $2$ в каждой группе $\invertible{R/\ideal{p}_j}$ следует, что существует по крайней мере $2^r-1 \ge 3$ элемента $\invertible{R/\ideal{n}}$ порядка $2$.
    Пусть $\ideal{a} \not\equiv \pm 1 \pmod{\ideal{n}}$ является произвольным элементом порядка $2$ в группе $\invertible{R/\ideal{n}}$.
    Из того, что $(u, 2) = 1$ следует, что $\ideal{a}^u \equiv \ideal{a} \not\equiv \pm 1 \pmod{\ideal{n}}$.
    Таким образом, существует $k \in \{0,\ldots, t-1\}$, такое что верно $\ideal{a}^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.
    Это противоречит тому, что порядок $\ideal{a}$ равен $2$.
    Это завершает доказательство достаточности.

    Теорема доказана.
\end{proof}

\begin{algorithm}\label{algorithm:miller_rabin}
    Дан идеал $\ideal{n} \subset R$.
    Необходимо определить является ли он простым.

    \begin{enumerate}
        \item Найти $u, t \in \mathbb{N}$, что $\Nm{\ideal{n}} - 1 = 2^t u$ и $(2, u) = 1$;
        
        \item Выбрать случайное $\ideal{a} \subset \invertible{R/\ideal{n}}\setminus\{0\}$;

        \item Вычислить $r_0 = \ideal{a}^u \pmod{\ideal{n}}$;

        \item Если $r_0 = 1$, то вернуть ''неизвестно'' и завершить алгоритм;

        \item Положить $k = 0$;

        \item Пока $k < t$ выполнять:
        \begin{enumerate}
            \item Если $r_k = -1$, то вернуть ''неизвестно'' и завершить алгоритм;

            \item Увеличить $k$ на $1$;

            \item Вычислить $r_{k+1} \equiv r_k^2 \pmod{\ideal{n}}$;
        \end{enumerate}

        \item Вернуть ''$\ideal{n}$ не простой'' и завершить алгоритм.
    \end{enumerate}
\end{algorithm}

\begin{remark}
    Алгоритм \ref{algorithm:miller_rabin} является вероятностным.
    Если был получен ответ "неизвестно", то можно выполнить алгоритм еще раз.
\end{remark}

\begin{proposition}
    Пусть $\ideal{n}$ -- не простой идеал.
    Тогда вероятность ответа "$\ideal{n}$ не простой" у алгоритма \ref{algorithm:miller_rabin} не менее $1/2$.
\end{proposition}
\begin{proof}
    Рассмотрим множество всех $\ideal{a}$, для которых алгоритм дает ответ "неизвестно".
    Это в точности множество таких $\ideal{a}$, что $\ideal{a}^u \equiv 1 \pmod{\ideal{n}}$ или для которых существует $j \in \{0, \dots, t-1\}$, что $\ideal{a}^{2^{j}u} \equiv -1 \pmod{\ideal{n}}$.
    Из этого следует, что $\ideal{a}^{\Nm{\ideal{n}} - 1} \equiv 1 \pmod{\ideal{n}}$ для всех таких $\ideal{a}$.

    Рассмотрим множество
    \begin{equation*}
        G = \left\{
            \ideal{a} \in \invertible{R/\ideal{n}} \big| \ideal{a}^{\Nm{\ideal{n}} - 1} \equiv 1 \pmod{\ideal{n}}
        \right\}.
    \end{equation*}
    Предположим, что $G$ -- нетривиальная подгруппа.
    Тогда из теоремы Лагранжа следует, что $|G| / |\invertible{R/\ideal{n}}| \le 1/2$.
    Из этого следует верность теоремы для этого случая.

    Предположим, что $\ideal{n}$ такой, что $G = \invertible{R/\ideal{n}}$.
    Пусть $\ideal{n}$ раскладывается в произведение простых идеалов следующим образом $\ideal{n} = \prod_{i=1}^r \ideal{p}_i^{\alpha_i}$.
    Так как норма простого идеала примарная, то обозначим $\Nm{p_i} = q_i^{f_i}$, где $q_i$ -- простой в $\mathbb{Z}$.

    Предположим, что существует такой $j \in \{1, \dots, r\}$, что $\alpha_i > 1$ в разложении $\ideal{n}$ на множители.
    Тогда $\Nm{\ideal{p}_j} | \varphi(\ideal{n})$, следовательно $q_j | \varphi(\ideal{n})$.
    Из теоремы Коши для групп~\ref{statement:cauchy} следует, что в группе $\invertible{R/\ideal{n}}$ существует элемент $a$ порядка $q_j$.
    Из теоремы Эйлера~\ref{statement:euler_function} следует, что $a^{\Nm{\ideal{n}} - 1} \equiv 1 \pmod{\ideal{n}}$, следовательно, $a^{\Nm{\ideal{n}} - 1} \equiv 1 \pmod{\ideal{p}}$.
    Из утверждений выше получаем, что $q_j | \Nm{\ideal{n}} - 1$.
    Это противоречит тому, что $q_j | \Nm{\ideal{n}}$.

    Следовательно, $\alpha_j = 1$ для любого $j \in \{1, \dots, r\}$.
    Так как $\ideal{n}$ -- составное, то $r \ge 2$.
    Обозначим $\Nm{\ideal{p}_i} - 1 = 2^{t_i} u_i$, где $(u_i, 2) = 1$.
    Так же обозначим $s = \min_{i=\overline{1, r}} t_i$, $P = \prod_{i=1}^r (u_i, u)$.

    Из аналога Китайской теоремы об остатках~\ref{statement:chinese_remainder_theorem} следует, что
    \begin{equation*}
        a^u \equiv 1 \pmod{\ideal{n}}
        \Leftrightarrow
        a^u \equiv 1 \pmod{\ideal{p}_i}, i=\overline{1, r}.
    \end{equation*}

    Из теоремы Эйлера~\ref{statement:euler_function} следует, что
    \begin{equation*}
        a^u \equiv 1 \pmod{\ideal{p}_i}
        \Leftrightarrow
        \lambda u \equiv 0 \pmod{\Nm{\ideal{p}_i} - 1},
    \end{equation*}
    где $a \equiv g^\lambda \pmod{\ideal{p}_i}$ и $g$ -- первообразный корень $\invertible{R/\ideal{p}_i}$.
    Так как последнее сравнение имеет $(u, \Nm{\ideal{p}_i} - 1)$ решений, то количество решений сравнения $a^u \equiv 1 \pmod{\ideal{n}}$ равно
    \begin{equation*}
        \prod_{i=1}^r (u, \Nm{\ideal{p}_i} - 1) = P.
    \end{equation*}

    Аналогично получаем, что
    \begin{equation*}
        a^{2^j u} \equiv -1 \pmod{\ideal{n}}
        \Leftrightarrow
        \lambda 2^j u \equiv \frac{\Nm{\ideal{p}_i} - 1}{2} \pmod{\Nm{\ideal{p}_i} - 1}, i=\overline{1, r}.
    \end{equation*}
    Заметим, что сравнение $\lambda 2^j u \equiv \frac{\Nm{\ideal{p}_i} - 1}{2} \pmod{\Nm{\ideal{p}_i} - 1}$ не имеет решений при $j \ge t_i$ и имеет $(2^j u, \Nm{\ideal{p}_i} - 1)$ решений при $j < t_i$.
    Тогда количество решений $a^{2^j u} \equiv -1 \pmod{\ideal{n}}$ равно
    \begin{equation*}
        \prod_{i=1}^r (2^j u, \Nm{\ideal{p}_i} - 1) = 2^{jr} \prod_{i=1}^r (u, \Nm{\ideal{p}_i} - 1) = 2^{jr} P.
    \end{equation*}

    Следовательно, количество идеалов $a \in \invertible{R/\ideal{n}}$, на которых алгоритм дает ответ ''неизвестно'' равно
    \begin{equation*}
        P + \sum_{j=1}^{s-1} 2^{jr} P = P\left(1 + \frac{2^{rs} - 1}{2^r - 1}\right) = P\frac{2^{rs} + 2^r - 2}{2^r - 1}
    \end{equation*}

    Исходя из определения, получаем
    \begin{equation*}
        |\invertible{R/\ideal{n}}| = \varphi(\ideal{n}) = \prod_{i=1}^r \varphi(\ideal{p}_i) = \prod_{i=1}^r (\Nm{\ideal{p}_i} - 1) = \prod_{i=1}^r 2^{t_i} u_i \ge 2^{rs} P.
    \end{equation*}

    Таким образом
    \begin{equation*}
        |G|/|\invertible{R/\ideal{n}}| \le \frac{2^{rs} + 2^r - 2}{2^{rs}(2^r - 1)} \le \frac{1}{2}.
    \end{equation*}
\end{proof}

\begin{remark}
    Если $\ideal{n}$ -- составной, то при выполнении алгоритма \ref{algorithm:miller_rabin} $k$ раз вероятность получить ответ ''$\ideal{n}$ не простой'' не меньше $1 - \frac{1}{2^k}$.
\end{remark}

\subsection{Детерминированное тестирование на простоту}

\begin{definition}
    Характером группы $G$ называется гомоморфизм $\chi: G \to \zeroless{\mathbb{C}}$.
    Характер называется тривиальным, если его образ является тривиальной группой, т.е. состоит из $1$ элемента.
\end{definition}

% \begin{definition}
%     Характером Дирихле по модулю $\ideal{n}$ называется гомоморфизм $\chi: \invertible{R/\ideal{n}} \setminus \{0\} \to \mathbb{C}$, для которой выполнено:
%     \begin{itemize}
%         \item если $(\ideal{a}, \ideal{n}) > 1$, то $\chi(\ideal{a}) = 0$;

%         \item если $(\ideal{a}, \ideal{n}) = 1$, то $\chi(\ideal{a}) \neq 0$;

%         \item если $\ideal{a} \equiv \ideal{b} \pmod{\ideal{n}}$, то $\chi(\ideal{a}) = \chi(\ideal{b})$.
%     \end{itemize}
% \end{definition}

% \begin{definition}
%     Главным характером Дирихле называется
%     \begin{equation*}
%         \chi_0(\ideal{a}) = \left\{\begin{split}
%             0 & \textrm{ если }\; (\ideal{a}, \ideal{n}) > 1\\
%             1 & \textrm{ если }\; (\ideal{a}, \ideal{n}) = 1.
%         \end{split}\right.
%     \end{equation*}
% \end{definition}

% \begin{remark}
%     Пусть $\rho$ -- характер группы $\invertible{R/\ideal{n}}\setminus\{0\}$.
%     Его можно доопределить до характера Дирихле по модулю $\ideal{n}$ следующим образом
%     \begin{equation*}
%         \chi(\ideal{a}) = \left\{\begin{split}
%             0 & \textrm{ если }\; \ideal{a} \not\in \invertible{R/\ideal{n}}\setminus\{0\}\\
%             \rho(\ideal{a}) & \textrm{ если }\; \ideal{a} \in \invertible{R/\ideal{n}}\setminus\{0\}
%         \end{split}\right.
%     \end{equation*}
% \end{remark}

\begin{definition}
    Пусть $\ideal{n}$ идеал дедекиндового кольца $R$.
    Будем говорить, что кольцо $R$ удовлетворяет условию A, если существует многочлен $f$, что для любого нетривиального характера $\chi: \invertible{R/\ideal{n}} \to \zeroless{\mathbb{C}}$ существует идеал $\ideal{a}$ взаимнопростой с $\ideal{n}$ и такой, что $\chi(\ideal{a}) \neq 1$ и
    \begin{equation*}
        \Nm{\ideal{a}} \le f(\log{\Nm{\ideal{n}}}).
    \end{equation*}
\end{definition}

\begin{remark}
    Обобщенная гипотеза Римана гласит, что для любого характера Дирихле $\chi$ и любого $s \in \mathbb{C}$ такого, что $L(\chi, s) = 0$ выполняется: если $s \not\in \mathbb{R}_{-}$, то $s = \frac{1}{2}$.

    Из работы Анкени~\cite{source:Ankeny} следует, что, если обобщенная гипотеза Римана выполнена, то условие A выполнено для кольца целых чисел и $f_{\mathbb{Z}}(x) = 2x^2$.
\end{remark}

\begin{remark}
    Пусть $K$ числовое поле с кольцом целых алгебраических чисел $\mathcal{O}_K$.
    Расширенная гипотеза Римана гласит, что для любого $s \in \mathbb{C}$ такого, что $\zeta_K(s) = 0$ выполняется: если $\Re{s} \in [0, 1]$, то $\Re{s} = \frac{1}{2}$.

    Из работы Баха~\cite{source:Bach} следует, что, если расширенная гипотеза Римана выполнена, то условие A выполнено для всех колец целых алгебраических чисел и $f_{\mathcal{O}_K}(x) = 12x^2 + 12\log^2 \Delta$.
\end{remark}

\begin{proposition}\label{proposition:condition_A_with_any_homomorphism}
    Пусть кольцо $R$ удовлетворяет условию A.
    Пусть $\chi: \invertible{R/\ideal{n}} \to G$ нетривиальный гомоморфизм.
    Тогда существует идеал $\ideal{a}$ взаимнопростой с $\ideal{n}$ и такой, что $\chi(\ideal{a}) \neq 1$ и
    \begin{equation*}
        \Nm{\ideal{a}} \le f(\log{\Nm{\ideal{n}}}).
    \end{equation*}
\end{proposition}
\begin{proof}
    Из условия предложения следует, что подгруппа $\chi(\invertible{R/\ideal{n}}) \subseteq G$ нетривиальная.
    Рассмотрим нетривиальный характер $\xi: \chi(\invertible{R/\ideal{n}}) \to \invertible{\mathbb{C}}$.
    Очевидно, что $\xi \circ \chi: \invertible{R/\ideal{n}} \to \invertible{\mathbb{C}}$ является нетривиальным характером группы $\invertible{R/\ideal{n}}$.
    
    Из определения условия A следует, что существует простой идеал $\ideal{a}$ взаимнопростой с $\ideal{n}$ и такой, что $(\xi \circ \chi)(\ideal{a}) \neq 1$ и
    \begin{equation*}
        \Nm{\ideal{a}} \le f(\log{\Nm{\ideal{n}}}).
    \end{equation*}
    
    Из того, что $(\xi \circ \chi)(\ideal{a}) \neq 1$ следует, что $\chi(\ideal{a}) \neq 1$.
\end{proof}

\begin{theorem}\label{theorem:euler_criteria_deterministic}
    Пусть $\ideal{n}$ -- нетривиальный идеал нечетной нормы дедекиндового кольца $R$, удовлетворяющего условию A.
    Тогда $\ideal{n}$ -- простой идеал тогда и только тогда, когда для любого идеала $\ideal{a} \in \invertible{R/\ideal{n}}$, $\Nm{\ideal{a}} \le f_R(\Nm{\ideal{n}})$ выполнено
    \begin{equation*}
        a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \left[\frac{\ideal{a}}{\ideal{n}}\right] \pmod{\ideal{n}}.
    \end{equation*}
\end{theorem}
\begin{proof}
    Необходимость следует из теоремы~\ref{theorem:euler_criteria}.
    
    Предположим, что $\ideal{n} \in \zeroless{R} \setminus \invertible{R}$ составной идеал нечетной нормы и для любого и идеала $\ideal{a} \in \invertible{R/\ideal{n}}$, $\Nm{\ideal{a}} \le f_R(\Nm{\ideal{n}})$ выполнено
    \begin{equation*}
        a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \left[\frac{\ideal{a}}{\ideal{n}}\right] \pmod{\ideal{n}}.
    \end{equation*}
    
    Рассмотрим такое отображение $\chi: \invertible{R/\ideal{n}} \to \invertible{R/\ideal{n}}$, что для всех $\ideal{a} \in \invertible{R/\ideal{n}}$ выполнено $\chi(a) = a^{(\Nm{\ideal{n}} - 1)/2}\left[\frac{a}{\ideal{n}}\right]$.
    Из теоремы~\ref{theorem:euler_criteria} следует, что $\chi$ нетривиальный гомоморфизм.
    
    Тогда, используя предложение~\ref{proposition:condition_A_with_any_homomorphism}, получаем, что существует такой идеал $\ideal{a} \in \invertible{R/\ideal{n}}$, что
    \begin{equation*}
        a^{\frac{\Nm{\ideal{n}} - 1}{2}} \left[\frac{\ideal{a}}{\ideal{n}}\right] \not\equiv 1 \pmod{\ideal{n}}.
    \end{equation*}
    Получили противоречие.
\end{proof}

\begin{proposition}
    Пусть идеал $\ideal{p}$ простой с нечетной нормой.
    Тогда сравнение
    \begin{equation*}
        x^{\Nm{\ideal{p}} - 1} \equiv 1 \pmod{\ideal{p}^2}
    \end{equation*}
    имеет не более $\Nm{\ideal{p}} - 1$ решений относительно $x \in \invertible{R/\ideal{p}^2}$.
\end{proposition}
\begin{proof}
    Из утверждения~\ref{statement:euler_function} следует, что сравнение $x^{\Nm{\ideal{p}} - 1} \equiv 1 \pmod{\ideal{p}}$ имеет ровно $\Nm{\ideal{p}} - 1$ решений относительно $x \in \invertible{R/\ideal{p}}$.
    
    Заметим, что все решения сравнения $x^{\Nm{\ideal{p}} - 1} \equiv 1 \pmod{\ideal{p}^2}$ имеют вид $a + pt$, где $a \in \invertible{R/\ideal{p}}$, $t \in R/\ideal{p}$ и $a$ является решением сравнения $x^{\Nm{\ideal{p}} - 1} \equiv 1 \pmod{\ideal{p}}$.
    Подставим этот вид в сравнение, применим формулу Тейлора и получим
    \begin{equation*}
        \frac{a^{\Nm{\ideal{p}} - 1} - 1}{\ideal{p}}
    \end{equation*}
\end{proof}

\begin{theorem}\label{theorem:miller_criteria_deterministic}
    Пусть $\ideal{n}$ -- нетривиальный идеал нечетной нормы дедекиндового кольца $R$, удовлетворяющего условию A.
    Пусть $\Nm{\ideal{n}} - 1 = 2^t u$, $(u, 2) = 1$.
    Тогда $\ideal{n}$ -- простой идеал тогда и только тогда, когда для любого идеала $\ideal{a} \in \invertible{R/\ideal{n}}$, $\Nm{\ideal{a}} \le f_R(\Nm{\ideal{n}})$, $(\ideal{a}, \ideal{n}) = 1$, $\ideal{a}^u \not\equiv 1 \pmod{\ideal{n}}$ существует $k\in \{0, \dots, t-1\}$, такое что $\ideal{a}^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.
\end{theorem}
\begin{proof}
    Необходимость следует из теоремы~\ref{theorem:euler_criteria}.

    Предположим, что $\ideal{n} \in \zeroless{R} \setminus \invertible{R}$ составной идеал нечетной нормы и для любого идеала $\ideal{a} \in \invertible{R/\ideal{n}}$, $\Nm{\ideal{a}} \le f_R(\Nm{\ideal{n}})$, $(\ideal{a}, \ideal{n}) = 1$, $\ideal{a}^u \not\equiv 1 \pmod{\ideal{n}}$ существует $k\in \{0, \dots, t-1\}$, такое что $\ideal{a}^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.

    Предположим, что существует такой простой идеал $\ideal{p}$, что $\ideal{p}^2 | \ideal{n}$.
    Рассмотрим такое отображение $\chi: \invertible{R/\ideal{p}^2} \to \invertible{R/\ideal{p}^2}$, что для всех $\ideal{a} \in \invertible{R/\ideal{n}}$ выполнено $\chi(a) = a^{\Nm{\ideal{p}} - 1}$.
    
    
    Рассмотрим отображение $\chi(\ideal{a}) = \ideal{a}^{\Nm{\ideal{p}} - 1}$.
    Заметим, что это отображение является гомоморфизмом
\end{proof}


% \subsection{Алгоритмы факторизации в абстрактных числовых кольцах}

% % - Алгоритмы факторизации в абстрактных числовых кольцах
% %    Теорема Дедекинда
% %    Часть о том, что для числовых колец она работает и поэтому можно свести факторизацию к факторизации в целых числах
% %    Для абстрактных колец теорем Дедекинда не доказана. Поэтому там все сложнее.
% %    Привести результаты Kofi_Intrinsic factorization of ideals in dedekind domains, где используется вычисление радикала (или не надо)

% Как было сказано ранее, в работе \cite{Petukhova} было показано, что RSA-криптосистема в произвольном квадратичном кольце алгебраических целых чисел не имеет преимуществ перед RSA-криптосистемой в целых числах.
% В этой части будет показано, что аналогичное утверждение верно для произвольного кольца целых алгебраических чисел числового поля.

% Рассмотрим некоторое числовое поле $K = \mathbb{Q}(\theta)$.
% Будем предполагать, что поле $K$ фиксировано и, следовательно, известен индекс $[\mathcal{O}_K:\mathbb{Z}[\theta]]$.
% А так же разложение на простые идеалы всех простых делителей индекса.

% Рассмотрим представления идеалов.
% Существует два способа представить идеал

% \begin{enumerate}
%     \item Через целый базис.
%     \begin{equation}\label{eq:Z_basis}
%         \mathfrak{p} = \oplus_{i=1}^{n} \mathbb{Z}\alpha_i,
%     \end{equation}
%     где $\alpha_i\in\mathcal{O}_K$.

%     \item Через два элемента $\mathcal{O}_K$.
%     Для любого $\alpha\in\mathfrak{p}$ существует $\beta\in\mathfrak{p}$ такой, что
%     \begin{equation}\label{eq:2_element}
%         \mathfrak{p} = \alpha\mathcal{O}_K + \beta\mathcal{O}_K.
%     \end{equation}

%     Будем обозначать идеалы в таком представлении через $(\alpha, \beta)$.
%     Идеал, который генерируется одним элементом $\alpha\in\mathcal{O}_K$ будем обозначать $(\alpha) = \alpha\mathcal{O}_K$. 
% \end{enumerate}

% \begin{statement}[Теорема Дедекинда]\label{thm:dedekind}
%     Пусть $f(T)$ минимальный многочлен алгебраического числа $\theta$ в $\mathbb{Z}[\theta]$.
%     Для простого рационального числа $p$, не делящего индекс $[\mathcal{O}_K:\mathbb{Z}[\theta]]$, запишем
%     \begin{equation}
%         f(T) \equiv \pi_1(T)^{e_1}\dots \pi_g(T)^{e_g} \modul p,\nonumber
%     \end{equation}
%     где $\pi_i(T)$ --- различные монические неприводимые многочлены в $\mathbb{F}_p[T]$.
%     Тогда
%     \begin{equation}
%         (p) = \mathfrak{p}_1^{e_1}\dots \mathfrak{p}_g^{e_g},\nonumber
%     \end{equation}
%     где $\mathfrak{p}_i = (p_i, T_i(\theta))$, $T_i(T) \equiv \pi_i(T)(\modul p)$.
% \end{statement}

% Используя теорему Дедекинда, можно показать, что задача факторизации в кольце целых чисел числового поля полиномиально эквивалентна задаче факторизации целых чисел.

% Сделать это можно с помощью следующего алгоритма.

% \begin{enumerate}
%     \item Пусть дан идеал $(N)$ в форме своего $2$-представления.

%     \item Считаем норму идеала, равную норме элемента $N$ и раскладываем норму на множители одним из известных алгоритмов для факторизации целых чисел.
%     Например методом решета числового поля или алгоритмом Шора.
%     Получаем разложение
%     $$
%         n = \Nm{N} = \prod_{i=1}^{k} p_i^{\alpha_i}.
%     $$
%     Таким образом, мы знаем, что
%     $$
%         (\Nm{N}) = \prod_{i=1}^{k} (p_i)^{\alpha_i}.
%     $$

%     \item Факторизуем идеал $(p_i)$ с помощью теоремы Дедекинда \ref{thm:dedekind} и получаем двухэлементные представления идеалов
%     $$
%         (p_i) = \prod_{j=1}^{l_i} (p_i, f_{i, j}(\theta))
%     $$

%     \item Преобразуем полученные простые идеалы в $\mathbb{Z}$-представление и объединяем равные.
%     Получаем представление
%     $$
%         (\Nm{N}) = \prod_{i=1}^{l} \mathfrak{p}_i^{\beta_i}
%     $$

%     \item Используем бинарный поиск для нахождения степеней, в которых $\mathfrak{p}_i$ входит в $(N)$.
% \end{enumerate}

% Покажем, что алгоритм полиномиальный

% \begin{statement}
%     Для вычисления нормы идеала $(N)$ необходимо $O(n^3 \log^2 |N|)$ бинарных операций, где $|N|$ обозначает максимальный по модулю элемент матричного представления $N$.
% \end{statement}
% \begin{proof}
%     Для вычисления нормы идеала $(N)$ необходимо найти определитель матрицы, которая получается при матричном представлении элемента $N$.
%     Для этого необходимо $O(n^3 \log^2 |N|)$ бинарных операций.
% \end{proof}

% \begin{statement}
%     Разложить идеал $(p)$, используя теорему Дедекинда, можно за $O((n\log n + \log p)n\log n\log\log n\log^2 p)$ бинарных операций.
% \end{statement}
% \begin{proof}
%     Оценим сложность разложения многочлена на множители в $\mathbb{F}_p$.
%     Сделать это можно с помощью вероятностной версии алгоритма Берлекэмпа за $O((n\log n + \log p)n\log n\log\log n\log^2 p)$ бинарных операций.
%     В результате получим не более $n$ многочленов.
%     Тогда вычислить значения многочленом в разложении можно за $O(n\log^2 p)$.

%     Итого получаем, что разложить идеал $(p)$, используя теорему Дедекинда, можно за $O((n\log n + \log p)n\log n\log\log n\log^2 p + n\log^2 p) = O((n\log n + \log p)n\log n\log\log n\log^2 p)$ бинарных операций.
% \end{proof}

% \begin{statement}
%     Преобразовать $2$-представление идеала $(p, \alpha)$ из теоремы Дедекинда в $\mathbb{Z}$-представление можно $O(P(n)Q(\log p))$ бинарных операций, где $P(T)$ и $Q(T)$ некоторые полиномы.
% \end{statement}
% \begin{proof}
%     В книге \cite{Pohst} описан алгоритм преобразования $2$-представления в $\mathbb{Z}$-представление.
%     Необходимо найти Эрмитову нормальную форму блочной матрицы
%     $$
%         \begin{pmatrix}
%             A\\
%             B
%         \end{pmatrix},
%     $$
%     где $A = diag(p, \dots, p)$, а $B$ является матричным представлением элемента $\alpha$.
%     В 1979 году было доказано, что эрмитову нормальную форму матрицу можно найти за строго полиномиальное время \cite{Kannan}.
%     Это означает, что алгоритму необходимо полиномиальное, относительно размеров матрицы, количество арифметических операций над числами не превосходящими полинома от бинарного представления элементов матрицы.
%     Таким образом эрмитову нормальную форму можно вычислить за $O(P(n)Q(\log p))$ бинарных операций, где $P(T)$ и $Q(T)$ некоторые полиномы.
% \end{proof}

% \begin{remark}
%     Таким образом, зная разложение $(p_i)$ на произведение простых идеалов, можно найти одинаковые идеалы и разложение $(\Nm{N})$ на произведение различных идеалов за $O(P(n)Q(\log |N|))$ бинарных операций, так как $k \le \log \Nm{N}$ и $l_i \le n$.
%     Таким образом, найти разложение идеала $(\Nm{N})$ на произведение различных простых идеалов можно за полиномиальное относительно $\log\Nm{N}$ количество бинарных операций, если разложение $\Nm{N}$ на множители известно.

%     Это показывает, что аналог RSA-криптосистемы в некотором смысле не дает никакого выигрыша при использовании в кольцах алгебраических целых чисел числовых полей.
% \end{remark}

% \begin{remark}
%     Задача факторизации в абстрактных числовых полях является более сложной, так как нет доказательства аналога теоремы Дедекинда в абстрактных числовых кольцах.
% \end{remark}

% В работе \cite{Darkey-Mensah} приводится алгоритм факторизации идеалов в дедекиндовых кольцах.
% Во время факторизации идеал проходит три алгоритма: разложение на радикалы, разложение на множители с одинаковыми степенями и разложение на множители с разными степенями.
% Рассмотрим эти алгоритмы подробнее.

% Пусть $R$ -- дедекиндово кольцо и $\mathfrak{a}$ -- идеал в $R$.
% Так как $R$ дедекиндово, то $\mathfrak{a}$ единственным образом раскладывается в произведение простых идеалов.
% Пусть это разложение имеет вид
% \begin{equation*}
%     \mathfrak{a} = \mathfrak{p}_1^{k_1} \dots \mathfrak{p}_s^{k_s},
% \end{equation*}
% где $p_1, \dots, p_s$ различные простые идеалы и $k_1, \dots, k_s > 0$.
% Соберем вместе простые множители с одинаковой степенью.
% Для $j \le m = \max\{k_1, \dots, k_s\}$ обозначим
% \begin{equation*}
%     \mathfrak{g}_j = \bigcap\limits_{k_i = j} \mathfrak{p}_i
% \end{equation*}

% Представление
% \begin{equation*}
%     \mathfrak{a} = \mathfrak{g}_1 \mathfrak{g}_1^2 \dots \mathfrak{g}_m^m
% \end{equation*}
% называется разложением на радикалы.

% После выполнения этого разложения задача факторизации сводится к задаче факторизации идеала вида $\mathfrak{a} = \mathfrak{p}_1\dots\mathfrak{p}_s$, где $\mathfrak{p}_1, \dots, \mathfrak{p}_s$ являются простыми идеалами.
% Обозначим
% \begin{equation*}
%     \mathfrak{h}_j = \prod\limits_{\mathfrak{p} | \mathfrak{a}, \textrm{deg} \mathfrak{p} = j} \mathfrak{p}
% \end{equation*}

% Представление
% \begin{equation*}
%     \mathfrak{a} = \mathfrak{h}_1 \dots \mathfrak{h}_m
% \end{equation*}
% называется разложением на множители с разными степенями.

% После двух шагов получается, что задача факторизации идеала сводится к задаче факторизации радикала, который является произведением различных простых идеалов с одинаковой степенью, которая нам неизвестна.
% Далее можно воспользоваться алгоритмом, похожим на алгоритм Кантотра-Зассенхауса.

% Несмотря на то, что алгоритм факторизации имеется, у него есть определенные ограничения.
% Они описаны в работе \cite{Darkey-Mensah} и состоят в том, что надо уметь вычислять радикал идеала, сумму идеалов и частное.

\onlyinsubfile{
    \subfile{_10_bibliography}
    \subfile{_11_pub}
}

\end{document}
