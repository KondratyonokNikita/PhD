\documentclass[_00_dissertation.tex]{subfiles}
\begin{document}

\onlyinsubfile{
    \renewcommand{\contentsname}{ОГЛАВЛЕНИЕ}
    \setcounter{tocdepth}{3}
    \tableofcontents
}

\newpage
\begin{center}
    \refstepcounter{section}
    \section*{ГЛАВА \arabic{section}.\\ ТЕСТИРОВАНИЕ ИДЕАЛОВ НА ПРОСТОТУ В ДЕДЕКИНДОВЫХ КОЛЬЦАХ}\label{section:Primality}
    \addcontentsline{toc}{chapter}{ГЛАВА \arabic{section}. ТЕСТИРОВАНИЕ ИДЕАЛОВ НА ПРОСТОТУ В ДЕДЕКИНДОВЫХ КОЛЬЦАХ}
\end{center}

\begin{proposition}\label{proposition:condition_A_with_any_homomorphism}
    Пусть кольцо $R$ удовлетворяет условию A.
    Пусть $\chi: \invertible{R/\ideal{n}} \to G$ нетривиальный гомоморфизм.
    Тогда существует идеал $a$ взаимнопростой с $\ideal{n}$ и такой, что $\chi(a) \neq 1$ и
    \begin{equation*}
        \Nm{a} \le f(\log{\Nm{\ideal{n}}}).
    \end{equation*}
\end{proposition}
\begin{proof}
    Из условия предложения следует, что подгруппа $\chi(\invertible{R/\ideal{n}}) \subseteq G$ нетривиальная.
    Рассмотрим нетривиальный характер $\xi: \chi(\invertible{R/\ideal{n}}) \to \invertible{\mathbb{C}}$.
    Очевидно, что $\xi \circ \chi: \invertible{R/\ideal{n}} \to \invertible{\mathbb{C}}$ является нетривиальным характером группы $\invertible{R/\ideal{n}}$.
    
    Из определения условия A следует, что существует простой $a$ взаимнопростой с $\ideal{n}$ и такой, что $(\xi \circ \chi)(a) \neq 1$ и
    \begin{equation*}
        \Nm{a} \le f(\log{\Nm{\ideal{n}}}).
    \end{equation*}
    
    Из того, что $(\xi \circ \chi)(a) \neq 1$ следует, что $\chi(a) \neq 1$.
\end{proof}

\begin{proposition}\label{proposition:miller_criteria_character}
    Пусть идеал $\ideal{p}$ простой с нечетной нормой.
    Тогда сравнение
    \begin{equation*}
        \ideal{x}^{\Nm{\ideal{p}} - 1} \equiv 1 \pmod{\ideal{p}^2}
    \end{equation*}
    имеет не более $\Nm{\ideal{p}} - 1$ решений относительно $\ideal{x} \in \invertible{R/\ideal{p}^2}$.
\end{proposition}
\begin{proof}
    Из утверждения~\ref{statement:euler_function} следует, что сравнение $\ideal{x}^{\Nm{\ideal{p}} - 1} \equiv 1 \pmod{\ideal{p}}$ имеет ровно $\Nm{\ideal{p}} - 1$ решений относительно $\ideal{x} \in \invertible{R/\ideal{p}}$.
    
    Заметим, что все решения сравнения $\ideal{x}^{\Nm{\ideal{p}} - 1} \equiv 1 \pmod{\ideal{p}^2}$ имеют вид $a + \ideal{p}\ideal{t}$, где $a \in \invertible{R/\ideal{p}}$, $\ideal{t} \in R/\ideal{p}$ и $a$ является решением сравнения $\ideal{x}^{\Nm{\ideal{p}} - 1} \equiv 1 \pmod{\ideal{p}}$.
    Подставим этот вид в сравнение, раскроем скобки и получим сравнение
    \begin{equation*}
        \ideal{p}\ideal{t}(\Nm{\ideal{p}} - 1)a^{\Nm{\ideal{p}} - 2} \equiv 1 - a^{\Nm{\ideal{p}} - 1} \pmod{\ideal{p}^2}.
    \end{equation*}
    
    Так как $((\Nm{\ideal{p}} - 1)a^{\Nm{\ideal{p}} - 2}, \ideal{p}) = 1$, то это сравнение имеет ровно одно решение при фиксированном $a$.
    Следовательно, исходное сравнение имеет не более $\Nm{\ideal{p}} - 1$ решений относительно $\ideal{x} \in \invertible{R/\ideal{p}^2}$.
\end{proof}

\subsection{Критерий Эйлера}

\begin{theorem}\label{theorem:euler_criteria}
    Пусть $\ideal{n}$ -- нетривиальный идеал нечетной нормы дедекиндового кольца $R$.
    Тогда $\ideal{n}$ -- простой идеал тогда и только тогда, когда для любого $a \in \invertible{R/\ideal{n}}$ выполнено
    \begin{equation*}
        a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \jacobi{a}{\ideal{n}} \pmod{\ideal{n}}.
    \end{equation*}

    Если кольцо $R$ удовлетворяет условию A, то $\ideal{n}$ -- простой идеал тогда и только тогда, когда для любого $a \in \invertible{R/\ideal{n}}$, $\Nm{a} \le f_R(\Nm{\ideal{n}})$ выполнено
    \begin{equation*}
        a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \jacobi{a}{\ideal{n}} \pmod{\ideal{n}}.
    \end{equation*}
\end{theorem}
\begin{proof}
    Докажем первую часть теоремы.
    Предположим, что $\ideal{n}$ -- простой идеал.
    Рассмотрим произвольный $a \in \invertible{R/\ideal{n}}$.
    Пусть $g$ -- первообразный корень по модулю $\ideal{n}$.

    Так как $\Nm{\ideal{n}}$ нечетный, то $a$ является квадратичным вычетом тогда и только тогда, когда существует такое $t' = 2t \in \{0, 2, \dots, \Nm{\ideal{n}} - 1\}$, что $a \equiv g^{t'} \pmod{\ideal{n}}$.
    Так как порядок $g$ равен $\Nm{\ideal{n}} - 1$, то последнее сравнение выполняется тогда и только тогда, когда $a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv 1 \pmod{\ideal{n}}$.
    Это завершает доказательство необходимости.

    Предположим, что $\ideal{n}$ -- не простой идеал.
    Пусть $\ideal{n}$ раскладывается в произведение простых идеалов следующим образом $\ideal{n} = \prod_{i=1}^{r} \ideal{p}_i^{\alpha_i}$.
    Так как норма простого идеала примарная, то обозначим $\Nm{\ideal{p}_i} = q_i^{f_i}$, где $q_i$ -- простой в $\mathbb{Z}$.
    Пусть для любого $a \in \invertible{R/\ideal{n}}$ выполнено $a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \left[\frac{a}{\ideal{n}}\right] \pmod{\ideal{n}}$.

    Пусть существует такой $j \in \{1, \dots, r\}$, что $\alpha_j > 1$ в разложении $\ideal{n}$ на множители.
    Из теоремы Коши для групп \ref{statement:cauchy} и свойств функции Эйлера \ref{statement:euler_function} следует, что существует $a \in \invertible{R/\ideal{n}}$ порядка $q_j$.
    Тогда $q_j | \Nm{\ideal{n}} - 1$, что невозможно.

    Следовательно, $\alpha_j = 1$ для любого $j \in \{1, \ldots, r\}$.
    Так как $\ideal{n}$ -- составное, то $r \ge 2$.
    Рассмотрим произвольный квадратичный невычет $b \in \invertible{R/\ideal{p}_1}$.
    Согласно аналогу Китайской теоремы об остатках \ref{statement:chinese_remainder_theorem} существует такой $a \in \invertible{R/\ideal{n}}$, что выполнено $a \equiv b \pmod{\ideal{p}_1}$ и $a \equiv 1 \pmod{\ideal{p}_2\dots\ideal{p}_r}$.
    Но в этом случае $\jacobi{a}{\ideal{n}} = -1$.
    Из условия теоремы следует, что $a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv -1 \pmod{\ideal{n}}$, что противоречит условию $a \equiv 1 \pmod{\ideal{p}_2}$.
    Это завершает доказательство достаточности.

    Теперь докажем вторую часть.
    Необходимость следует из доказанного ранее.
    Идеал $\ideal{n}$ не может быть простым, если существует $a \in \invertible{R/\ideal{n}}$, для которого
    \begin{equation*}
        a^{\frac{\Nm{\ideal{n}} - 1}{2}} \not\equiv \jacobi{a}{\ideal{n}} \pmod{\ideal{n}}.
    \end{equation*}

    Предположим, что $\ideal{n} \in \zeroless{R} \setminus \invertible{R}$ составной идеал нечетной нормы и для любого и идеала $a \in \invertible{R/\ideal{n}}$, $\Nm{a} \le f_R(\Nm{\ideal{n}})$ выполнено
    \begin{equation*}
        a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \jacobi{a}{\ideal{n}} \pmod{\ideal{n}}.
    \end{equation*}
    
    Рассмотрим такое отображение $\chi: \invertible{R/\ideal{n}} \to \invertible{R/\ideal{n}}$, что для всех $a \in \invertible{R/\ideal{n}}$ выполнено $\chi(a) = a^{(\Nm{\ideal{n}} - 1)/2}\jacobi{a}{\ideal{n}}$.
    Из теоремы~\ref{theorem:euler_criteria} следует, что $\chi$ нетривиальный гомоморфизм.
    
    Тогда, используя предложение~\ref{proposition:condition_A_with_any_homomorphism}, получаем, что существует такой идеал $a \in \invertible{R/\ideal{n}}$, что
    \begin{equation*}
        a^{\frac{\Nm{\ideal{n}} - 1}{2}} \jacobi{a}{\ideal{n}} \not\equiv 1 \pmod{\ideal{n}}.
    \end{equation*}
    Получили противоречие.
\end{proof}

\begin{algorithm}\label{algorithm:solovay_strassen}
    Дан нетривиальный идеал $\ideal{n} \subset R$.
    Необходимо определить является ли он простым.

    \begin{enumerate}
        \item Вычислить $\Nm{\ideal{n}}$;
        
        \item Выбрать случайное $a \in \invertible{R/\ideal{n}}$;

        \item Вычислить $r_0 = a^{\frac{\Nm{\ideal{n}} - 1}{2}} \pmod{\ideal{n}}$, $r_1 = \jacobi{a}{\ideal{n}}$;

        \item Если $r_0 \equiv r_1 \pmod{\ideal{n}}$, то вернуть ''неизвестно'' и завершить алгоритм;

        \item Вернуть ''$\ideal{n}$ не простой'' и завершить алгоритм.
    \end{enumerate}
\end{algorithm}

\begin{remark}
    Алгоритм \ref{algorithm:solovay_strassen} является вероятностным.
    Если был получен ответ "неизвестно", то можно выполнить алгоритм еще раз.
\end{remark}

\begin{proposition}
    Пусть $\ideal{n}$ -- не простой идеал.
    Тогда вероятность ответа "$\ideal{n}$ не простой" у алгоритма \ref{algorithm:solovay_strassen} не менее $1/2$.
\end{proposition}
\begin{proof}
    Рассмотрим множество
    \begin{equation*}
        G = \left\{
            a \in \invertible{R/\ideal{n}} \big| a^{\frac{\Nm{\ideal{n}} - 1}{2}} \equiv \jacobi{a}{\ideal{n}} \pmod{\ideal{n}}
        \right\}.
    \end{equation*}
    Алгоритм~\ref{algorithm:solovay_strassen} возвращает ответ ''неизвестно'' только для элементов из множества $G$.

    Заметим, что если алгоритм~\ref{algorithm:solovay_strassen} возвращает ответ ''неизвестно'' для $a$ и $b$, то он вернет ответ ''неизвестно'' и для $ab$.
    Следовательно, $G$ образует подгруппу группы $\invertible{R/\ideal{n}}$.

    Из теоремы~\ref{theorem:euler_criteria} следует, что $G$ собственная подгруппа.
    Тогда из теоремы Лагранжа~\ref{statement:lagrange} следует, что $|G|/|\invertible{R/\ideal{n}}| \le \frac{1}{2}$.
\end{proof}

\begin{remark}
    Если $\ideal{n}$ -- составной, то при выполнении алгоритма \ref{algorithm:miller_rabin} $k$ раз вероятность получить ответ ''$\ideal{n}$ не простой'' не меньше $1 - \frac{1}{2^k}$.
\end{remark}

\subsection{Критерий Миллера}

\begin{theorem}\label{theorem:miller_criteria}
    Пусть $\ideal{n}$ -- нетривиальный идеал нечетной нормы дедекиндового кольца $R$.
    Пусть $\Nm{\ideal{n}} - 1 = 2^t u$, $(u, 2) = 1$.
    Тогда $\ideal{n}$ -- простой идеал тогда и только тогда, когда для любого $a \in \invertible{R/\ideal{n}}$, $a^u \not\equiv 1 \pmod{\ideal{n}}$ существует $k\in \{0, \dots, t-1\}$, такое что $a^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.

    Пусть колько $R$ удовлетворяет условию A.
    Тогда $\ideal{n}$ -- простой идеал тогда и только тогда, когда для любого $a \in \invertible{R/\ideal{n}}$, $\Nm{a} \le f_R(\Nm{\ideal{n}})$, $(a, \ideal{n}) = 1$, $a^u \not\equiv 1 \pmod{\ideal{n}}$ существует $k\in \{0, \dots, t-1\}$, такое что $a^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.
\end{theorem}
\begin{proof}
    Докажем первую часть теоремы.
    Предположим, что $\ideal{n}$ -- простой идеал.
    Рассмотрим произвольный $a \in \invertible{R/\ideal{n}}$, $a^u \not\equiv 1 \pmod{\ideal{n}}$.
    Из теоремы Эйлера \ref{statement:euler_function} следует, что:
    \begin{equation*}
        a^{2^{t} u} = a^{\varphi(\ideal{n})} \equiv 1 \pmod{\ideal{n}}
    \end{equation*}

    Раскладываем на множители и получаем, что выполнено
    \begin{equation*}
        (a^{u} - 1)(a^{u} + 1)(a^{2u} + 1)\dots(a^{2^{t-1}u} + 1) \equiv 0 \pmod{\ideal{n}}
    \end{equation*}

    Из того, что $a^{u} \not\equiv 1 \pmod{\ideal{n}}$ следует, что $a^{2^{k}u} + 1 \equiv 0 \pmod{\ideal{n}}$ для некоторого $k\in \{0, \dots, t-1\}$.
    Это завершает доказательство необходимости.

    Предположим, что $\ideal{n}$ -- не простой идеал.
    Пусть $\ideal{n}$ раскладывается в произведение простых идеалов следующим образом $\ideal{n} = \prod_{i=1}^{r} \ideal{p}_i^{\alpha_i}$.
    Так как норма простого идеала примарная, то обозначим $\Nm{\ideal{p}_i} = q_i^{f_i}$, где $q_i$ -- простой в $\mathbb{Z}$.

    Пусть существует такой $j \in \{1, \dots, r\}$, что $\alpha_j > 1$ в разложении $\ideal{n}$ на множители.
    Из теоремы Коши для групп \ref{statement:cauchy} и свойств функции Эйлера~\ref{statement:euler_function} следует, что существует $a \in \invertible{R/\ideal{n}}$ порядка $q_j$.
    Так как $u \not\equiv 0 \pmod{q_j}$, то $a^u \not\equiv 1 \pmod{\ideal{n}}$.
    Следовательно, существует число $k \in \{1, \dots, t-1\}$, такое что выполнено сравнение $a^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.
    Тогда $a^{2^{k+1}u} \equiv 1 \pmod{\ideal{n}}$.
    Значит выполнено $2^{k+1}u \equiv 0 \pmod{q_j}$.
    Из последнего сравнения следует, что $\Nm{\ideal{n}} - 1 \equiv 0 \pmod{q_j}$, что невозможно.
    
    Следовательно, $\alpha_j = 1$ для любого $j \in \{1, \ldots, r\}$.
    Так как $\ideal{n}$ -- составное, то $r \ge 2$.
    Из аналога Китайской теоремы об остатках~\ref{statement:chinese_remainder_theorem} и того, что элемент $-1$ имеет порядок $2$ в каждой группе $\invertible{R/\ideal{p}_j}$ следует, что существует по крайней мере $2^r-1 \ge 3$ элемента $\invertible{R/\ideal{n}}$ порядка $2$.
    Пусть $a \not\equiv \pm 1 \pmod{\ideal{n}}$ является произвольным элементом порядка $2$ в группе $\invertible{R/\ideal{n}}$.
    Из того, что $(u, 2) = 1$ следует, что $a^u \equiv a \not\equiv \pm 1 \pmod{\ideal{n}}$.
    Таким образом, существует $k \in \{0,\ldots, t-1\}$, такое что верно $a^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.
    Это противоречит тому, что порядок $a$ равен $2$.
    Это завершает доказательство достаточности.

    Теперь докажем вторую часть теоремы.
    Необходимость следует из доказанного ранее.

    Предположим, что $\ideal{n} \in \zeroless{R} \setminus \invertible{R}$ составной идеал нечетной нормы и для любого идеала $a \in \invertible{R/\ideal{n}}$, $\Nm{a} \le f_R(\Nm{\ideal{n}})$, $(a, \ideal{n}) = 1$, $a^u \not\equiv 1 \pmod{\ideal{n}}$ существует $k\in \{0, \dots, t-1\}$, такое что $a^{2^{k}u} \equiv -1 \pmod{\ideal{n}}$.

    Предположим, что существует такой простой идеал $\ideal{p}$, что $\ideal{p}^2 | \ideal{n}$.
    Рассмотрим такое отображение $\chi: \invertible{R/\ideal{p}^2} \to \invertible{R/\ideal{p}^2}$, что для всех $a \in \invertible{R/\ideal{p}^2}$ выполнено $\chi(a) = a^{\Nm{\ideal{p}} - 1}$.
    Из предложения~\ref{proposition:miller_criteria_character} следует, что это нетривиальный гомоморфизм.
    Тогда, из предложения~\ref{proposition:condition_A_with_any_homomorphism}, получаем, что существует такой идеал $a \in \invertible{R/\ideal{p}^2}$, что
    \begin{equation*}
        a^{\Nm{\ideal{p}} - 1} \not\equiv 1 \pmod{\ideal{p}^2}.
    \end{equation*}

    Предположим, что $a^{\Nm{\ideal{n}} - 1} \equiv 1 \pmod{\ideal{n}}$.
    Тогда $a^{\Nm{\ideal{n}} - 1} \equiv 1 \pmod{\ideal{p}^2}$.
    Тогда $\textrm{ord}_{R/\ideal{p}^2}(a) | \Nm{\ideal{n}} - 1$ и $\textrm{ord}_{R/\ideal{p}^2}(a) | \varphi(\ideal{p}^2)$.
    Из этого следует, что $\textrm{ord}_{R/\ideal{p}^2}(a) | \Nm{\ideal{p}} - 1$.
    Это противоречит выражению $a^{\Nm{\ideal{p}} - 1} \not\equiv 1 \pmod{\ideal{p}^2}$.

    Следовательно, не существует такой простой идеал $\ideal{p}$, что $\ideal{p}^2 | \ideal{n}$.
    Пусть $\ideal{p}$ и $\ideal{q}$ различные простые делители $\ideal{n}$.
    
    Обозначим $v_2(n)$ максимальную степень двойки, делящую $n \in \mathbb{Z}$.
    Не нарушая общности, предположим, что $v_2(\Nm{\ideal{p}} - 1) \ge v_2(\Nm{\ideal{q}} - 1)$.
    Пусть
    \begin{equation*}
        \ideal{d} = \begin{cases}
            \ideal{p}\ideal{q} &\textrm{ если } v_2(\Nm{\ideal{p}} - 1) = v_2(\Nm{\ideal{q}} - 1)\\
            \ideal{p} &\textrm{ если } v_2(\Nm{\ideal{p}} - 1) > v_2(\Nm{\ideal{q}} - 1).
        \end{cases}
    \end{equation*}
    Рассмотрим такое отображение $\xi: \invertible{R/\ideal{n}} \to \invertible{R/\ideal{n}}$, что для всех $a \in \invertible{R/\ideal{n}}$ выполнено $\xi(a) = \jacobi{a}{\ideal{d}}$.
    Это отображение является нетривиальным гомоморфизмом.
    Тогда, из предложения~\ref{proposition:condition_A_with_any_homomorphism}, получаем, что существует такой идеал $a \in \invertible{R/\ideal{n}}$, что
    \begin{equation*}
        \jacobi{a}{\ideal{d}} \not\equiv 1 \pmod{\ideal{n}}.
    \end{equation*}
    
    Положим $\ideal{b} = a^u$.
    Тогда $\jacobi{b}{\ideal{d}} = -1$.
    Следовательно, $\ideal{b} \not\equiv 1 \pmod{\ideal{d}}$.
    Пусть $j \in \mathbb{Z}$ минимальное число, для которого $a^{2^j u} \equiv -1 \pmod{\ideal{n}}$.
    Тогда $\textrm{ord}_{R/\ideal{p}}(\ideal{b}) = \textrm{ord}_{R/\ideal{q}}(\ideal{b}) = 2^{j+1}$.
    
    Рассмотрим два случая.
    Пусть $v_2(\Nm{\ideal{p}} - 1) > v_2(\Nm{\ideal{q}} - 1)$.
    Тогда $\textrm{ord}_{R/\ideal{q}}(\ideal{b}) = 2^{j+1} | \varphi(\ideal{q}) = \Nm{\ideal{q}} - 1$.
    Следовательно, $\textrm{ord}_{R/\ideal{p}}(\ideal{b}) = 2^{j+1} | (\Nm{\ideal{p}} - 1)/2$.
    Получаем, что $\jacobi{b}{\ideal{d}} = \jacobi{a}{\ideal{p}} = -1$ и $\ideal{b}^{(\Nm{\ideal{p}} - 1)/2} \equiv 1 \pmod{\ideal{p}}$.
    Это противоречит теореме~\ref{theorem:euler_criteria}.
    
    Пусть $v_2(\Nm{\ideal{p}} - 1) = v_2(\Nm{\ideal{q}} - 1)$.
    Тогда $\jacobi{b}{\ideal{d}} = \jacobi{b}{\ideal{p}}\jacobi{b}{\ideal{q}} = -1$.
    Следовательно, один из множителей равен $-1$.
    Пусть $\jacobi{b}{\ideal{p}} = -1$ и $\jacobi{b}{\ideal{q}} = 1$.
    Из теоремы~\ref{theorem:euler_criteria} следует, что $\ideal{b}^{(\Nm{\ideal{q}} - 1)/2} \equiv 1 \pmod{\ideal{q}}$ и $\textrm{ord}_{R/\ideal{p}}(\ideal{b}) = \textrm{ord}_{R/\ideal{q}}(\ideal{b}) | (\Nm{\ideal{q}} - 1)/2$.
    Тогда $\textrm{ord}_{R/\ideal{p}}(\ideal{b}) | (\Nm{\ideal{p}} - 1)/2$.
    Следовательно, $\ideal{b}^{(\Nm{\ideal{p}} - 1)/2} \equiv 1 \pmod{\ideal{p}}$, что противоречит предположению $\jacobi{b}{\ideal{p}} = -1$.
\end{proof}

\begin{algorithm}\label{algorithm:miller_rabin}
    Дан идеал $\ideal{n} \subset R$.
    Необходимо определить является ли он простым.

    \begin{enumerate}
        \item Найти $u, t \in \mathbb{N}$, что $\Nm{\ideal{n}} - 1 = 2^t u$ и $(2, u) = 1$;
        
        \item Выбрать случайный $a \in \invertible{R/\ideal{n}}$;

        \item Вычислить $r_0 = a^u \pmod{\ideal{n}}$;

        \item Если $r_0 = 1$, то вернуть ''неизвестно'' и завершить алгоритм;

        \item Положить $k = 0$;

        \item Пока $k < t$ выполнять:
        \begin{enumerate}
            \item Если $r_k = -1$, то вернуть ''неизвестно'' и завершить алгоритм;

            \item Увеличить $k$ на $1$;

            \item Вычислить $r_{k+1} \equiv r_k^2 \pmod{\ideal{n}}$;
        \end{enumerate}

        \item Вернуть ''$\ideal{n}$ не простой'' и завершить алгоритм.
    \end{enumerate}
\end{algorithm}

\begin{remark}
    Алгоритм \ref{algorithm:miller_rabin} является вероятностным.
    Если был получен ответ "неизвестно", то можно выполнить алгоритм еще раз.
\end{remark}

\begin{proposition}
    Пусть $\ideal{n}$ -- не простой идеал.
    Тогда вероятность ответа "$\ideal{n}$ не простой" у алгоритма \ref{algorithm:miller_rabin} не менее $1/2$.
\end{proposition}
\begin{proof}
    Рассмотрим множество всех $a$, для которых алгоритм дает ответ "неизвестно".
    Это в точности множество таких $a$, что $a^u \equiv 1 \pmod{\ideal{n}}$ или для которых существует $j \in \{0, \dots, t-1\}$, что $a^{2^{j}u} \equiv -1 \pmod{\ideal{n}}$.
    Из этого следует, что $a^{\Nm{\ideal{n}} - 1} \equiv 1 \pmod{\ideal{n}}$ для всех таких $a$.

    Рассмотрим множество
    \begin{equation*}
        G = \left\{
            a \in \invertible{R/\ideal{n}} \big| a^{\Nm{\ideal{n}} - 1} \equiv 1 \pmod{\ideal{n}}
        \right\}.
    \end{equation*}
    Предположим, что $G$ -- нетривиальная подгруппа.
    Тогда из теоремы Лагранжа следует, что $|G| / |\invertible{R/\ideal{n}}| \le 1/2$.
    Из этого следует верность теоремы для этого случая.

    Предположим, что $\ideal{n}$ такой, что $G = \invertible{R/\ideal{n}}$.
    Пусть $\ideal{n}$ раскладывается в произведение простых идеалов следующим образом $\ideal{n} = \prod_{i=1}^r \ideal{p}_i^{\alpha_i}$.
    Так как норма простого идеала примарная, то обозначим $\Nm{p_i} = q_i^{f_i}$, где $q_i$ -- простой в $\mathbb{Z}$.

    Предположим, что существует такой $j \in \{1, \dots, r\}$, что $\alpha_i > 1$ в разложении $\ideal{n}$ на множители.
    Тогда $\Nm{\ideal{p}_j} | \varphi(\ideal{n})$, следовательно $q_j | \varphi(\ideal{n})$.
    Из теоремы Коши для групп~\ref{statement:cauchy} следует, что в группе $\invertible{R/\ideal{n}}$ существует элемент $a$ порядка $q_j$.
    Из теоремы Эйлера~\ref{statement:euler_function} следует, что $a^{\Nm{\ideal{n}} - 1} \equiv 1 \pmod{\ideal{n}}$, следовательно, $a^{\Nm{\ideal{n}} - 1} \equiv 1 \pmod{\ideal{p}}$.
    Из утверждений выше получаем, что $q_j | \Nm{\ideal{n}} - 1$.
    Это противоречит тому, что $q_j | \Nm{\ideal{n}}$.

    Следовательно, $\alpha_j = 1$ для любого $j \in \{1, \dots, r\}$.
    Так как $\ideal{n}$ -- составное, то $r \ge 2$.
    Обозначим $\Nm{\ideal{p}_i} - 1 = 2^{t_i} u_i$, где $(u_i, 2) = 1$.
    Так же обозначим $s = \min_{i=\overline{1, r}} t_i$, $P = \prod_{i=1}^r (u_i, u)$.

    Из аналога Китайской теоремы об остатках~\ref{statement:chinese_remainder_theorem} следует, что
    \begin{equation*}
        a^u \equiv 1 \pmod{\ideal{n}}
        \Leftrightarrow
        a^u \equiv 1 \pmod{\ideal{p}_i}, i=\overline{1, r}.
    \end{equation*}

    Из теоремы Эйлера~\ref{statement:euler_function} следует, что
    \begin{equation*}
        a^u \equiv 1 \pmod{\ideal{p}_i}
        \Leftrightarrow
        \lambda u \equiv 0 \pmod{\Nm{\ideal{p}_i} - 1},
    \end{equation*}
    где $a \equiv g^\lambda \pmod{\ideal{p}_i}$ и $g$ -- первообразный корень $\invertible{R/\ideal{p}_i}$.
    Так как последнее сравнение имеет $(u, \Nm{\ideal{p}_i} - 1)$ решений, то количество решений сравнения $a^u \equiv 1 \pmod{\ideal{n}}$ равно
    \begin{equation*}
        \prod_{i=1}^r (u, \Nm{\ideal{p}_i} - 1) = P.
    \end{equation*}

    Аналогично получаем, что
    \begin{equation*}
        a^{2^j u} \equiv -1 \pmod{\ideal{n}}
        \Leftrightarrow
        \lambda 2^j u \equiv \frac{\Nm{\ideal{p}_i} - 1}{2} \pmod{\Nm{\ideal{p}_i} - 1}, i=\overline{1, r}.
    \end{equation*}
    Заметим, что сравнение $\lambda 2^j u \equiv \frac{\Nm{\ideal{p}_i} - 1}{2} \pmod{\Nm{\ideal{p}_i} - 1}$ не имеет решений при $j \ge t_i$ и имеет $(2^j u, \Nm{\ideal{p}_i} - 1)$ решений при $j < t_i$.
    Тогда количество решений $a^{2^j u} \equiv -1 \pmod{\ideal{n}}$ равно
    \begin{equation*}
        \prod_{i=1}^r (2^j u, \Nm{\ideal{p}_i} - 1) = 2^{jr} \prod_{i=1}^r (u, \Nm{\ideal{p}_i} - 1) = 2^{jr} P.
    \end{equation*}

    Следовательно, количество идеалов $a \in \invertible{R/\ideal{n}}$, на которых алгоритм дает ответ ''неизвестно'' равно
    \begin{equation*}
        P + \sum_{j=1}^{s-1} 2^{jr} P = P\left(1 + \frac{2^{rs} - 1}{2^r - 1}\right) = P\frac{2^{rs} + 2^r - 2}{2^r - 1}
    \end{equation*}

    Исходя из определения, получаем
    \begin{equation*}
        |\invertible{R/\ideal{n}}| = \varphi(\ideal{n}) = \prod_{i=1}^r \varphi(\ideal{p}_i) = \prod_{i=1}^r (\Nm{\ideal{p}_i} - 1) = \prod_{i=1}^r 2^{t_i} u_i \ge 2^{rs} P.
    \end{equation*}

    Таким образом
    \begin{equation*}
        |G|/|\invertible{R/\ideal{n}}| \le \frac{2^{rs} + 2^r - 2}{2^{rs}(2^r - 1)} \le \frac{1}{2}.
    \end{equation*}
\end{proof}

\begin{remark}
    Если $\ideal{n}$ -- составной, то при выполнении алгоритма \ref{algorithm:miller_rabin} $k$ раз вероятность получить ответ ''$\ideal{n}$ не простой'' не меньше $1 - \frac{1}{2^k}$.
\end{remark}

\begin{remark}
    Доказанные критерии и алгоритмы можно использовать при генерации простых идеалов.
    Генерация простых идеалов является обязательной частью в RSA-криптосистеме в дедекиндовых кольцах.
    Такая криптосистема будет рассмотрена в главе~\ref{section:RSA-cryptosystem}.
\end{remark}

\subsection{Вычислительная сложность алгоритма Миллера-Рабина}

\begin{statement}
    Пусть $\ideal{n} \subseteq R$ идеал дедекиндового кольца.
    Для того, чтобы использовать алгоритм~\ref{algorithm:miller_rabin} для $\ideal{n}$ требуется $O(\log \Nm{\ideal{n}})$ арифметических операций.
\end{statement}
\begin{proof}
    Пусть $\Nm{\ideal{n}} = 2^t u$, где $(2, u) = 1$.
    В алгоритме~\ref{algorithm:miller_rabin} выбирается произвольный $a \in R$ и вычисляется $r_0 = a^u \pmod{\ideal{n}}$.
    Это требует $O(\log u)$ арифметических операций.
    Далее не более $t$ раз для $r_i$ вычисляется $r_i^2 \pmod{\ideal{n}}$.
    Это требует не более $O(t)$ арифметических операций.

    Итого требуется $O(\log u) + O(t) = O(\log \Nm{\ideal{n}})$ арифметических операций.
\end{proof}

% \subsubsection{Способы представления идеалов}

% Рассмотрим способы представления идеалов.

% \begin{definition}
%     Пусть $\ideal{n} \subseteq R$ произвольный идеал дедекиндового кольца $R$.
%     Тогда существуют элементы $\alpha_1, \dots, \alpha_r \in R$ для $r \leq n$, что
% 	\begin{equation*}
% 	    \ideal{n} = \{\xi_1 \alpha_1 + \dots + \xi_r \alpha_r | \xi_i \in R\}.
% 	\end{equation*}
	
% 	Такое представление будем обозначать $\ideal{n} = (\alpha_1, \dots, \alpha_r)$ и называть базисным представлением идеала.
% \end{definition}

% \begin{definition}
%     Пусть $\ideal{n} \subseteq R$ произвольный идеал дедекиндового кольца $R$.
%     Тогда существуют элементы $e_1, \dots, e_r \in R$ для $r \leq n$, что
% 	\begin{equation}
% 		\ideal{n} = \{x_1 e_1 + \dots + x_m e_m | x_i \in \mathbb{Z}\}.
% 	\end{equation}

%     Такое представление будем обозначать $\ideal{n} = (e_1, \dots, e_n)_{\mathbb{Z}}$ и называть $\mathbb{Z}$-представлением идеала.
% \end{definition}

% Далее под $\mathbb{Z}$-представлением будем понимать матрицу $A \in \mathbb{\mathbb{Z}}^{n \times n}$, такую что её столбец под номером $i$ - это коэффициенты разложения $e_i$ в фиксированный целый базис $\mathcal{O}_K$.

% В источниках \cite{source:Cohen}, \cite{source:Post} может быть найдено следующее утверждение.

% \begin{statement}
% 	Любой идеал имеет $\mathbb{Z}$-представление.
% \end{statement}

% $\mathbb{Z}$-представление требует не меньше памяти для хранения по сравнению с базисным представлением.

% \begin{definition}
% 	Представление 
% 	\begin{equation}
% 		\a = (a, \alpha)_2 = \{a\xi_1 + \alpha \xi_2 | \xi_1, \xi_2 \in \mathcal{O}_K\},
% 	\end{equation}
% 	где $a \in \N_0, \alpha \in \mathcal{O}_K$, будет называть 2-представление идеала $\a$.
% \end{definition}

% В источниках \cite{Cohen}, \cite{Post} может быть найдено следующее утверждение.

% \begin{statement}
% 	Любой идеал имеет 2-представление.
% \end{statement}

% Далее под 2-представлением будем понимать вектор $\mathbb{Z}^n$ -- коэффициенты разложения $\alpha$ в целый базис и целое неотрицательное число $a$.

% 2-представление является частным случаем базисного представления и любое 2-представление задаёт идеал. Отметим, что оно требует меньше памяти для хранения по сравнению с $\mathbb{Z}$-представлением и базисным представлением.   

% В \cite{Post} приведены соответствующие алгоритмы.

% \begin{statement}
% 	Существует полиномиальный алгоритм перехода от 2 - представления к $\mathbb{Z}$-представлению и обратно.
% \end{statement}

% К сожалению, не смотря на полиномиальность алгоритма, он может оказаться достаточно трудоёмким.

% Рассмотрим один важный частный случай $\mathbb{Z}$-представления.

% \begin{definition}
% 	Будем говорить, что матрица $A \in \mathbb{Z}^{n \times n}$ записана в нормальной эрмитовой форме, если выполнены следующие условия:
	
% 	\begin{enumerate}
% 		\item $m_{i,j} = 0$, если $i > j$.
		
% 		\item $m_{i,i} > 0$ для любого $i$.
		
% 		\item Для любого $i > j$ выполнено $0\leq m_{i,j}\leq m_{i,i}$.
% 	\end{enumerate}
% \end{definition}


% \begin{definition}
% 	Представление идеала $\a$ в нормальной эрмитовой форме будем называть такое его $\mathbb{Z}$-представление
% 	\begin{equation}
% 		\a = (e_1,\dots,e_n)_{\mathbb{Z}},
% 	\end{equation}
% 	что соответствующая матрица является матрицей в эрмитовой нормальной форме.
% \end{definition}

% В источниках \cite{Cohen}, \cite{Post} может быть найдено следующее утверждение.

% \begin{statement}
% 	Любой идеал может быть записан в нормальной эрмитовой форме, причём такое представление единственно.
% \end{statement}

% В статье \cite{PolynomialHermitForm} был построен необходимый алгоритм:

% \begin{statement}
% 	Существует полиномиальный алгоритм получения представления идеала в нормальной эрмитовой форме из его $\mathbb{Z}$-представления.
% \end{statement}

% \begin{corollary}
% 	Таким образом, за полиномиальное время можно переходить от $\mathbb{Z}$-представления, 2-представления или представления в нормальной эрмитовой форме к любому из них.
% \end{corollary}

% \begin{definition}
% 	Пусть дан идеал $\a$, зафиксирован целый базис $E$ кольца $\mathcal{O}_K$ и $\mathbb{Z}$-представление идеала $\a = (e_1,\dots,e_n)_{\mathbb{Z}}$. Тогда введём абсолютное значение идеала $\a$ как
% 	\begin{equation}
% 		l(\a) = \max\limits_{i = \overline{1,n}, j = \overline{1,n}} |a_{ij}|, 
% 	\end{equation}
% 	где $A = (a_{ij}) \in \mathbb{Z}^{n \times n}$ -- матрица соответствующая указанному $\mathbb{Z}$-представлению.
% \end{definition}

% Нетрудно видеть, что логарифм абсолютного значения идеала характеризует количество памяти необходимое для того, чтобы закодировать его $\mathbb{Z}$-представление.

% В случае, когда кольцо $\mathcal{O}_K$ факториально, любой идеал является главным, а значит любой идеал может быть задан с помощью порождающего его элемента. Поэтому в таких кольцах идеал, как и любой элемент, будет кодироваться в виде вектора $\mathbb{Z}^n$ коэффициентов разложения в целый базис кольца $\mathcal{O}_K$.

% \subsubsection{Операции над элементами}

% В данном параграфе исследуем некоторые арифметические и модулярные операции над элементами колец целых алгебраических элементов и сложности их выполнения.

% Пусть $f(L),$ $g(L)$ две различные функции натурального аргумента $L.$ Мы будем писать $f(L)=\tilde O(g(L))$, если существует положительная функция $h(L)$, такая что $f(L)\le h(L)g(L)$ для любых $L\in \mathbb{N},$ и $h(L)=O(\log g(L)\log \log g(L))$. Данное обозначение вводится в связи с известной оценкой сложности перемножения двух натуральных чисел по алгоритму Шaнхаге-Штрассена. Любое положительная действительное число $C$ будет называться эффективно вычислимой константной (или просто константой), если оно зависит только от инвариантов поля $K$ (например, степени, дискриминанта, интегрального базиса, системы фундаментальных единиц) и существует алгоритм нахождения данного числа.

% \begin{definition}
% 	Для любого $a \in \mathcal{O}_K^*$ обозначим через $\overline{a}\in \mathcal{O}_K^*$ сопряжённый элемент определяемый как $\overline{a}=\Nm(a)/a.$
% \end{definition}

% Далее предполагаем, что элементы заданы с помощью коэффициентов своего разложения в целый базис $\mathcal{O}_K$.

% \begin{statement}\label{statement:operations}
% 	Пусть $a,b \in \mathcal{O}_K^*$ и $l(a)\leq L,\,l(b)\leq L$, тогда $a+b$, $ab,$ $b/a$ (включая проверку условия $a|b$), $\Nm(a),$ $\overline{a}$ могут быть  вычислены за $\tilde{O}(\log L)$ бинарных операций.
% \end{statement}

% \begin{proof}
	
% 	Рассмотрим произвольные элементы $a = \sum_{i = 1}^n \alpha_ie_i$, $b = \sum_{i = 1}^n \beta_i e_i \in \mathcal{O}_K$, такие что $l(a)\leq L,\,l(b)\leq L$. Утверждение для суммы $a+b$ очевидно. Используя алгоритм Шанхаге-Штрассена быстрого перемножения чисел, нетрудно получить необходимое утверждение для произведения $ab$. Известно, что $\Nm(a) = |\mathrm{det}A|$, где $A = (a_{ij}) \in \mathbb{Z}^{n \times n}$ матрица, такая что $a e_i = \sum_{j = 1}^n a_{ij}e_j$ ($i=1,\ldots,n$). Определитель $\mathrm{det} A$ может быть найден с помощью операций сложения и умножения за $\tilde{O}(\log L)$ бинарных операций. Пусть $\overline{a}=\sum_{i = 1}^n x_ie_i,$ где $x_i$ неизвестные целые коэффициенты. Пусть \begin{equation}\Nm(a)=\sum_{i,j=1}^n  \alpha_i x_j e_i e_j=\sum_{k=1}^n \biggl( \sum_{i = 1}^n\sum_{j = 1}^n \alpha_i x_j \alpha_k^{i,j}\biggr)e_k,\end{equation}
% 	где $e_ie_j=\sum_{k=1}^n \alpha_k^{i, j} e_k,$ тогда выполнено соотношение
% 	\begin{equation}
% 	H (x_1,x_2,\ldots, x_n)^T= (\Nm(a),0,\ldots,0)^T,
% 	\end{equation}
% 	где $H$ матрица элементов $h_{ij} \in \mathbb{Z}$ ($i,j = 1,\ldots,n$), такая что $h_{ij} = O(L)$ ($i,j = 1,\ldots,n$).
% 	Тогда существует константа $D$, такая что $\Nm(a)\le D l(a)^n.$ Следовательно решение $(x_1,x_2,\ldots, x_n)^T$ может быть найдено за $\tilde{O}(\log L)$ бинарных операций.
% 	Пусть $b\overline{a}=\sum_{i=1}^n y_i e_i,$ $y_i \in \mathbb{Z}.$ Тогда $b/a=\frac{b\overline{a}}{\Nm(a)},$ условие $a|b$ эквивалентно условию $\Nm(a)|y_i$ для любых $i=1,\ldots,n.$ Элемент $b/a$ может быть определён за $\tilde{O}(\log L)$ используя произведение в $\mathcal{O}_K$ и деление рациональных чисел. 
	
% \end{proof}

% \begin{remark}
% 	В доказательстве утверждения было показано, что существует константа $D$, такая что $\Nm(a) \leq Dl(a)^n$ для любого $a \in \mathcal{O}_K$. Из предыдущего утверждения и правила Крамера следует, что существуют константы $R$ и $q$, такие что $l(\overline{a}) \leq RL^q$ для любого $a \in \mathcal{O}_K$.
% \end{remark}

% \begin{statement}\label{statement:mod}
% 	Существует константа $M$, такая что для любых $a, m \in \mathcal{O}_K^*$ может быть найдено $z \in \mathcal{O}_K$ удовлетворяющее условию $a\equiv z(\modul\,m)$ and $l(z)\leq Ml(m)$. Если $l(a)\leq L, l(m)\leq L$, тогда такой элемент $z$ может быть определён за $\tilde{O}(\log L)$ бинарных операций.
% \end{statement}

% \begin{proof}
% 	Пусть $a = \sum_{i=1}^n a_i e_i$, $m = \sum_{i=1}^n m_i e_i \in \mathcal{O}_K^*$. Тогда мы получаем
% 	\begin{equation}
% 	\frac{a}{m} = \frac{a\overline{m}}{\Nm(m)} = \frac{1}{\Nm(m)}\sum\limits_{i=1}^n b_i e_i = \sum\limits_{i=1}^n \left\lfloor\frac{b_i}{\Nm(m)}\right\rfloor e_i + \sum\limits_{i=1}^n \frac{b_i'}{\Nm(m)} e_i,
% 	\end{equation}
% 	где $b_i' \in \mathbb{Z},$ $|b_i'| < \Nm(m)$, $i=1,\ldots,n$.
% 	Так как $a\overline{m} \equiv \sum_{i=1}^n b_i' e_i(\modul\,\Nm(m))$, мы получаем $\overline{m}\big|\sum_{i=1}^n b_i' e_i$.
% 	Тогда $a\equiv z(\modul\,m)$, где $z = \frac{1}{\overline{m}}\sum_{i=1}^n b_i' e_i$.
% 	Так как
% 	\begin{equation} \label{eq_z}
% 	z= \frac{1}{\Nm(m)}\sum\limits_{k=1}^n e_k\biggl(\sum\limits_{i, j = 1}^n b_i' m_j \alpha_k^{i, j}\biggr),
% 	\end{equation}
% 	получаем
% 	\begin{equation}
% 	l(z) = \max_{k = \overline{1, n}} \biggl|\frac{1}{\Nm(m)}\sum\limits_{i, j = 1}^n b_i' m_j \alpha_k^{i, j}\biggr|
% 	< \max_{k = \overline{1, n}} \sum_{i, j = 1}^n |m_j \alpha_k^{i, j}| \le \nonumber
% 	\end{equation}
% 	\begin{equation}
% 	\le l(m) \max_{k = \overline{1, n}} \sum_{i, j = 1}^n |\alpha_k^{i, j}|= Ml(m).
% 	\end{equation}
% 	Предположим, что $l(a)\leq L, l(m)\leq L$. Тогда $l(\overline{m}) \le RL^q,$ где $q$ и $R$ эффективно вычислимые константы. Так как существует константа $D$, такая что $\Nm(m)\le D l(m)^n$, числа $b_i,$ $b_i'$ могут быть найдены за $\tilde{O}(\log L)$ бинарных операций. Поэтому элемент $z$ может быть определён в $K$ по формуле (\ref{eq_z}) используя не более $\tilde{O}(\log L)$ бинарных операций.
% \end{proof}

% \begin{corollary}\label{corollary_mod}
% 	Пусть $k \in \mathbb{N},$ и для $a,$ $b,$ $m \in \mathcal{O}_K^*$ выполнено $l(a)\leq L,$ $l(b)\leq L$, $l(m)\leq L.$ Элементы $z_1,$ $z_2\in \mathcal{O}_K$ такие что $a+b\equiv z_1(\modul\,m),$ $a^k\equiv z_2(\modul\,m),$ $l(z_1)\leq Ml(m)$, $l(z_2)\leq Ml(m)$, могут быть определены за $\tilde{O}(\log L)$, $\tilde{O}(\log k \log L)$  бинарных операций соответственно.
% \end{corollary}

% \subsubsection{Операции над идеалами}

% Далее будут доказаны утверждения, связанные с вычислительной сложностью различных операций над идеалами.

% \begin{statement}\label{equality}
% 	Пусть идеалы $\ideal{a}$ и $\ideal{b}$ заданы в виде нормальной эрмитовой формы и $l(\ideal{a}), l(\ideal{b}) \leq L$, то проверка указанных идеалов на равенство может быть выполнена за $O(\log L)$ бинарных операций.
% \end{statement}
% \begin{proof}
% 	Как было указано ранее, любой идеал однозначно задаётся своей нормально эрмитовой формой.
% 	Таким образом, достаточно проверить на поэлементнffое равенство две целочисленные матрицы $n \times n$ с коэффициентами размера $O(L)$.
% \end{proof}

% \begin{statement}\label{particular_equality}
	
% 	Пусть $\p$ -- простой идеал, заданный в виде 2-представления, а $\ideal{n}$ произвольный идеал заданный в виде $\mathbb{Z}$-представления, причём $l(\p), l(\ideal{n}) \leq L$.
% 	Тогда проверка равенства $\p$ и $\ideal{n}$ может быть выполнена за $\tilde{O}(\log L)$ операций.
	
% \end{statement}

% \begin{proof}
	
% 	Пусть $\p = (\alpha, a)_2$ -- 2-представление простого идеала. Нетрудно видеть, что проверка равенства $\p = \ideal{n}$ равносильна проверке того, что $\p$ делится на $\ideal{n}$, что по Утверждению \ref{inclusion} равносильно включению $\p$ в $\ideal{n}$. Последнее выполнено тогда и только тогда, когда $\alpha, a \in \ideal{n}$ и проверка сводится к проверке разрешимости систем линейных уравнений $n \times n$ с коэффициентами размера $O(L)$, что может быть выполнено за $\tilde{O}(\log L)$ операций
	
% \end{proof}



% \begin{statement}\label{norm}
	
% 	Пусть идеал $\a$ задан в виде $\mathbb{Z}$-представления и $l(\a) \leq L$, то $\Nm(\a)$ может быть вычислено за $\tilde{O}(\log L)$ бинарных операций.
	
	
% \end{statement}

% \begin{proof}
	
% 	 Исходя из утверждения описанного в $\cite{Post}$ выполнено равенство $\Nm(\a) = |\mathrm{det}(A)|$, где $A$ - матрица соответствующая $\mathbb{Z}$-представлению. Нетрудно видеть, что определитель целочисленной матрицы $n \times n$ с коэффициентами размера $O(L)$  может быть вычислен за указанное число операций.
	
% \end{proof}

% \begin{statement}\label{congruence}
		
% 	Пусть идеал $\a$ задан в виде $\mathbb{Z}$-представления и $l(\a), l(a), l(b) \leq L$, то проверка сравнения $a \equiv b(\modul \a)$ может быть выполнена за $\tilde{O}(\log L)$ бинарных операций.
	
% \end{statement}


% \begin{proof}
	
% 	Пусть изначально $\a$ задан в виде $\mathbb{Z}$-представления и $l(\a), l(a), l(b) \leq L$.
% 	Требуется проверить делимость главного идеала $(a - b)$ на идеал $\a$. Исходя из  Утверждения \ref{inclusion} это эквивалентно проверке включения главного идеала $(a - b)$ в идеал $\a$. А это, в свою очередь, равносильно тому, что $a - b \in \a$. То есть проверка сравнения сводится к проверке разложимости $a - b$ по базису идеала $\a$, то есть проверке разрешимости системы линейных уравнений $n \times n$ с коэффициентами размера $O(L)$. Нетрудно видеть, что это может быть сделано за $\tilde{O}(\log L)$ бинарных операций.
	
	
% \end{proof}

% \begin{statement}\label{residue_modulo_ideal}
	
% 	Пусть $\ideal{n}$ -- нетривиальный идеал отличный и $a \in \mathcal{O}_K$. Тогда существует $z \in \mathcal{O}_K$, такое что $z \equiv a (\modul \ideal{n})$ и $l(z) \leq N l(\ideal{n})^n$. 
	
% 	Если $\ideal{n}$ задан с помощью $\mathbb{Z}$-представления, причём $l(\ideal{n}), l(a) \leq L$, то такой элемент $z$ может быть вычислен за $\tilde{O}(\log L)$ бинарных операций.
	
% \end{statement}

% \begin{proof}
	
% 	Пусть $E = (e_1,\dots,e_n)$ -- целый базис в $\mathcal{O}_K$, $\ideal{n} = (\omega_1,\dots,\omega_n)_{\mathbb{Z}}$ -- $\mathbb{Z}$-представление идеала $\ideal{n}$.
	
% 	Пусть далее $a = \sum\limits_{i = 1}^n \alpha_i e_i$ и $\theta = \mathrm{\text{НОК}}(\Nm(\omega_1),\dots,\Nm(\omega_n))$.
	
% 	Нетрудно видеть, что $\theta \in \ideal{n}$, в следствии чего $\theta\equiv 0(\modul \ideal{n})$.
% 	Отсюда следует, что $a \equiv a - \beta\theta(\modul \ideal{n})$ для любого $\beta \in \mathcal{O}_K$.
	
% 	Положим $\beta = \sum\limits_{i = 1}^n \beta_ie_i,$ где $\alpha_i = \theta \beta_i + r_i$, $r_i < \theta,\,i = \overline{1,n}$, а также $z = a - \beta\theta$.
	
% 	Тогда
	
% 	\begin{equation}
% 		l(z)  = \max\limits_{i = \overline{1,n}} |r_i| \leq |\theta| \leq \prod\limits_{i = 1}^n \Nm(\omega_i) \leq D^n \prod\limits_{i = 1}^n l(\omega_i) \leq D^n l(\ideal{n})^n = N l(\ideal{n})^n.
% 	\end{equation}
	
% 	Нетрудно видеть, что рассмотренные операции могут быть выполнены за $\tilde{O}(\log L)$ бинарных операций.
	
% \end{proof}


% \begin{corollary}
% 	Пусть $k \in \mathbb{N}$ и $a,$ $b,$ $ \in \mathcal{O}_K^*$, $\ideal{n}$ -- нетривиальный идеал заданный с помощью $\mathbb{Z}$-представления. Пусть выполнено $l(a)\leq L,$ $l(b)\leq L$, $l(\ideal{n})\leq L.$ Элементы $z_1,$ $z_2\in \mathcal{O}_K$ такие что $a+b\equiv z_1(\modul\,\ideal{n}),$ $a^k\equiv z_2(\modul\,\ideal{n}),$ $l(z_1)\leq Nl(\ideal{n})^n$, $l(z_2)\leq Nl(\ideal{n})^n$, могут быть определены за $\tilde{O}(\log L)$, $\tilde{O}(\log k \log L)$  бинарных операций соответственно.
% \end{corollary}

% \begin{remark}
	
% 	Отметим, что все указанные операции могут быть выполнены за полиномиальное время в случае, когда идеалы заданы с помощью одного из представлений: $\mathbb{Z}$-представление, 2-представление, нормальная эрмитовая форма; в силу того, что из одного представления может быть получено другое за полиномиальное время.
	
% \end{remark}

% \subsubsection{Вероятностное тестирование на простоту}

% В параграфах ранее нами были исследованы все необходимые операции для реализации Алгоритма \ref{miller_alg}. В данной секции мы оценим его сложность, а также уточним оценки вероятности на случай факториального $\mathcal{O}_K$. 

% \begin{statement}\label{comp_alg_miller}
	
% 	Алгоритм \ref{miller_alg} имеет сложность равную $\tilde{O}(\log^2 l(\ideal{n}))$ бинарных операций.
	
% \end{statement}

% \begin{proof}
	
% 	Очевидным образом следует из оценок сложностей операций над элементами и идеалами в $\mathcal{O}_K$, которые были описаны ранее.
	
% \end{proof}

% Рассмотрим случай факториального $\mathcal{O}_K$ и оценим вероятность успеха.
% Далее оценим вероятность ответа '$\ideal{n}$ не является простым' предполагая, что $\ideal{n}$ не является простым идеалом в $\mathcal{O}_K$, $\Nm(\ideal{n})$ нечётна, при случайном выборе $a.$

% Пусть $\mathcal{S}_{\ideal{n}}$ -- множество всех $a\in \mathcal{O}_{K,\ideal{n}}^\times$, таких что Алгоритм \ref{miller_alg} даёт ответ 'неизвестно', то есть $\mathcal{S}_\ideal{n}$ состоит из всех $a \in \mathcal{O}_{K,\ideal{n}}^\times$, таких что одно из следующих условий выполняется:
% 1) $a^u\equiv 1(\modul \ideal{n})$;
% 2) $\exists k \in \{0,\ldots, t-1\}$, такое что $a^{2^ku}\equiv -1(\modul \ideal{n}),$ где $\Nm(\ideal{n})-1=2^tu,$ $(u,2)=1.$

% Пусть $\mathcal{A}_\ideal{n}$ -- множество всех $a \in \mathcal{O}_{K,\ideal{n}}^\times$, таких что выполняется хотя бы одно из следующих условий:
% 1) $a^{\Nm(\ideal{n})-1}\not\equiv 1(\modul \ideal{n})$;
% 2) существует простой делитель $p$ идеала $\ideal{n}$, такой что $a$ является первообразным корнем в группе $\mathcal{O}_{K,p}^\times$ и $ a^z\not\equiv-1(\modul \ideal{n})$ для любого $z\in\mathbb{Z}$.

% Обозначим множество $\mathcal{G}_{\ideal{n},\p}=\{1+k\ideal{n}/\p| k \in\mathcal{O}_{K,\p}\}$ для любого простого делителя $\p$ идеала $\ideal{n}$, такого что $\p^2|\ideal{n}.$

% \begin{statement} \label{statement_aS}
	
% 	Для любого $a\in\mathcal{A}_\ideal{n}$ выполнено $a\mathcal{S}_\ideal{n}\cap\mathcal{S}_\ideal{n}=\varnothing$.
	
% \end{statement}

% \begin{proof}
	
% 	Пусть $s\in\mathcal{S}_\ideal{n}$ и $a\in\mathcal{A}_\ideal{n}$.
% 	Требуется доказать, что $as \notin \mathcal{S}_\ideal{n}.$
	
% 	Рассмотрим следующие случаи:
	
% 	Случай 1.
% 	$a^{\Nm(\ideal{n})-1}\not\equiv 1(\modul \ideal{n}).$
% 	Так как $s \in \mathcal{S}_\ideal{n},$ то $s^{\Nm(\ideal{n})-1}\equiv 1(\modul \ideal{n}).$
% 	Следовательно, $(as)^{\Nm(\ideal{n})-1}\not\equiv 1(\modul \ideal{n}).$
% 	Поэтому $as \notin \mathcal{S}_N.$
	
% 	Случай 2.
% 	Существует простой делитель $p$ элемента $\ideal{n}$, такой что $a$ является первообразным корнем в $\mathcal{O}_{K,p}^\times$ и
% 	\begin{eqnarray} \label{statement_aS_1}
% 	a^z\not\equiv-1(\modul \ideal{n}) \ \forall  z\in\mathbb{Z}.
% 	\end{eqnarray}
	
% 	Предположим, что $as \in \mathcal{S}_\ideal{n}.$  Рассмотрим следующие четыре подслучая:
	
% 	Случай 2a.
% 	$s^u\equiv 1 (\modul \ideal{n})$ и $(as)^u\equiv 1 (\modul \ideal{n}).$ Получаем, что $a^u\equiv 1 (\modul \ideal{n}).$
% 	Так как $a^u\equiv 1 (\modul p)$ и $a$ - первообразный корень в группе $\mathcal{O}_{K,p}^\times,$ то $(\Nm(p)-1)|u.$
% 	Последнее невозможно, так как $u$ и $\Nm(p)$ нечётны.
	
% 	Случай 2b.
% 	$s^u\equiv 1 (\modul \ideal{n})$ и  $(as)^{2^lu}\equiv -1(\modul \ideal{n}),$ где $l \in \{0,\ldots,t-1\}$.
% 	Таким образом, $a^{2^lu}\equiv -1(\modul \ideal{n}).$
% 	Это противоречит соотношению (\ref{statement_aS_1}).
	
% 	Случай 2c.
% 	$s^{2^ku}\equiv -1 (\modul \ideal{n})$ для некоторого $k\in \{0,\ldots,t-1\}$ и $(as)^u\equiv 1 (\modul \ideal{n})$.
% 	Следовательно $a^{-2^ku}\equiv -1(\modul \ideal{n})$, что противоречит соотношению (\ref{statement_aS_1}).
	
% 	Случай 2d.
% 	$s^{2^ku}\equiv -1 (\modul \ideal{n})$ и $(as)^{2^lu}\equiv -1 (\modul \ideal{n})$ для некоторых $k,$ $l\in \{0,\ldots,t-1\}$.
% 	Рассмотрим следующие три подслучая:
	
% 	Случай 2d1. $k=l.$
% 	Получаем, что $a^{2^ku}\equiv1(\modul \ideal{n})$.
% 	Так  как $a^{2^ku}\equiv1(\modul p)$ и $a$ - первообразный корень по модулю $p$, то $(\Nm(p)-1)|2^ku$.
% 	Согласно Утверждению \ref{statement_Euler} мы получаем, что $s^{2^ku}\equiv1(\modul p)$, что противоречит с $s^{2^ku}\equiv -1 (\modul \ideal{n})$.
	
% 	Случай 2d2. $k<l$.
% 	Мы получаем, что $a^{2^lu}\equiv -1(\modul \ideal{n}),$ что противоречит соотношению (\ref{statement_aS_1}).
	
% 	Случай 2d3. $k>l$.
% 	Мы получаем, что $a^{-2^{k}u}\equiv -1(\modul \ideal{n}),$ что противоречит соотношению (\ref{statement_aS_1}).
	
% 	Таким образом, $as \notin \mathcal{S}_\ideal{n}.$
% 	Следовательно $a\mathcal{S}_\ideal{n}\cap\mathcal{S}_\ideal{n}=\varnothing.$
	
% \end{proof}

% \begin{statement}\label{statement_aS_bS}
	
% 	Пусть $a\in\mathcal{A}_\ideal{n},$ $b \in \mathcal{O}_{K,\ideal{n}}^\times,$ $a\ne b$ и $\left(ab^{-1}\right)\in\mathcal{A}_\ideal{n}$.
% 	Тогда $a\mathcal{S}_\ideal{n}\cap b\mathcal{S}_\ideal{n}=\varnothing$.
	
% \end{statement}

% \begin{proof}
	
% 	Предположим, что существуют $s_1,$ $s_2 \in \mathcal{S}_\ideal{n}$, такие что $as_1\equiv bs_2(\modul \ideal{n}).$
% 	Тогда $s_2\equiv ab^{-1}s_1(\modul \ideal{n}),$ что противоречит Утверждению \ref{statement_aS}.
% 	Следовательно, $a\mathcal{S}_\ideal{n}\cap b\mathcal{S}_\ideal{n}=\varnothing$.
	
% \end{proof}

% \begin{statement}\label{statement_G}
	
% 	$(\mathcal{G}_{\ideal{n},\p},\cdot)$ является подгруппой $\mathcal{O}_{K,\ideal{n}}^\times$.
	
% \end{statement}

% \begin{proof}
	
% 	Нетрудно видеть, что данная группа является образом эндоморфизма $\tau$ группы $\mathcal{O}_{K,\ideal{n}}^{\times}$, такого что $\tau(k) = 1 + k\ideal{n}/\p$.
	
% \end{proof}

% \begin{statement}\label{statement_PQ}
	
% 	Пусть $\ideal{n}\in\mathcal{O}_K$ -- идеал, такой что $\ideal{n}=\p\q$, где $\p,$ $\q$ -- различные простые идеалы,нечётной нормы, причём $\Nm(\N)-1=2^tu,$ $\Nm(\p)-1=\Nm(\q)-1=2^{t_1}u_1$, $t,$ $u,$ $t_1,$ $u_1$ - целые, $(u,2)=(u_1,2)=1$.
% 	Тогда $|\mathcal{S}_\ideal{n}|=(4^{t_1}+2)(u,u_1)^2/3. $
	
% \end{statement}

% \begin{proof}
	
% 	Заметим, что $|\mathcal{S}_\ideal{n}|$ равно числу элементов $s\in\mathcal{O}_{K,\ideal{n}}^\times$ для которых одно из сравнений $s^u\equiv1(\modul \ideal{n}),$ $s^{2^ku}\equiv-1(\modul \ideal{n}),$ $k \in \{0,\ldots,t-1\}$ выполнено.
% 	Преобразовав, первое сравнение можно записать в виде следующей эквивалентной системы:
% 	\begin{eqnarray}
% 	\left\{
% 	\begin{aligned}
% 	u\log_{\alpha}s\equiv0(\modul\varphi_K(\p)), \\
% 	u\log_{\beta}s\equiv0(\modul\varphi_K(\q)), \\
% 	\end{aligned}\right.
% 	\end{eqnarray}
% 	где $\alpha$ и $\beta$ -- первообразные корни в группах $\mathcal{O}_{K,\p}^\times$ и $\mathcal{O}_{K,\q}^\times$ соответственно.
% 	Исходя из Утверждения \ref{crt} получаем, что эта система имеет ровно  $(u,\varphi_K(\p))(u,\varphi_K(\q))=(u,u_1)^2$ решений.
	
% 	Для любого числа $k \in \{0,\ldots,t-1\}$ сравнение $s^{2^ku}\equiv-1(\modul \ideal{n})$ равносильно системе:
% 	\begin{eqnarray}
% 	\left\{
% 	\begin{aligned}
% 	2^ku\log_{\alpha}s\equiv\frac{\varphi_K(\p)}{2}(\modul\varphi_K(\p)), \\
% 	2^ku\log_{\beta}s\equiv\frac{\varphi_K(\q)}{2}(\modul\varphi_K(\q)). \\
% 	\end{aligned}\right.
% 	\end{eqnarray}
% 	Заметим, что данная система неразрешима при $k\geq t_1$, иначе она имеет ровно
% 	\begin{eqnarray}
% 	(2^ku,\varphi_K(\p))(2^ku,\varphi_K(\q))=4^k(u,u_1)^2
% 	\end{eqnarray}
% 	решений.
% 	Таким образом,
% 	\begin{eqnarray}
% 	|\mathcal{S}_\ideal{n}|=(u,u_1)^2+\sum_{i=0}^{t_1-1}4^i(u,u_1)^2=(4^{t_1}+2)(u,u_1)^2/3.
% 	\end{eqnarray}
	
% \end{proof}

% \begin{theorem}\label{Theorem_prob}
	
% 	Пусть $\ideal{n}$ -- нетривиальный идеал не являющийся простым в  $\mathcal{O}_K$, $\Nm(\ideal{n})$ нечётна.
% 	Тогда выполнены следующие утверждения:
% 	\begin{enumerate}
% 		\item Если существует простой идеал $\p$, такой что $\p^2|N$, тогда $|S_{\ideal{n}}| \leq |\mathcal{O}_{K,\ideal{n}}^{\times}|/\Nm(\p)$.
		
% 		\item Если $\ideal{n}$ имеет три различных делителя, то $|S_{\ideal{n}}|\leq |\mathcal{O}_{K,\ideal{n}}|/4$.
		
% 		\item Если $\ideal{n} = \p\q$, причём $\Nm(\p) \neq \Nm(\q)$, то $|S_{\ideal{n}}|\leq |\mathcal{O}_{K,\ideal{n}}|/4$.
		
% 		\item Если $\ideal{n} = \p\q$, причём $\p$ и $\q$ -- различные идеалы и $\Nm(\p) = \Nm(\q)$, тогда $|S_{\ideal{n}}| = \frac{2 + 4^m}{3\cdot4^m}|\mathcal{O}_{K,\ideal{n}}^{\times}|$, где $m$ -- максимальная степень двойки делящая $\Nm(\p) - 1$.
% 	\end{enumerate}
	
% \end{theorem}

% \begin{proof}
	
% 	Отметим, что исходя из факториальности $\mathcal{O}_K$ все идеалы являются главными и их можно отождествлять с элементами порождающими их.
	
	
% 	Поочерёдно рассмотрим все четыре случая: 
	
% 	Случай 1.
% 	Пусть существует простой идеал $\p\in\mathcal{O}_K$, такой что $\p^2|N.$
% 	Покажем, что для любого $g \in \mathcal{G}_{\ideal{n},\p},$ $g\ne 1,$ выполнено $g\in \mathcal{A}_\ideal{n}.$
% 	Рассмотрим произвольное $g \in \mathcal{G}_{\ideal{n},\p},$ $g\ne 1.$
% 	Тогда для любого $k \in \mathcal{O}_{K,\p}$ выполнено $g^{\Nm(\ideal{n})-1} \equiv \left(1+k\ideal{n}/\p\right)^{\Nm(\ideal{n})-1} \equiv 1+k(\Nm(\ideal{n})-1)\ideal{n}/\p(\modul \ideal{n}).$
% 	Заметим, что $g^{\Nm(\ideal{n})-1}\not\equiv 1(\modul \ideal{n})$.
% 	Значит, $g\in\mathcal{A}_\ideal{n}$.
% 	Из Утверждений \ref{statement_aS_bS} и \ref{statement_G} получаем, что $g_1\mathcal{S}_\ideal{n}\cap g_2\mathcal{S}_\ideal{n}=\varnothing$ для различных $g_1,$ $g_2 \in \mathcal{G}_{\ideal{n},p}.$
% 	Следовательно, $\bigcup_{g\in\mathcal{G}_{\ideal{n},p}}(g\mathcal{S}_\ideal{n}) \subseteq \mathcal{O}_{K,\ideal{n}}^\times.$
% 	Окончательно получаем, $|\mathcal{O}_{K,\ideal{n}}^\times| \geq \sum_{g\in\mathcal{G}_{\ideal{n},p}}|g\mathcal{S}_\ideal{n}| = |\mathcal{G}_{\ideal{n},\p}||S_\ideal{n}| = \Nm(\p)|\mathcal{S}_\ideal{n}|\geq3|\mathcal{S}_\ideal{n}|.$
	
% 	Случай 2.
% 	Существует по крайней мере три простых идеала $\p_i,$ $i\in \{1,2,3\}$ в $\mathcal{O}_K$, таких что $\p_i|\ideal{n}$ для любых $i=1,2,3$ и $(\p_i,\p_j)=1$ для любых $i,$ $j\in \{1,2,3\},$ $i \ne j.$
% 	Согласно Утверждению \ref{crt}, для любых $i\in \{1,2,3\}$ существуют $c_i\in \mathcal{O}_{K,\ideal{n}}^\times$, такие что $c_i\equiv a_i(\modul \p_i)$ и $c_i\equiv 1(\modul \p_k),$ $k\in \{1,2,3\},$ $k \ne i,$ где $a_i$ -- первообразный корень по модулю $\p_i$.
% 	Нетрудно видеть, что $c_i,$ $c_i^{-1},$ $c_ic_j,$ $c_ic_j^{-1}\in \mathcal{A}_\ideal{n}$ для любых $i,$ $j\in \{1,2,3\},$ $i \ne j$ (все эти элементы удовлетворяют условию (2) определения $\mathcal{A}_\ideal{n}$).
% 	Используя Утверждение \ref{statement_aS_bS}, получаем, что $|\mathcal{O}_{K,\ideal{n}}^\times|\geq|\mathcal{S}_\ideal{n}|+|c_1\mathcal{S}_\ideal{n}|+|c_2\mathcal{S}_\ideal{n}|+|c_1c_2\mathcal{S}_\ideal{n}|=4|\mathcal{S}_\ideal{n}|.$
	
% 	Случай 3.
% 	Пусть $\ideal{n}=\p_1\p_2$, где $\p_1,$ $\p_2$ простые идеалы $\mathcal{O}_K$, не нарушая общности пусть $\Nm(\p_1)<\Nm(\p_2).$
% 	Согласно Утверждению \ref{crt}, для любого $i\in \{1,2\}$ существуют $c_i\in\mathcal{O}_{K,\ideal{n}}^\times$, такие что  $c_i\equiv a_i(\modul \p_i)$ и $c_i\equiv 1(\modul \p_k),$ $k\in\{1,2\},$ $k \ne i,$ где $a_i$ -- первообразные корни по модулю $\p_i$.
% 	Аналогично случаю 3 получаем, что $c_1,$ $c_2 \in \mathcal{A}_\ideal{n}.$
% 	Покажем, что $d=c_1c_2 \in \mathcal{A}_\ideal{n}.$
% 	Предположим, что $d^{\Nm(\ideal{n})-1}\equiv1(\modul \ideal{n})$.
% 	Следовательно, $d^{\Nm(\ideal{n})-1}\equiv1(\modul \p_2).$
% 	Так как $d$ является первообразным корнем по модулю $\p_2,$ то $(\Nm(\p_2)-1)|(\Nm(\ideal{n})-1)=\Nm(\p_1)(\Nm(\p_2)-1)+\Nm(\p_1)-1$.
% 	Получаем противоречие, так как $\Nm(\p_1)<\Nm(\p_2)$ и $\Nm(\p_2)\ge 3.$
% 	Таким образом, $c_1c_2 \in \mathcal{A}_\ideal{n}.$
% 	Аналогичным образом можно доказать, что $c_1c_2^{-1} \in \mathcal{A}_\ideal{n}.$
% 	Как и в случае 3, получаем неравенство $|\mathcal{O}_{K,\ideal{n}}^\times|\geq4|\mathcal{S}_\ideal{n}|.$
	
% 	Случай 4.
% 	Пусть $\ideal{n}=\p\q,$ где $\p,$ $\q$ простые идеалы в $\mathcal{O}_K$ такие, что $(\p,\q)=1$ и $\Nm(\p)=\Nm(\q).$
% 	Пусть $\Nm(\ideal{n})-1=2^tu,$ $\Nm(\p)-1=\Nm(\q)-1=2^{t_1}u_1$, $t,$ $u,$ $t_1,$ $u_1$ целые числа такие, что, $(u,2)=(u_1,2)=1$.
% 	Тогда $\varphi_K(\ideal{n})=\varphi_K(\p)\varphi_K(\q)=2^{2t_1}u_1^2$.
% 	Используя Утверждение \ref{statement_PQ}, получаем, что
% 	\begin{eqnarray}\frac{|\mathcal{S}_\ideal{n}|}{|\mathcal{O}_{K,\ideal{n}}^\times|}=\frac{(2+4^{t_1})(u,u_1)^2}{3u_1^2 4^{t_1}}\leq\frac{2+4^{t_1}}{3\cdot4^{t_1}}\leq\frac{1}{2}.\end{eqnarray}
% \end{proof}

% \begin{remark}\label{miller_prob}
% 	Отметим, что в первых трех случаях теоремы верна оценка $|\mathcal{S}_{\ideal{n}}| \leq 1/3 |\mathcal{O}_{K,\ideal{n}}^{\times}|$.
	
% 	Если рассматривать идеалы, свободные от делителей нормы 2 и 3(то есть, некоторого конечного множества делителей), то в первых трёх случаях теоремы верна оценка $|\mathcal{S}_{\ideal{n}}| \leq 1/4 |\mathcal{O}_{K,\ideal{n}}^{\times}|$.
	
% 	Минимальное соотношение $|S_{\ideal{n}}|$ и $|\mathcal{O}_{K,\ideal{n}}^{\times}|$ достигается в случае $\ideal{n} = \p\q$, где $\p,\q$ различные идеалы, $\Nm(\p) = \Nm(\q)$ и $\Nm(p) - 1 = 2u,\,(u,2) = 1$. В этом случае, $|S_{\ideal{n}}| = 1/2|\mathcal{O}_{K,\ideal{n}}^{\times}|$. Таким образом, в общем случае $|S_{\ideal{n}}|/|\mathcal{O}_{K,\ideal{n}}^{\times}| \leq 1/2$.
	
% 	В некоторых кольцах можно несколько улучшить данную оценку, например, при в $\mathbb{Z}[i]$, если $\Nm(
% 	\ideal{n})$ чётна, то $\Nm(\ideal{n})$ кратна 4, а значит $|S_{\ideal{n}}|/|\mathcal{O}_{K,\ideal{n}}^{\times}| \leq 3/8$.
	
% 	Тем не менее, в некоторых кольцах доказанная оценка достигается. Рассмотрим кольцо $\mathbb{Z}[\sqrt{-2}]$. Положительное нечётное число может быть представлено в виде $x^2 + 2y^2,x,y\in\N,(x,y) = 1$ в случае, если оно свободно от простых делителей вида $8n+5, 8n+7$\cite{buhshtab}. Рассмотрим последовательность чисел $N_l, l\in\mathbb{N}$ - простых чисел вида $8k + 3$. Так как $\left(\frac{\Delta_K}{8n + 3}\right) = \left(\frac{-8}{8n + 3}\right) = 1$, получаем, что $N_l$ -- составное в $\mathbb{Z}[\sqrt{-2}]$(\cite{dekker}), а значит $N_l = z_l\cdot \overline{z_l}$, где $z_l$ -- простые в $\mathcal{O}_K$ и $(z_l,\overline{z_l}) = 1$. Пусть $\n_l = (z_l)$ -- главный простой идеал. Тогда $|S_{\n_l}|/|\mathcal{O}_{K,\n_l}^{\times}| = 1/2$
% \end{remark}

% \begin{remark}\label{prob_rem}
% 	Результат схожий с Теоремой \ref{Theorem_prob} для теста Миллера-Рабина в кольце целых чисел был доказан Рабиным.%тут была ссылка [19]
% 	Пусть $\mathcal{O}_K$ факториально.
% 	Если элемент $N\notin \mathcal{O}_K^\times$ не является простым в  $\mathcal{O}_K$  и имеет нечётную норму, тогда, согласно Теореме \ref{Theorem_prob}, Алгоритм \ref{miller_alg} позволяет доказать, что $N$ не является простым с вероятностью $\mathbb{P}\ge1-2^{-M},$ где $M$ - это число итераций Алгоритма \ref{miller_alg}.
	
% 	Рассмотрим случай факториального $\mathcal{O}_K$. Заметим, что для любого $a \in \mathcal{O}_{K,\ideal{n}}^{\times}$, свидетельствующего о простоте $\ideal{n}$, верно $a^{\Nm(\ideal{n}) - 1}\equiv 1(\modul \ideal{n})$, то есть вероятность успеха не хуже, чем в тесте Ферма, а значит оценка $\mathbb{P} \geq 1/2$ выполнена для всех идеалов, не являющихся аналогами идеалов Кармайкла.
% \end{remark}

\onlyinsubfile{
    \subfile{_10_bibliography}
    \subfile{_11_pub}
}

\end{document}
